--[[
	⣿⣿⣿⣿⣿ SIGMA SPY ⣿⣿⣿⣿⣿
	⣿⣿⣯⡉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉
	⠉⠻⣿⣿⣦⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
	⠀⠀⠈⠻⣿⣿⣷⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
	⠀⠀⠀⠀⠀⠙⢿⣿⣿⣦⡀⠀⠀⠀⠀⠀⠀⠀⠀
	⠀⠀⠀⠀⠀⠀⠀⣉⣿⣿⣿⠆⠀⠀⠀⠀⠀⠀⠀
	⠀⠀⠀⠀⠀⣠⣾⣿⣿⠟⠁⠀⠀⠀⠀⠀⠀⠀⠀
	⠀⠀⢀⣴⣿⣿⡿⠋⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
	⣀⣴⣿⣿⠟⠉⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
	⣿⣿⣟⣁⣀⣀⣀⣀⣀⣀⣀⣀⣀⣀⣀⣀⣀⣀
	⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿

	@author depso (depthso)
	@repo https://github.com/depthso
	@license MIT
	@description Sigma Remote Spy for Roblox
    
	This file is COMPILED, check /src folder for the source
	Build scripts are available in /build
]]

local a,b={UseWorkspace=false,NoActors=false,FolderName='Sigma Spy',RepoUrl=
[[https://raw.githubusercontent.com/YueMikoDns/Sigma_Spy-By-depthso/refs/heads/main]]
,ParserUrl=
[[https://raw.githubusercontent.com/depthso/Roblox-parser/refs/heads/main/dist/Main.luau]]
},{...}local c=b[1]if typeof(c)=='table'then for d,e in c do a[d]=e end end
local d=setmetatable({},{__index=function(d,e)local f=game:GetService(e)return
cloneref(f)end})local e=(function()local e,f={UseWorkspace=false,Folder=
'Sigma spy',RepoUrl=nil,FolderStructure={['Sigma Spy']={'assets'}}}function e:
Init(g)local h,i=self.FolderStructure,g.Services f=i.HttpService self:
CheckFolders(h)end function e:PushConfig(g)for h,i in next,g do self[h]=i end
end function e:UrlFetch(g)local h={Url=g:gsub(' ','%%20'),Method='GET'}local i,j
=pcall(request,h)if not i then warn'[!] HTTP request error! Check console (F9)'
warn('> Url:',g)error(j)return''end local k,l=j.Body,j.StatusCode if l==404 then
warn'[!] The file requested has moved or been deleted.'warn(' >',g)return''end
return k,j end function e:MakePath(g)local h=self.Folder return`{h}/{g}`end
function e:LoadCustomasset(g)if not getcustomasset then return end if not g then
return end local h=readfile(g)if#h<=0 then return end local i,j=pcall(
getcustomasset,g)if not i then return end if not j or#j<=0 then return end
return j end function e:GetFile(g,h)local i,j,k,l=self.RepoUrl,self.UseWorkspace
,self:MakePath(g),''if j then l=readfile(k)else l=self:UrlFetch(`{i}/{g}`)end if
h then self:FileCheck(k,function()return l end)return self:LoadCustomasset(k)end
return l end function e:GetTemplate(g)return self:GetFile(`templates/{g}.lua`)
end function e:FileCheck(g,h)if isfile(g)then return end local i=h()writefile(g,
i)end function e:FolderCheck(g)if isfolder(g)then return end makefolder(g)end
function e:CheckPath(g,h)return g and`{g}/{h}`or h end function e:CheckFolders(g
,h)for i,j in next,g do if typeof(j)=='table'then local k=self:CheckPath(h,i)
self:FolderCheck(k)self:CheckFolders(j,k)continue end local k=self:CheckPath(h,j
)self:FolderCheck(k)end end function e:TemplateCheck(g,h)self:FileCheck(g,
function()return self:GetTemplate(h)end)end function e:GetAsset(g,h)return self:
GetFile(`assets/{g}`,h)end function e:GetModule(g,h)local i=`{g}.lua`if h then
self:TemplateCheck(i,h)local j=readfile(i)local k=loadstring(j)if k then return
j end return self:GetTemplate(h)end return self:GetFile(i)end function e:
LoadLibraries(g,...)local h={}for i,j in next,g do local k=typeof(j)=='table'and
j[1]=='base64'j=k and j[2]or j if typeof(j)~='string'and not k then h[i]=j
continue end if k then j=crypt.base64decode(j)g[i]=j end local l,m=loadstring(j,
i)assert(l,`Failed to load {i}: {m}`)h[i]=l(...)end return h end function e:
LoadModules(g,h)for i,j in next,g do local k=j.Init if not k then continue end j
:Init(h)end end function e:CreateFont(g,h)if not h then return end local i=`assets/{
g}.json`local j,k=self:MakePath(i),{name=g,faces={{name='Regular',weight=400,
style='Normal',assetId=h}}}local l=f:JSONEncode(k)writefile(j,l)return j end
function e:CompileModule(g)local h='local Libraries = {'for i,j in g do if
typeof(j)~='string'then continue end h..=`\t{i} = (function()\n{j}\nend)(),\n`
end h..='}'return h end function e:MakeActorScript(g,h)local i=e:CompileModule(g
)i..='\tlocal ExtraData = {\n\t\tIsActor = true\n\t}\n\t'i..=`Libraries.Hook:BeginService(Libraries, ExtraData, {
h})`return i end return e end)()e:PushConfig(a)e:Init{Services=d}local f=e.
FolderName local g,h={Config=e:GetModule(`{f}/Config`,'Config'),ReturnSpoofs=e:
GetModule(`{f}/Return spoofs`,'Return Spoofs'),Configuration=a,Files=e,Process={
'base64',
[[dHlwZSB0YWJsZSA9IHsKICAgIFthbnldOiBhbnkKfQoKdHlwZSBSZW1vdGVEYXRhID0gewoJUmVtb3RlOiBJbnN0YW5jZSwKICAgIE5vQmFja3RyYWNlOiBib29sZWFuPywKCUlzUmVjZWl2ZTogYm9vbGVhbj8sCglBcmdzOiB0YWJsZSwKICAgIElkOiBzdHJpbmcsCglNZXRob2Q6IHN0cmluZywKICAgIFRyYW5zZmVyVHlwZTogc3RyaW5nLAoJVmFsdWVSZXBsYWNlbWVudHM6IHRhYmxlLAogICAgUmV0dXJuVmFsdWVzOiB0YWJsZSwKICAgIE9yaWdpbmFsRnVuYzogKEluc3RhbmNlLCAuLi5hbnkpIC0+IC4uLmFueQp9CgotLS8vIE1vZHVsZQpsb2NhbCBQcm9jZXNzID0gewogICAgLS0vLyBSZW1vdGUgY2xhc3NlcwogICAgUmVtb3RlQ2xhc3NEYXRhID0gewogICAgICAgIFsiUmVtb3RlRXZlbnQiXSA9IHsKICAgICAgICAgICAgU2VuZCA9IHsKICAgICAgICAgICAgICAgICJGaXJlU2VydmVyIiwKICAgICAgICAgICAgICAgICJmaXJlU2VydmVyIiwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgUmVjZWl2ZSA9IHsKICAgICAgICAgICAgICAgICJPbkNsaWVudEV2ZW50IiwKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgWyJSZW1vdGVGdW5jdGlvbiJdID0gewogICAgICAgICAgICBJc1JlbW90ZUZ1bmN0aW9uID0gdHJ1ZSwKICAgICAgICAgICAgU2VuZCA9IHsKICAgICAgICAgICAgICAgICJJbnZva2VTZXJ2ZXIiLAogICAgICAgICAgICAgICAgImludm9rZVNlcnZlciIsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIFJlY2VpdmUgPSB7CiAgICAgICAgICAgICAgICAiT25DbGllbnRJbnZva2UiLAogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBbIlVucmVsaWFibGVSZW1vdGVFdmVudCJdID0gewogICAgICAgICAgICBTZW5kID0gewogICAgICAgICAgICAgICAgIkZpcmVTZXJ2ZXIiLAogICAgICAgICAgICAgICAgImZpcmVTZXJ2ZXIiLAogICAgICAgICAgICB9LAogICAgICAgICAgICBSZWNlaXZlID0gewogICAgICAgICAgICAgICAgIk9uQ2xpZW50RXZlbnQiLAogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBbIkJpbmRhYmxlRXZlbnQiXSA9IHsKICAgICAgICAgICAgTm9SZWNpdmVIb29rID0gdHJ1ZSwKICAgICAgICAgICAgU2VuZCA9IHsKICAgICAgICAgICAgICAgICJGaXJlIiwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgUmVjZWl2ZSA9IHsKICAgICAgICAgICAgICAgICJFdmVudCIsCiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIFsiQmluZGFibGVGdW5jdGlvbiJdID0gewogICAgICAgICAgICBJc1JlbW90ZUZ1bmN0aW9uID0gdHJ1ZSwKICAgICAgICAgICAgTm9SZWNpdmVIb29rID0gdHJ1ZSwKICAgICAgICAgICAgU2VuZCA9IHsKICAgICAgICAgICAgICAgICJJbnZva2UiLAogICAgICAgICAgICB9LAogICAgICAgICAgICBSZWNlaXZlID0gewogICAgICAgICAgICAgICAgIk9uSW52b2tlIiwKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0sCiAgICBSZW1vdGVPcHRpb25zID0ge30sCiAgICBMb29waW5nUmVtb3RlcyA9IHt9LAogICAgQ29uZmlnT3ZlcndyaXRlcyA9IHsKICAgICAgICBbeyJzaXJodXJ0IiwgInBvdGFzc2l1bSIsICJ3YXZlIn1dID0gewogICAgICAgICAgICBGb3JjZVVzZUN1c3RvbUNvbW0gPSB0cnVlCiAgICAgICAgfQogICAgfQp9CgotLS8vIE1vZHVsZXMKbG9jYWwgSG9vawpsb2NhbCBDb21tdW5pY2F0aW9uCmxvY2FsIFJldHVyblNwb29mcwpsb2NhbCBVaQpsb2NhbCBDb25maWcKCi0tLy8gU2VydmljZXMKbG9jYWwgSHR0cFNlcnZpY2U6IEh0dHBTZXJ2aWNlCgotLS8vIENvbW11bmljYXRpb24gY2hhbm5lbApsb2NhbCBDaGFubmVsCmxvY2FsIFdyYXBwZWRDaGFubmVsID0gZmFsc2UKCmxvY2FsIFNpZ21hRU5WID0gZ2V0ZmVudigxKQoKZnVuY3Rpb24gUHJvY2VzczpNZXJnZShCYXNlOiB0YWJsZSwgTmV3OiB0YWJsZSkKICAgIGlmIG5vdCBOZXcgdGhlbiByZXR1cm4gZW5kCglmb3IgS2V5LCBWYWx1ZSBpbiBuZXh0LCBOZXcgZG8KCQlCYXNlW0tleV0gPSBWYWx1ZQoJZW5kCmVuZAoKZnVuY3Rpb24gUHJvY2VzczpJbml0KERhdGEpCiAgICBsb2NhbCBNb2R1bGVzID0gRGF0YS5Nb2R1bGVzCiAgICBsb2NhbCBTZXJ2aWNlcyA9IERhdGEuU2VydmljZXMKCiAgICAtLS8vIFNlcnZpY2VzCiAgICBIdHRwU2VydmljZSA9IFNlcnZpY2VzLkh0dHBTZXJ2aWNlCgogICAgLS0vLyBNb2R1bGVzCiAgICBDb25maWcgPSBNb2R1bGVzLkNvbmZpZwogICAgVWkgPSBNb2R1bGVzLlVpCiAgICBIb29rID0gTW9kdWxlcy5Ib29rCiAgICBDb21tdW5pY2F0aW9uID0gTW9kdWxlcy5Db21tdW5pY2F0aW9uCiAgICBSZXR1cm5TcG9vZnMgPSBNb2R1bGVzLlJldHVyblNwb29mcwplbmQKCi0tLy8gQ29tbXVuaWNhdGlvbgpmdW5jdGlvbiBQcm9jZXNzOlNldENoYW5uZWwoTmV3Q2hhbm5lbDogQmluZGFibGVFdmVudCwgSXNXcmFwcGVkOiBib29sZWFuKQogICAgQ2hhbm5lbCA9IE5ld0NoYW5uZWwKICAgIFdyYXBwZWRDaGFubmVsID0gSXNXcmFwcGVkCmVuZAoKZnVuY3Rpb24gUHJvY2VzczpHZXRDb25maWdPdmVyd3JpdGVzKE5hbWU6IHN0cmluZykKICAgIGxvY2FsIENvbmZpZ092ZXJ3cml0ZXMgPSBzZWxmLkNvbmZpZ092ZXJ3cml0ZXMKCiAgICBmb3IgTGlzdCwgT3ZlcndyaXRlcyBpbiBuZXh0LCBDb25maWdPdmVyd3JpdGVzIGRvCiAgICAgICAgaWYgbm90IHRhYmxlLmZpbmQoTGlzdCwgTmFtZSkgdGhlbiBjb250aW51ZSBlbmQKICAgICAgICByZXR1cm4gT3ZlcndyaXRlcwogICAgZW5kCiAgICByZXR1cm4KZW5kCgpmdW5jdGlvbiBQcm9jZXNzOkNoZWNrQ29uZmlnKENvbmZpZzogdGFibGUpCiAgICBsb2NhbCBOYW1lID0gaWRlbnRpZnlleGVjdXRvcigpOmxvd2VyKCkKCiAgICAtLS8vIEZvcmNlIGNvbmZpZ3VyYXRpb24gb3ZlcndyaXRlcyBmb3Igc3BlY2lmaWMgZXhlY3V0b3JzCiAgICBsb2NhbCBPdmVyd3JpdGVzID0gc2VsZjpHZXRDb25maWdPdmVyd3JpdGVzKE5hbWUpCiAgICBpZiBub3QgT3ZlcndyaXRlcyB0aGVuIHJldHVybiBlbmQKCiAgICBzZWxmOk1lcmdlKENvbmZpZywgT3ZlcndyaXRlcykKZW5kCgpmdW5jdGlvbiBQcm9jZXNzOkNsZWFuQ0Vycm9yKEVycm9yOiBzdHJpbmcpOiBzdHJpbmcKICAgIEVycm9yID0gRXJyb3I6Z3N1YigiOiVkKzogIiwgIiIpCiAgICBFcnJvciA9IEVycm9yOmdzdWIoIiwgZ290ICVhKyIsICIiKQogICAgRXJyb3IgPSBFcnJvcjpnc3ViKCJpbnZhbGlkIGFyZ3VtZW50IiwgIm1pc3NpbmcgYXJndW1lbnQiKQogICAgcmV0dXJuIEVycm9yCmVuZAoKZnVuY3Rpb24gUHJvY2VzczpDb3VudE1hdGNoZXMoU3RyaW5nOiBzdHJpbmcsIE1hdGNoOiBzdHJpbmcpOiBudW1iZXIKCWxvY2FsIENvdW50ID0gMAoJZm9yIF8gaW4gU3RyaW5nOmdtYXRjaChNYXRjaCkgZG8KCQlDb3VudCArPTEgCgllbmQKCglyZXR1cm4gQ291bnQKZW5kCgpmdW5jdGlvbiBQcm9jZXNzOkNoZWNrVmFsdWUoVmFsdWUsIElnbm9yZTogdGFibGU/LCBDYWNoZTogdGFibGU/KQogICAgbG9jYWwgVHlwZSA9IHR5cGVvZihWYWx1ZSkKICAgIENvbW11bmljYXRpb246V2FpdENoZWNrKCkKICAgIAogICAgaWYgVHlwZSA9PSAidGFibGUiIHRoZW4KICAgICAgICBWYWx1ZSA9IHNlbGY6RGVlcENsb25lVGFibGUoVmFsdWUsIElnbm9yZSwgQ2FjaGUpCiAgICBlbHNlaWYgVHlwZSA9PSAiSW5zdGFuY2UiIHRoZW4KICAgICAgICBWYWx1ZSA9IGNsb25lcmVmKFZhbHVlKQogICAgZW5kCiAgICAKICAgIHJldHVybiBWYWx1ZQplbmQKCmZ1bmN0aW9uIFByb2Nlc3M6RGVlcENsb25lVGFibGUoVGFibGUsIElnbm9yZTogdGFibGU/LCBWaXNpdGVkOiB0YWJsZT8pOiB0YWJsZQogICAgaWYgdHlwZW9mKFRhYmxlKSB+PSAidGFibGUiIHRoZW4gcmV0dXJuIFRhYmxlIGVuZAogICAgbG9jYWwgQ2FjaGUgPSBWaXNpdGVkIG9yIHt9CgogICAgLS0vLyBDaGVjayBmb3IgY2FjaGVkCiAgICBpZiBDYWNoZVtUYWJsZV0gdGhlbgogICAgICAgIHJldHVybiBDYWNoZVtUYWJsZV0KICAgIGVuZAoKICAgIGxvY2FsIE5ldyA9IHt9CiAgICBDYWNoZVtUYWJsZV0gPSBOZXcKCiAgICBmb3IgS2V5LCBWYWx1ZSBpbiBuZXh0LCBUYWJsZSBkbwogICAgICAgIC0tLy8gQ2hlY2sgaWYgdGhlIHZhbHVlIGlzIGlnbm9yZWQKICAgICAgICBpZiBJZ25vcmUgYW5kIHRhYmxlLmZpbmQoSWdub3JlLCBWYWx1ZSkgdGhlbiBjb250aW51ZSBlbmQKICAgICAgICAKICAgICAgICBLZXkgPSBzZWxmOkNoZWNrVmFsdWUoS2V5LCBJZ25vcmUsIENhY2hlKQogICAgICAgIE5ld1tLZXldID0gc2VsZjpDaGVja1ZhbHVlKFZhbHVlLCBJZ25vcmUsIENhY2hlKQogICAgZW5kCgogICAgLS0vLyBNYXN0ZXIgY2xlYXIKICAgIGlmIG5vdCBWaXNpdGVkIHRoZW4KICAgICAgICB0YWJsZS5jbGVhcihDYWNoZSkKICAgIGVuZAogICAgCiAgICByZXR1cm4gTmV3CmVuZAoKZnVuY3Rpb24gUHJvY2VzczpVbnBhY2soVGFibGU6IHRhYmxlKQogICAgaWYgbm90IFRhYmxlIHRoZW4gcmV0dXJuIFRhYmxlIGVuZAoJbG9jYWwgTGVuZ3RoID0gdGFibGUubWF4bihUYWJsZSkKCXJldHVybiB1bnBhY2soVGFibGUsIDEsIExlbmd0aCkKZW5kCgpmdW5jdGlvbiBQcm9jZXNzOlB1c2hDb25maWcoT3ZlcndyaXRlcykKICAgIHNlbGY6TWVyZ2Uoc2VsZiwgT3ZlcndyaXRlcykKZW5kCgpmdW5jdGlvbiBQcm9jZXNzOkZ1bmNFeGlzdHMoTmFtZTogc3RyaW5nKQoJcmV0dXJuIFNpZ21hRU5WW05hbWVdCmVuZAoKZnVuY3Rpb24gUHJvY2VzczpDaGVja0V4ZWN1dG9yKCk6IGJvb2xlYW4KICAgIGxvY2FsIEJsYWNrbGlzdGVkID0gewogICAgICAgICJ4ZW5vIiwKICAgICAgICAic29sYXJhIiwKICAgICAgICAiampzcGxvaXQiCiAgICB9CgogICAgbG9jYWwgTmFtZSA9IGlkZW50aWZ5ZXhlY3V0b3IoKTpsb3dlcigpCiAgICBsb2NhbCBJc0JsYWNrbGlzdGVkID0gdGFibGUuZmluZChCbGFja2xpc3RlZCwgTmFtZSkKCiAgICAtLS8vIFNvbWUgZXhlY3V0b3JzIGhhdmUgYnJva2VuIGZ1bmN0aW9uYWxpdHkKICAgIGlmIElzQmxhY2tsaXN0ZWQgdGhlbgogICAgICAgIFVpOlNob3dVbnN1cHBvcnRlZEV4ZWN1dG9yKE5hbWUpCiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICBlbmQKCiAgICByZXR1cm4gdHJ1ZQplbmQKCmZ1bmN0aW9uIFByb2Nlc3M6Q2hlY2tGdW5jdGlvbnMoKTogYm9vbGVhbgogICAgbG9jYWwgQ29yZUZ1bmN0aW9ucyA9IHsKICAgICAgICAiaG9va21ldGFtZXRob2QiLAogICAgICAgICJob29rZnVuY3Rpb24iLAogICAgICAgICJnZXRyYXdtZXRhdGFibGUiLAogICAgICAgICJzZXRyZWFkb25seSIKICAgIH0KCiAgICAtLS8vIENoZWNrIGlmIHRoZSBmdW5jdGlvbnMgZXhpc3QgaW4gdGhlIEVOVgogICAgZm9yIF8sIE5hbWUgaW4gQ29yZUZ1bmN0aW9ucyBkbwogICAgICAgIGxvY2FsIEZ1bmMgPSBzZWxmOkZ1bmNFeGlzdHMoTmFtZSkKICAgICAgICBpZiBGdW5jIHRoZW4gY29udGludWUgZW5kCgogICAgICAgIC0tLy8gRnVuY3Rpb24gbWlzc2luZyEKICAgICAgICBVaTpTaG93VW5zdXBwb3J0ZWQoTmFtZSkKICAgICAgICByZXR1cm4gZmFsc2UKICAgIGVuZAoKICAgIHJldHVybiB0cnVlCmVuZAoKZnVuY3Rpb24gUHJvY2VzczpDaGVja0lzU3VwcG9ydGVkKCk6IGJvb2xlYW4KICAgIC0tLy8gQ2hlY2sgaWYgdGhlIGV4ZWN1dG9yIGlzIGJsYWNrbGlzdGVkCiAgICBsb2NhbCBFeGVjdXRvclN1cHBvcnRlZCA9IHNlbGY6Q2hlY2tFeGVjdXRvcigpCiAgICBpZiBub3QgRXhlY3V0b3JTdXBwb3J0ZWQgdGhlbgogICAgICAgIHJldHVybiBmYWxzZQogICAgZW5kCgogICAgLS0vLyBDaGVjayBpZiB0aGUgY29yZSBmdW5jdGlvbnMgZXhpc3QKICAgIGxvY2FsIEZ1bmN0aW9uc1N1cHBvcnRlZCA9IHNlbGY6Q2hlY2tGdW5jdGlvbnMoKQogICAgaWYgbm90IEZ1bmN0aW9uc1N1cHBvcnRlZCB0aGVuCiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICBlbmQKCiAgICByZXR1cm4gdHJ1ZQplbmQKCmZ1bmN0aW9uIFByb2Nlc3M6R2V0Q2xhc3NEYXRhKFJlbW90ZTogSW5zdGFuY2UpOiB0YWJsZT8KICAgIGxvY2FsIFJlbW90ZUNsYXNzRGF0YSA9IHNlbGYuUmVtb3RlQ2xhc3NEYXRhCiAgICBsb2NhbCBDbGFzc05hbWUgPSBIb29rOkluZGV4KFJlbW90ZSwgIkNsYXNzTmFtZSIpCgogICAgcmV0dXJuIFJlbW90ZUNsYXNzRGF0YVtDbGFzc05hbWVdCmVuZAoKZnVuY3Rpb24gUHJvY2VzczpJc1Byb3RlY3RlZFJlbW90ZShSZW1vdGU6IEluc3RhbmNlKTogYm9vbGVhbgogICAgbG9jYWwgSXNEZWJ1ZyA9IFJlbW90ZSA9PSBDb21tdW5pY2F0aW9uLkRlYnVnSWRSZW1vdGUKICAgIGxvY2FsIElzQ2hhbm5lbCA9IFJlbW90ZSA9PSAoV3JhcHBlZENoYW5uZWwgYW5kIENoYW5uZWwuQ2hhbm5lbCBvciBDaGFubmVsKQoKICAgIHJldHVybiBJc0RlYnVnIG9yIElzQ2hhbm5lbAplbmQKCmZ1bmN0aW9uIFByb2Nlc3M6UmVtb3RlQWxsb3dlZChSZW1vdGU6IEluc3RhbmNlLCBUcmFuc2ZlclR5cGU6IHN0cmluZywgTWV0aG9kOiBzdHJpbmc/KTogYm9vbGVhbj8KICAgIGlmIHR5cGVvZihSZW1vdGUpIH49ICdJbnN0YW5jZScgdGhlbiByZXR1cm4gZW5kCiAgICAKICAgIC0tLy8gQ2hlY2sgaWYgdGhlIFJlbW90ZSBpcyBwcm90ZWN0ZWQKICAgIGlmIHNlbGY6SXNQcm90ZWN0ZWRSZW1vdGUoUmVtb3RlKSB0aGVuIHJldHVybiBlbmQKCiAgICAtLS8vIEZldGNoIGNsYXNzIHRhYmxlCglsb2NhbCBDbGFzc0RhdGEgPSBzZWxmOkdldENsYXNzRGF0YShSZW1vdGUpCglpZiBub3QgQ2xhc3NEYXRhIHRoZW4gcmV0dXJuIGVuZAoKICAgIC0tLy8gQ2hlY2sgaWYgdGhlIHRyYW5zZmVyIHR5cGUgaGFzIGRhdGEKCWxvY2FsIEFsbG93ZWQgPSBDbGFzc0RhdGFbVHJhbnNmZXJUeXBlXQoJaWYgbm90IEFsbG93ZWQgdGhlbiByZXR1cm4gZW5kCgogICAgLS0vLyBDaGVjayBpZiB0aGUgbWV0aG9kIGlzIGFsbG93ZWQKCWlmIE1ldGhvZCB0aGVuCgkJcmV0dXJuIHRhYmxlLmZpbmQoQWxsb3dlZCwgTWV0aG9kKSB+PSBuaWwKCWVuZAoKCXJldHVybiB0cnVlCmVuZAoKZnVuY3Rpb24gUHJvY2VzczpTZXRFeHRyYURhdGEoRGF0YTogdGFibGUpCiAgICBpZiBub3QgRGF0YSB0aGVuIHJldHVybiBlbmQKICAgIHNlbGYuRXh0cmFEYXRhID0gRGF0YQplbmQKCmZ1bmN0aW9uIFByb2Nlc3M6R2V0UmVtb3RlU3Bvb2YoUmVtb3RlOiBJbnN0YW5jZSwgTWV0aG9kOiBzdHJpbmcsIC4uLik6IHRhYmxlPwogICAgbG9jYWwgU3Bvb2YgPSBSZXR1cm5TcG9vZnNbUmVtb3RlXQoKICAgIGlmIG5vdCBTcG9vZiB0aGVuIHJldHVybiBlbmQKICAgIGlmIFNwb29mLk1ldGhvZCB+PSBNZXRob2QgdGhlbiByZXR1cm4gZW5kCgogICAgbG9jYWwgUmV0dXJuVmFsdWVzID0gU3Bvb2YuUmV0dXJuCgogICAgLS0vLyBDYWxsIHRoZSBSZXR1cm5WYWx1ZXMgZnVuY3Rpb24gdHlwZQogICAgaWYgdHlwZW9mKFJldHVyblZhbHVlcykgPT0gImZ1bmN0aW9uIiB0aGVuCiAgICAgICAgUmV0dXJuVmFsdWVzID0gUmV0dXJuVmFsdWVzKC4uLikKICAgIGVuZAoKCXJldHVybiBSZXR1cm5WYWx1ZXMKZW5kCgpmdW5jdGlvbiBQcm9jZXNzOlNldE5ld1JldHVyblNwb29mcyhOZXdSZXR1cm5TcG9vZnM6IHRhYmxlKQogICAgUmV0dXJuU3Bvb2ZzID0gTmV3UmV0dXJuU3Bvb2ZzCmVuZAoKZnVuY3Rpb24gUHJvY2VzczpGaW5kQ2FsbGluZ0xDbG9zdXJlKE9mZnNldDogbnVtYmVyKQogICAgbG9jYWwgR2V0ZmVudiA9IEhvb2s6R2V0T3JpZ2luYWxGdW5jKGdldGZlbnYpCiAgICBPZmZzZXQgKz0gMQoKICAgIHdoaWxlIHRydWUgZG8KICAgICAgICBPZmZzZXQgKz0gMQoKICAgICAgICAtLS8vIENoZWNrIGlmIHRoZSBzdGFjayBsZXZlbCBpcyB2YWxpZAogICAgICAgIGxvY2FsIElzVmFsaWQgPSBkZWJ1Zy5pbmZvKE9mZnNldCwgImwiKSB+PSAtMQogICAgICAgIGlmIG5vdCBJc1ZhbGlkIHRoZW4gY29udGludWUgZW5kCgogICAgICAgIC0tLy8gQ2hlY2sgaWYgdGhlIGZ1bmN0aW9uIGlzIHZhbGlkCiAgICAgICAgbG9jYWwgRnVuY3Rpb24gPSBkZWJ1Zy5pbmZvKE9mZnNldCwgImYiKQogICAgICAgIGlmIG5vdCBGdW5jdGlvbiB0aGVuIHJldHVybiBlbmQKICAgICAgICBpZiBHZXRmZW52KEZ1bmN0aW9uKSA9PSBTaWdtYUVOViB0aGVuIGNvbnRpbnVlIGVuZAoKICAgICAgICByZXR1cm4gRnVuY3Rpb24KICAgIGVuZAplbmQKCmZ1bmN0aW9uIFByb2Nlc3M6RGVjb21waWxlKFNjcmlwdDogTG9jYWxTY3JpcHQgfCBNb2R1bGVTY3JpcHQpOiBzdHJpbmcKICAgIGxvY2FsIEtvbnN0YW50QVBJID0gImh0dHA6Ly9hcGkucGx1c2dpYW50NS5jb20va29uc3RhbnQvZGVjb21waWxlIgogICAgbG9jYWwgRm9yY2VLb25zdGFudCA9IENvbmZpZy5Gb3JjZUtvbnN0YW50RGVjb21waWxlcgoKICAgIC0tLy8gVXNlIGJ1aWx0LWluIGRlY29tcGlsZXIgaWYgdGhlIGV4ZWN1dG9yIHN1cHBvcnRzIGl0CiAgICBpZiBkZWNvbXBpbGUgYW5kIG5vdCBGb3JjZUtvbnN0YW50IHRoZW4gCiAgICAgICAgcmV0dXJuIGRlY29tcGlsZShTY3JpcHQpCiAgICBlbmQKCiAgICAtLS8vIGdldHNjcmlwdGJ5dGVjb2RlCiAgICBsb2NhbCBTdWNjZXNzLCBCeXRlY29kZSA9IHBjYWxsKGdldHNjcmlwdGJ5dGVjb2RlLCBTY3JpcHQpCiAgICBpZiBub3QgU3VjY2VzcyB0aGVuCiAgICAgICAgbG9jYWwgRXJyb3IgPSBgLS1GYWlsZWQgdG8gZ2V0IHNjcmlwdCBieXRlY29kZSwgZXJyb3I6XG5gCiAgICAgICAgRXJyb3IgLi49IGBcbi0tW1tcbntCeXRlY29kZX1cbl1dYAogICAgICAgIHJldHVybiBFcnJvciwgdHJ1ZQogICAgZW5kCiAgICAKICAgIC0tLy8gU2VuZCBQT1NUIHJlcXVlc3QgdG8gdGhlIEFQSQogICAgbG9jYWwgUmVzcG9uY2UgPSByZXF1ZXN0KHsKICAgICAgICBVcmwgPSBLb25zdGFudEFQSSwKICAgICAgICBCb2R5ID0gQnl0ZWNvZGUsCiAgICAgICAgTWV0aG9kID0gIlBPU1QiLAogICAgICAgIEhlYWRlcnMgPSB7CiAgICAgICAgICAgIFsiQ29udGVudC1UeXBlIl0gPSAidGV4dC9wbGFpbiIKICAgICAgICB9LAogICAgfSkKCiAgICAtLS8vIEVycm9yIGNoZWNrCiAgICBpZiBSZXNwb25jZS5TdGF0dXNDb2RlIH49IDIwMCB0aGVuCiAgICAgICAgbG9jYWwgRXJyb3IgPSBgLS1bS09OU1RBTlRdIEVycm9yIG9jY3VyZWQgd2hpbGUgcmVxdWVzdGluZyB0aGUgQVBJLCBlcnJvcjpcbmAKICAgICAgICBFcnJvciAuLj0gYFxuLS1bW1xue1Jlc3BvbmNlLkJvZHl9XG5dXWAKICAgICAgICByZXR1cm4gRXJyb3IsIHRydWUKICAgIGVuZAoKICAgIHJldHVybiBSZXNwb25jZS5Cb2R5CmVuZAoKZnVuY3Rpb24gUHJvY2VzczpHZXRTY3JpcHRGcm9tRnVuYyhGdW5jOiAoLi4uYW55KSAtPiAuLi5hbnkpCiAgICBpZiBub3QgRnVuYyB0aGVuIHJldHVybiBlbmQKCiAgICBsb2NhbCBTdWNjZXNzLCBFTlYgPSBwY2FsbChnZXRmZW52LCBGdW5jKQogICAgaWYgbm90IFN1Y2Nlc3MgdGhlbiByZXR1cm4gZW5kCiAgICAKICAgIC0tLy8gQmxhY2tsaXN0IHNpZ21hIHNweQogICAgaWYgc2VsZjpJc1NpZ21hU3B5RU5WKEVOVikgdGhlbiByZXR1cm4gZW5kCgogICAgcmV0dXJuIHJhd2dldChFTlYsICJzY3JpcHQiKQplbmQKCmZ1bmN0aW9uIFByb2Nlc3M6Q29ubmVjdGlvbklzVmFsaWQoQ29ubmVjdGlvbjogdGFibGUpOiBib29sZWFuCiAgICBsb2NhbCBWYWx1ZVJlcGxhY2VtZW50cyA9IHsKCQlbIlNjcmlwdCJdID0gZnVuY3Rpb24oQ29ubmVjdGlvbjogdGFibGUpOiBTY3JpcHQ/CgkJCWxvY2FsIEZ1bmN0aW9uID0gQ29ubmVjdGlvbi5GdW5jdGlvbgoJCQlpZiBub3QgRnVuY3Rpb24gdGhlbiByZXR1cm4gZW5kCgoJCQlyZXR1cm4gc2VsZjpHZXRTY3JpcHRGcm9tRnVuYyhGdW5jdGlvbikKCQllbmQKCX0KCiAgICAtLS8vIENoZWNrIGlmIHRoZXNlIHByb3BlcnRpZXMgYXJlIHZhbGlkCiAgICBsb2NhbCBUb0NoZWNrID0gewogICAgICAgICJTY3JpcHQiCiAgICB9CiAgICBmb3IgXywgUHJvcGVydHkgaW4gVG9DaGVjayBkbwogICAgICAgIGxvY2FsIFJlcGxhY2VtZW50ID0gVmFsdWVSZXBsYWNlbWVudHNbUHJvcGVydHldCiAgICAgICAgbG9jYWwgVmFsdWUKCiAgICAgICAgLS0vLyBDaGVjayBpZiB0aGVyZSdzIGEgZnVuY3Rpb24gZm9yIGEgcHJvcGVydHkKICAgICAgICBpZiBSZXBsYWNlbWVudCB0aGVuCiAgICAgICAgICAgIFZhbHVlID0gUmVwbGFjZW1lbnQoQ29ubmVjdGlvbikKICAgICAgICBlbmQKCiAgICAgICAgLS0vLyBDaGVjayBpZiB0aGUgcHJvcGVydHkgaGFzIGEgdmFsdWUKICAgICAgICBpZiBWYWx1ZSA9PSBuaWwgdGhlbiAKICAgICAgICAgICAgcmV0dXJuIGZhbHNlIAogICAgICAgIGVuZAogICAgZW5kCgogICAgcmV0dXJuIHRydWUKZW5kCgpmdW5jdGlvbiBQcm9jZXNzOkZpbHRlckNvbm5lY3Rpb25zKFNpZ25hbDogUkJYU2NyaXB0U2lnbmFsKTogdGFibGUKICAgIGxvY2FsIFByb2Nlc3NlZCA9IHt9CgogICAgLS0vLyBGaWx0ZXIgZWFjaCBjb25uZWN0aW9uCiAgICBmb3IgXywgQ29ubmVjdGlvbiBpbiBnZXRjb25uZWN0aW9ucyhTaWduYWwpIGRvCiAgICAgICAgaWYgbm90IHNlbGY6Q29ubmVjdGlvbklzVmFsaWQoQ29ubmVjdGlvbikgdGhlbiBjb250aW51ZSBlbmQKICAgICAgICB0YWJsZS5pbnNlcnQoUHJvY2Vzc2VkLCBDb25uZWN0aW9uKQogICAgZW5kCgogICAgcmV0dXJuIFByb2Nlc3NlZAplbmQKCmZ1bmN0aW9uIFByb2Nlc3M6SXNTaWdtYVNweUVOVihFbnY6IHRhYmxlKTogYm9vbGVhbgogICAgcmV0dXJuIEVudiA9PSBTaWdtYUVOVgplbmQKCmZ1bmN0aW9uIFByb2Nlc3M6R2V0UmVtb3RlRGF0YShJZDogc3RyaW5nKQogICAgbG9jYWwgUmVtb3RlT3B0aW9ucyA9IHNlbGYuUmVtb3RlT3B0aW9ucwoKICAgIC0tLy8gQ2hlY2sgZm9yIGV4aXN0aW5nIHJlbW90ZSBkYXRhCglsb2NhbCBFeGlzdGluZyA9IFJlbW90ZU9wdGlvbnNbSWRdCglpZiBFeGlzdGluZyB0aGVuIHJldHVybiBFeGlzdGluZyBlbmQKCQogICAgLS0vLyBCYXNlIHJlbW90ZSBkYXRhCglsb2NhbCBEYXRhID0gewoJCUV4Y2x1ZGVkID0gZmFsc2UsCgkJQmxvY2tlZCA9IGZhbHNlCgl9CgoJUmVtb3RlT3B0aW9uc1tJZF0gPSBEYXRhCglyZXR1cm4gRGF0YQplbmQKCmZ1bmN0aW9uIFByb2Nlc3M6Q2FsbERpc2NvcmRSUEMoQm9keTogdGFibGUpCiAgICByZXF1ZXN0KHsKICAgICAgICBVcmwgPSAiaHR0cDovLzEyNy4wLjAuMTo2NDYzL3JwYz92PTEiLAogICAgICAgIE1ldGhvZCA9ICJQT1NUIiwKICAgICAgICBIZWFkZXJzID0gewogICAgICAgICAgICBbIkNvbnRlbnQtVHlwZSJdID0gImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICAgICBbIk9yaWdpbiJdID0gImh0dHBzOi8vZGlzY29yZC5jb20vIgogICAgICAgIH0sCiAgICAgICAgQm9keSA9IEh0dHBTZXJ2aWNlOkpTT05FbmNvZGUoQm9keSkKICAgIH0pCmVuZAoKZnVuY3Rpb24gUHJvY2VzczpQcm9tcHREaXNjb3JkSW52aXRlKEludml0ZUNvZGU6IHN0cmluZykKICAgIHNlbGY6Q2FsbERpc2NvcmRSUEMoewogICAgICAgIGNtZCA9ICJJTlZJVEVfQlJPV1NFUiIsCiAgICAgICAgbm9uY2UgPSBIdHRwU2VydmljZTpHZW5lcmF0ZUdVSUQoZmFsc2UpLAogICAgICAgIGFyZ3MgPSB7CiAgICAgICAgICAgIGNvZGUgPSBJbnZpdGVDb2RlCiAgICAgICAgfQogICAgfSkKZW5kCgpsb2NhbCBQcm9jZXNzQ2FsbGJhY2sgPSBuZXdjY2xvc3VyZShmdW5jdGlvbihEYXRhOiBSZW1vdGVEYXRhLCBSZW1vdGUsIC4uLik6IHRhYmxlPwogICAgLS0vLyBVbnBhY2sgRGF0YQogICAgbG9jYWwgT3JpZ2luYWxGdW5jID0gRGF0YS5PcmlnaW5hbEZ1bmMKICAgIGxvY2FsIElkID0gRGF0YS5JZAogICAgbG9jYWwgTWV0aG9kID0gRGF0YS5NZXRob2QKCiAgICAtLS8vIENoZWNrIGlmIHRoZSBSZW1vdGUgaXMgQmxvY2tlZAogICAgbG9jYWwgUmVtb3RlRGF0YSA9IFByb2Nlc3M6R2V0UmVtb3RlRGF0YShJZCkKICAgIGlmIFJlbW90ZURhdGEuQmxvY2tlZCB0aGVuIHJldHVybiB7fSBlbmQKCiAgICAtLS8vIENoZWNrIGZvciBhIHNwb29mCiAgICBsb2NhbCBTcG9vZiA9IFByb2Nlc3M6R2V0UmVtb3RlU3Bvb2YoUmVtb3RlLCBNZXRob2QsIE9yaWdpbmFsRnVuYywgLi4uKQogICAgaWYgU3Bvb2YgdGhlbiByZXR1cm4gU3Bvb2YgZW5kCgogICAgLS0vLyBDaGVjayBpZiB0aGUgb3JpZ25hbCBmdW5jdGlvbiB3YXMgcGFzc2VkCiAgICBpZiBub3QgT3JpZ2luYWxGdW5jIHRoZW4gcmV0dXJuIGVuZAoKICAgIC0tLy8gSW52b2tlIG9yaWduYWwgZnVuY3Rpb24KICAgIHJldHVybiB7CiAgICAgICAgT3JpZ2luYWxGdW5jKFJlbW90ZSwgLi4uKQogICAgfQplbmQpCgpmdW5jdGlvbiBQcm9jZXNzOlByb2Nlc3NSZW1vdGUoRGF0YTogUmVtb3RlRGF0YSwgUmVtb3RlLCAuLi4pOiB0YWJsZT8KICAgIC0tLy8gVW5wYWNrIERhdGEKCWxvY2FsIE1ldGhvZCA9IERhdGEuTWV0aG9kCiAgICBsb2NhbCBUcmFuc2ZlclR5cGUgPSBEYXRhLlRyYW5zZmVyVHlwZQogICAgbG9jYWwgSXNSZWNlaXZlID0gRGF0YS5Jc1JlY2VpdmUKCgktLS8vIENoZWNrIGlmIHRoZSB0cmFuc2ZlcnR5cGUgbWV0aG9kIGlzIGFsbG93ZWQKCWlmIFRyYW5zZmVyVHlwZSBhbmQgbm90IHNlbGY6UmVtb3RlQWxsb3dlZChSZW1vdGUsIFRyYW5zZmVyVHlwZSwgTWV0aG9kKSB0aGVuIHJldHVybiBlbmQKCiAgICAtLS8vIEZldGNoIGRldGFpbHMKICAgIGxvY2FsIElkID0gQ29tbXVuaWNhdGlvbjpHZXREZWJ1Z0lkKFJlbW90ZSkKICAgIGxvY2FsIENsYXNzRGF0YSA9IHNlbGY6R2V0Q2xhc3NEYXRhKFJlbW90ZSkKICAgIGxvY2FsIFRpbWVzdGFtcCA9IHRpY2soKQoKICAgIGxvY2FsIENhbGxpbmdGdW5jdGlvbgogICAgbG9jYWwgU291cmNlU2NyaXB0CgogICAgLS0vLyBBZGQgZXh0cmEgZGF0YSBpbnRvIHRoZSBsb2cgaWYgbmVlZGVkCiAgICBsb2NhbCBFeHRyYURhdGEgPSBzZWxmLkV4dHJhRGF0YQogICAgaWYgRXh0cmFEYXRhIHRoZW4KICAgICAgICBzZWxmOk1lcmdlKERhdGEsIEV4dHJhRGF0YSkKICAgIGVuZAoKICAgIC0tLy8gR2V0IGNhbGxlciBpbmZvcm1hdGlvbgogICAgaWYgbm90IElzUmVjZWl2ZSB0aGVuCiAgICAgICAgQ2FsbGluZ0Z1bmN0aW9uID0gc2VsZjpGaW5kQ2FsbGluZ0xDbG9zdXJlKDYpCiAgICAgICAgU291cmNlU2NyaXB0ID0gQ2FsbGluZ0Z1bmN0aW9uIGFuZCBzZWxmOkdldFNjcmlwdEZyb21GdW5jKENhbGxpbmdGdW5jdGlvbikgb3IgbmlsCiAgICBlbmQKCiAgICAtLS8vIEFkZCB0byBxdWV1ZQogICAgc2VsZjpNZXJnZShEYXRhLCB7CiAgICAgICAgUmVtb3RlID0gY2xvbmVyZWYoUmVtb3RlKSwKCQlDYWxsaW5nU2NyaXB0ID0gZ2V0Y2FsbGluZ3NjcmlwdCgpLAogICAgICAgIENhbGxpbmdGdW5jdGlvbiA9IENhbGxpbmdGdW5jdGlvbiwKICAgICAgICBTb3VyY2VTY3JpcHQgPSBTb3VyY2VTY3JpcHQsCiAgICAgICAgSWQgPSBJZCwKCQlDbGFzc0RhdGEgPSBDbGFzc0RhdGEsCiAgICAgICAgVGltZXN0YW1wID0gVGltZXN0YW1wLAogICAgICAgIEFyZ3MgPSB7Li4ufQogICAgfSkKCiAgICAtLS8vIEludm9rZSB0aGUgUmVtb3RlIGFuZCBsb2cgcmV0dXJuIHZhbHVlcwogICAgbG9jYWwgUmV0dXJuVmFsdWVzID0gUHJvY2Vzc0NhbGxiYWNrKERhdGEsIFJlbW90ZSwgLi4uKQogICAgRGF0YS5SZXR1cm5WYWx1ZXMgPSBSZXR1cm5WYWx1ZXMKCiAgICAtLS8vIFF1ZXVlIGxvZwogICAgQ29tbXVuaWNhdGlvbjpRdWV1ZUxvZyhEYXRhKQoKICAgIHJldHVybiBSZXR1cm5WYWx1ZXMKZW5kCgpmdW5jdGlvbiBQcm9jZXNzOlNldEFsbFJlbW90ZURhdGEoS2V5OiBzdHJpbmcsIFZhbHVlKQogICAgbG9jYWwgUmVtb3RlT3B0aW9ucyA9IHNlbGYuUmVtb3RlT3B0aW9ucwoJZm9yIFJlbW90ZUlELCBEYXRhIGluIG5leHQsIFJlbW90ZU9wdGlvbnMgZG8KCQlEYXRhW0tleV0gPSBWYWx1ZQoJZW5kCmVuZAoKLS0vLyBUaGUgY29tbXVuaWNhdGlvbiBjcmVhdGVzIGEgZGlmZmVyZW50IHRhYmxlIGFkZHJlc3MKLS0vLyBSZWNpdmVkIHRhYmxlcyB3aWxsIG5vdCBiZSB0aGUgc2FtZQpmdW5jdGlvbiBQcm9jZXNzOlNldFJlbW90ZURhdGEoSWQ6IHN0cmluZywgUmVtb3RlRGF0YTogdGFibGUpCiAgICBsb2NhbCBSZW1vdGVPcHRpb25zID0gc2VsZi5SZW1vdGVPcHRpb25zCiAgICBSZW1vdGVPcHRpb25zW0lkXSA9IFJlbW90ZURhdGEKZW5kCgpmdW5jdGlvbiBQcm9jZXNzOlVwZGF0ZVJlbW90ZURhdGEoSWQ6IHN0cmluZywgUmVtb3RlRGF0YTogdGFibGUpCiAgICBDb21tdW5pY2F0aW9uOkNvbW11bmljYXRlKCJSZW1vdGVEYXRhIiwgSWQsIFJlbW90ZURhdGEpCmVuZAoKZnVuY3Rpb24gUHJvY2VzczpVcGRhdGVBbGxSZW1vdGVEYXRhKEtleTogc3RyaW5nLCBWYWx1ZSkKICAgIENvbW11bmljYXRpb246Q29tbXVuaWNhdGUoIkFsbFJlbW90ZURhdGEiLCBLZXksIFZhbHVlKQplbmQKCnJldHVybiBQcm9jZXNz]]
},Hook={'base64',
[[LS1bWwoKCVRha2luZyBteSBtZXRob2RzIPCfkpbwn5KWCglJIGxvdmUgYSBwYXN0ZXIgYW5kIGEgc2tpZCwgcHV0cyBkaXNndXN0IGluIG15IGZhY2UKCl1dCgpsb2NhbCBIb29rID0gewoJT3JpZ2luYWxOYW1lY2FsbCA9IG5pbCwKCU9yaWdpbmFsSW5kZXggPSBuaWwsCglQcmV2aW91c0Z1bmN0aW9ucyA9IHt9LAoJRGVmYXVsdENvbmZpZyA9IHsKCQlGdW5jdGlvblBhdGNoZXMgPSB0cnVlCgl9Cn0KCnR5cGUgdGFibGUgPSB7CglbYW55XTogYW55Cn0KCnR5cGUgTWV0YUZ1bmMgPSAoSW5zdGFuY2UsIC4uLmFueSkgLT4gLi4uYW55CnR5cGUgVW5rRnVuYyA9ICguLi5hbnkpIC0+IC4uLmFueQoKLS0vLyBNb2R1bGVzCmxvY2FsIE1vZHVsZXMKbG9jYWwgUHJvY2Vzcwpsb2NhbCBDb25maWd1cmF0aW9uCmxvY2FsIENvbmZpZwpsb2NhbCBDb21tdW5pY2F0aW9uCgpsb2NhbCBFeGVFTlYgPSBnZXRmZW52KDEpCgpmdW5jdGlvbiBIb29rOkluaXQoRGF0YSkKICAgIE1vZHVsZXMgPSBEYXRhLk1vZHVsZXMKCglQcm9jZXNzID0gTW9kdWxlcy5Qcm9jZXNzCglDb21tdW5pY2F0aW9uID0gTW9kdWxlcy5Db21tdW5pY2F0aW9uIG9yIENvbW11bmljYXRpb24KCUNvbmZpZyA9IE1vZHVsZXMuQ29uZmlnIG9yIENvbmZpZwoJQ29uZmlndXJhdGlvbiA9IE1vZHVsZXMuQ29uZmlndXJhdGlvbiBvciBDb25maWd1cmF0aW9uCmVuZAoKLS0vLyBUaGUgY2FsbGJhY2sgaXMgZXhwZWN0ZWQgdG8gcmV0dXJuIGEgbmlsIHZhbHVlIHNvbWV0aW1lcyB3aGljaCBzaG91bGQgYmUgaW5nb3JlZApsb2NhbCBIb29rTWlkZGxlID0gbmV3Y2Nsb3N1cmUoZnVuY3Rpb24oT3JpZ2luYWxGdW5jLCBDYWxsYmFjaywgQWx3YXlzVGFibGU6IGJvb2xlYW4/LCAuLi4pCgktLS8vIEludm9rZSBjYWxsYmFjayBhbmQgY2hlY2sgZm9yIGEgcmVwb25jZSBvdGhlcndpc2UgaWdub3JlZAoJbG9jYWwgUmV0dXJuVmFsdWVzID0gQ2FsbGJhY2soLi4uKQoJaWYgUmV0dXJuVmFsdWVzIHRoZW4KCQktLS8vIFVucGFjawoJCWlmIG5vdCBBbHdheXNUYWJsZSB0aGVuCgkJCXJldHVybiBQcm9jZXNzOlVucGFjayhSZXR1cm5WYWx1ZXMpCgkJZW5kCgoJCS0tLy8gUmV0dXJuIHBhY2tlZCByZXNwb25jZQoJCXJldHVybiBSZXR1cm5WYWx1ZXMKCWVuZAoKCS0tLy8gUmV0dXJuIHBhY2tlZCByZXNwb25jZQoJaWYgQWx3YXlzVGFibGUgdGhlbgoJCXJldHVybiB7T3JpZ2luYWxGdW5jKC4uLil9CgllbmQKCgktLS8vIFVucGFja2VkCglyZXR1cm4gT3JpZ2luYWxGdW5jKC4uLikKZW5kKQoKbG9jYWwgZnVuY3Rpb24gTWVyZ2UoQmFzZTogdGFibGUsIE5ldzogdGFibGUpCglmb3IgS2V5LCBWYWx1ZSBpbiBuZXh0LCBOZXcgZG8KCQlCYXNlW0tleV0gPSBWYWx1ZQoJZW5kCmVuZAoKZnVuY3Rpb24gSG9vazpJbmRleChPYmplY3Q6IEluc3RhbmNlLCBLZXk6IHN0cmluZykKCXJldHVybiBPYmplY3RbS2V5XQplbmQKCmZ1bmN0aW9uIEhvb2s6UHVzaENvbmZpZyhPdmVyd3JpdGVzKQogICAgTWVyZ2Uoc2VsZiwgT3ZlcndyaXRlcykKZW5kCgotLS8vIGdldHJhd21ldGF0YWJsZQpmdW5jdGlvbiBIb29rOlJlcGxhY2VNZXRhTWV0aG9kKE9iamVjdDogSW5zdGFuY2UsIENhbGw6IHN0cmluZywgQ2FsbGJhY2s6IE1ldGFGdW5jKTogTWV0YUZ1bmMKCWxvY2FsIE1ldGF0YWJsZSA9IGdldHJhd21ldGF0YWJsZShPYmplY3QpCglsb2NhbCBPcmlnaW5hbEZ1bmMgPSBjbG9uZWZ1bmN0aW9uKE1ldGF0YWJsZVtDYWxsXSkKCQoJLS0vLyBSZXBsYWNlIGZ1bmN0aW9uCglzZXRyZWFkb25seShNZXRhdGFibGUsIGZhbHNlKQoJTWV0YXRhYmxlW0NhbGxdID0gbmV3Y2Nsb3N1cmUoZnVuY3Rpb24oLi4uKQoJCXJldHVybiBIb29rTWlkZGxlKE9yaWdpbmFsRnVuYywgQ2FsbGJhY2ssIGZhbHNlLCAuLi4pCgllbmQpCglzZXRyZWFkb25seShNZXRhdGFibGUsIHRydWUpCgoJcmV0dXJuIE9yaWdpbmFsRnVuYwplbmQKCi0tLy8gaG9va2Z1bmN0aW9uCmZ1bmN0aW9uIEhvb2s6SG9va0Z1bmN0aW9uKEZ1bmM6IFVua0Z1bmMsIENhbGxiYWNrOiBVbmtGdW5jKQoJbG9jYWwgT3JpZ2luYWxGdW5jCglsb2NhbCBXcmFwcGVkQ2FsbGJhY2sgPSBuZXdjY2xvc3VyZShDYWxsYmFjaykKCU9yaWdpbmFsRnVuYyA9IGNsb25lZnVuY3Rpb24oaG9va2Z1bmN0aW9uKEZ1bmMsIGZ1bmN0aW9uKC4uLikKCQlyZXR1cm4gSG9va01pZGRsZShPcmlnaW5hbEZ1bmMsIFdyYXBwZWRDYWxsYmFjaywgZmFsc2UsIC4uLikKCWVuZCkpCglyZXR1cm4gT3JpZ2luYWxGdW5jCmVuZAoKLS0vLyBob29rbWV0YW1ldGhvZApmdW5jdGlvbiBIb29rOkhvb2tNZXRhQ2FsbChPYmplY3Q6IEluc3RhbmNlLCBDYWxsOiBzdHJpbmcsIENhbGxiYWNrOiBNZXRhRnVuYyk6IE1ldGFGdW5jCglsb2NhbCBNZXRhdGFibGUgPSBnZXRyYXdtZXRhdGFibGUoT2JqZWN0KQoJbG9jYWwgVW5ob29rZWQKCQoJVW5ob29rZWQgPSBzZWxmOkhvb2tGdW5jdGlvbihNZXRhdGFibGVbQ2FsbF0sIGZ1bmN0aW9uKC4uLikKCQlyZXR1cm4gSG9va01pZGRsZShVbmhvb2tlZCwgQ2FsbGJhY2ssIHRydWUsIC4uLikKCWVuZCkKCXJldHVybiBVbmhvb2tlZAplbmQKCmZ1bmN0aW9uIEhvb2s6SG9va01ldGFNZXRob2QoT2JqZWN0OiBJbnN0YW5jZSwgQ2FsbDogc3RyaW5nLCBDYWxsYmFjazogTWV0YUZ1bmMpOiBNZXRhRnVuYwoJbG9jYWwgRnVuYyA9IG5ld2NjbG9zdXJlKENhbGxiYWNrKQoJCgktLS8vIEdldHJhd21ldGF0YWJsZQoJaWYgQ29uZmlnLlJlcGxhY2VNZXRhQ2FsbEZ1bmMgdGhlbgoJCXJldHVybiBzZWxmOlJlcGxhY2VNZXRhTWV0aG9kKE9iamVjdCwgQ2FsbCwgRnVuYykKCWVuZAoJCgktLS8vIEhvb2ttZXRhbWV0aG9kCglyZXR1cm4gc2VsZjpIb29rTWV0YUNhbGwoT2JqZWN0LCBDYWxsLCBGdW5jKQplbmQKCi0tLy8gVGhpcyBpbmNsdWRlcyBhIGZldyBwYXRjaGVzIGZvciBleGVjdXRvciBmdW5jdGlvbnMgdGhhdCByZXN1bHQgaW4gZGV0ZWN0aW9uCi0tLy8gVGhpcyBpc24ndCBidWxsZXRwcm9vZiBzaW5jZSBzb21lIGZ1bmN0aW9ucyBsaWtlIGhvb2tmdW5jdGlvbiBJIGNhbid0IHBhdGNoCi0tLy8gQnkgdGhlIHdheSwgdGhhbmtzIGZvciBjb3B5aW5nIHRoaXMgZ3V5cyEgU3VwZXIgYXBwcmVjaWF0ZSB0aGUgY29weWNhdApmdW5jdGlvbiBIb29rOlBhdGNoRnVuY3Rpb25zKCkKCS0tLy8gQ2hlY2sgaWYgdGhpcyBmdW5jdGlvbiBpcyBkaXNhYmxlZCBpbiB0aGUgY29uZmlndXJhdGlvbgoJaWYgQ29uZmlnLk5vRnVuY3Rpb25QYXRjaGluZyB0aGVuIHJldHVybiBlbmQKCglsb2NhbCBQYXRjaGVzID0gewoJCS0tLy8gRXJyb3IgZGV0ZWN0aW9uIHBhdGNoCgkJLS0vLyBob29rZnVuY3Rpb24gbWF5IHN0aWxsIGJlIGRldGVjdGVkIGRlcGVuZGluZyBvbiB0aGUgZXhlY3V0b3IKCQlbcGNhbGxdID0gIGZ1bmN0aW9uKE9sZEZ1bmMsIEZ1bmMsIC4uLikKCQkJbG9jYWwgUmVzcG9uY2UgPSB7T2xkRnVuYyhGdW5jLCAuLi4pfQoJCQlsb2NhbCBTdWNjZXNzLCBFcnJvciA9IFJlc3BvbmNlWzFdLCBSZXNwb25jZVsyXQoJCQlsb2NhbCBJc0MgPSBpc2NjbG9zdXJlKEZ1bmMpCgoJCQktLS8vIFBhdGNoIGMtY2xvc3VyZSBlcnJvciBkZXRlY3Rpb24KCQkJaWYgU3VjY2VzcyA9PSBmYWxzZSBhbmQgSXNDIHRoZW4KCQkJCWxvY2FsIE5ld0Vycm9yID0gUHJvY2VzczpDbGVhbkNFcnJvcihFcnJvcikKCQkJCVJlc3BvbmNlWzJdID0gTmV3RXJyb3IKCQkJZW5kCgoJCQktLS8vIFN0YWNrLW92ZXJmbG93IGRldGVjdGlvbiBwYXRjaAoJCQlpZiBTdWNjZXNzID09IGZhbHNlIGFuZCBub3QgSXNDIGFuZCBFcnJvcjpmaW5kKCJDIHN0YWNrIG92ZXJmbG93IikgdGhlbgoJCQkJbG9jYWwgVHJhY2V0YWJsZSA9IEVycm9yOnNwbGl0KCI6IikKCQkJCWxvY2FsIENhbGxlciwgTGluZSA9IFRyYWNldGFibGVbMV0sIFRyYWNldGFibGVbMl0KCQkJCWxvY2FsIENvdW50ID0gUHJvY2VzczpDb3VudE1hdGNoZXMoRXJyb3IsIENhbGxlcikKCgkJCQlpZiBDb3VudCA9PSAxOTYgdGhlbgoJCQkJCUNvbW11bmljYXRpb246Q29uc29sZVByaW50KGBDIHN0YWNrIG92ZXJmbG93IHBhdGNoZWQsIGNvdW50IHdhcyB7Q291bnR9YCkKCQkJCQlSZXNwb25jZVsyXSA9IEVycm9yOmdzdWIoYHtDYWxsZXJ9OntMaW5lfTogYCwgQ2FsbGVyLCAxKQoJCQkJZW5kCgkJCWVuZAoKCQkJcmV0dXJuIFJlc3BvbmNlCgkJZW5kLAoJCVtnZXRmZW52XSA9IGZ1bmN0aW9uKE9sZEZ1bmMsIExldmVsOiBudW1iZXIsIC4uLikKCQkJTGV2ZWwgPSBMZXZlbCBvciAxCgoJCQktLS8vIFByZXZlbnQgY2F0cHVyZSBvZiBleGVjdXRvcidzIGVudgoJCQlpZiB0eXBlKExldmVsKSA9PSAibnVtYmVyIiB0aGVuCgkJCQlMZXZlbCArPSAyCgkJCWVuZAoKCQkJbG9jYWwgUmVzcG9uY2UgPSB7T2xkRnVuYyhMZXZlbCwgLi4uKX0KCQkJbG9jYWwgRU5WID0gUmVzcG9uY2VbMV0KCgkJCS0tLy8gX190b3N0cmluZyBFTlYgZGV0ZWN0aW9uIHBhdGNoCgkJCWlmIG5vdCBjaGVja2NhbGxlcigpIGFuZCBFTlYgPT0gRXhlRU5WIHRoZW4KCQkJCUNvbW11bmljYXRpb246Q29uc29sZVByaW50KCJFTlYgZXNjYXBlIHBhdGNoZWQiKQoJCQkJcmV0dXJuIE9sZEZ1bmMoOTk5OTk5LCAuLi4pCgkJCWVuZAoKCQkJcmV0dXJuIFJlc3BvbmNlCgkJZW5kCgl9CgoJLS0vLyBIb29rIGVhY2ggZnVuY3Rpb24KCWZvciBGdW5jLCBDYWxsQmFjayBpbiBQYXRjaGVzIGRvCgkJbG9jYWwgV3JhcHBlZCA9IG5ld2NjbG9zdXJlKENhbGxCYWNrKQoJCWxvY2FsIE9sZEZ1bmM7IE9sZEZ1bmMgPSBzZWxmOkhvb2tGdW5jdGlvbihGdW5jLCBmdW5jdGlvbiguLi4pCgkJCXJldHVybiBXcmFwcGVkKE9sZEZ1bmMsIC4uLikKCQllbmQpCgoJCS0tLy8gQ2FjaGUgcHJldmlvdXMgZnVuY3Rpb24KCQlzZWxmLlByZXZpb3VzRnVuY3Rpb25zW0Z1bmNdID0gT2xkRnVuYwoJZW5kCmVuZAoKZnVuY3Rpb24gSG9vazpHZXRPcmlnaW5hbEZ1bmMoRnVuYykKCXJldHVybiBzZWxmLlByZXZpb3VzRnVuY3Rpb25zW0Z1bmNdIG9yIEZ1bmMKZW5kCgpmdW5jdGlvbiBIb29rOlJ1bk9uQWN0b3JzKENvZGU6IHN0cmluZywgQ2hhbm5lbElkOiBudW1iZXIpCglpZiBub3QgZ2V0YWN0b3JzIG9yIG5vdCBydW5fb25fYWN0b3IgdGhlbiByZXR1cm4gZW5kCgkKCWxvY2FsIEFjdG9ycyA9IGdldGFjdG9ycygpCglpZiBub3QgQWN0b3JzIHRoZW4gcmV0dXJuIGVuZAoJCglmb3IgXywgQWN0b3IgaW4gQWN0b3JzIGRvIAoJCXBjYWxsKHJ1bl9vbl9hY3RvciwgQWN0b3IsIENvZGUsIENoYW5uZWxJZCkKCWVuZAplbmQKCmxvY2FsIGZ1bmN0aW9uIFByb2Nlc3NSZW1vdGUoT3JpZ2luYWxGdW5jLCBNZXRhTWV0aG9kOiBzdHJpbmcsIHNlbGYsIE1ldGhvZDogc3RyaW5nLCAuLi4pCglyZXR1cm4gUHJvY2VzczpQcm9jZXNzUmVtb3RlKHsKCQlNZXRob2QgPSBNZXRob2QsCgkJT3JpZ2luYWxGdW5jID0gT3JpZ2luYWxGdW5jLAoJCU1ldGFNZXRob2QgPSBNZXRhTWV0aG9kLAoJCVRyYW5zZmVyVHlwZSA9ICJTZW5kIiwKCQlJc0V4cGxvaXQgPSBjaGVja2NhbGxlcigpCgl9LCBzZWxmLCAuLi4pCmVuZAoKZnVuY3Rpb24gSG9vazpIb29rUmVtb3RlVHlwZUluZGV4KENsYXNzTmFtZTogc3RyaW5nLCBGdW5jTmFtZTogc3RyaW5nKQoJbG9jYWwgUmVtb3RlID0gSW5zdGFuY2UubmV3KENsYXNzTmFtZSkKCWxvY2FsIEZ1bmMgPSBSZW1vdGVbRnVuY05hbWVdCglsb2NhbCBPcmlnaW5hbEZ1bmMKCgktLS8vIFJlbW90ZXMgd2lsbCBzaGFyZSB0aGUgc2FtZSBmdW5jdGlvbnMKCS0tLy8gCUZvciBleGFtcGxlIEZpcmVTZXJ2ZXIgd2lsbCBiZSBpZGVudGljYWwKCS0tLy8gQWRkaW9uYWxseSwgdGhpcyBpcyBmb3IgX19pbmRleCBjYWxscy4KCS0tLy8gCUEgX19uYW1lY2FsbCBob29rIHdpbGwgbm90IGRldGVjdCB0aGlzCglPcmlnaW5hbEZ1bmMgPSBzZWxmOkhvb2tGdW5jdGlvbihGdW5jLCBmdW5jdGlvbihzZWxmLCAuLi4pCgkJLS0vLyBDaGVjayBpZiB0aGUgT2JqZWN0IGlzIGFsbG93ZWQgCgkJaWYgbm90IFByb2Nlc3M6UmVtb3RlQWxsb3dlZChzZWxmLCAiU2VuZCIsIEZ1bmNOYW1lKSB0aGVuIHJldHVybiBlbmQKCgkJLS0vLyBQcm9jZXNzIHRoZSByZW1vdGUgZGF0YQoJCXJldHVybiBQcm9jZXNzUmVtb3RlKE9yaWdpbmFsRnVuYywgIl9faW5kZXgiLCBzZWxmLCBGdW5jTmFtZSwgLi4uKQoJZW5kKQplbmQKCmZ1bmN0aW9uIEhvb2s6SG9va1JlbW90ZUluZGV4ZXMoKQoJbG9jYWwgUmVtb3RlQ2xhc3NEYXRhID0gUHJvY2Vzcy5SZW1vdGVDbGFzc0RhdGEKCWZvciBDbGFzc05hbWUsIERhdGEgaW4gUmVtb3RlQ2xhc3NEYXRhIGRvCgkJbG9jYWwgRnVuY05hbWUgPSBEYXRhLlNlbmRbMV0KCQlzZWxmOkhvb2tSZW1vdGVUeXBlSW5kZXgoQ2xhc3NOYW1lLCBGdW5jTmFtZSkKCWVuZAplbmQKCmZ1bmN0aW9uIEhvb2s6QmVnaW5Ib29rcygpCgktLS8vIEhvb2sgUmVtb3RlIGZ1bmN0aW9ucwoJc2VsZjpIb29rUmVtb3RlSW5kZXhlcygpCgoJLS0vLyBOYW1lY2FsbCBob29rCglsb2NhbCBPcmlnaW5hbE5hbWVDYWxsCglPcmlnaW5hbE5hbWVDYWxsID0gc2VsZjpIb29rTWV0YU1ldGhvZChnYW1lLCAiX19uYW1lY2FsbCIsIGZ1bmN0aW9uKHNlbGYsIC4uLikKCQlsb2NhbCBNZXRob2QgPSBnZXRuYW1lY2FsbG1ldGhvZCgpCgkJcmV0dXJuIFByb2Nlc3NSZW1vdGUoT3JpZ2luYWxOYW1lQ2FsbCwgIl9fbmFtZWNhbGwiLCBzZWxmLCBNZXRob2QsIC4uLikKCWVuZCkKCglNZXJnZShzZWxmLCB7CgkJT3JpZ2luYWxOYW1lY2FsbCA9IE9yaWdpbmFsTmFtZUNhbGwsCgkJLS1PcmlnaW5hbEluZGV4ID0gT2kKCX0pCmVuZAoKZnVuY3Rpb24gSG9vazpIb29rQ2xpZW50SW52b2tlKFJlbW90ZSwgTWV0aG9kLCBDYWxsYmFjaykKCWxvY2FsIFN1Y2Nlc3MsIEZ1bmN0aW9uID0gcGNhbGwoZnVuY3Rpb24oKQoJCXJldHVybiBnZXRjYWxsYmFja3ZhbHVlKFJlbW90ZSwgTWV0aG9kKQoJZW5kKQoKCS0tLy8gU29tZSBleGVjdXRvcnMgbGlrZSBQb3Rhc3NpdW0gd2lsbCB0aHJvdyBhIGVycm9yIGlmIHRoZSBDYWxsYmFjayB2YWx1ZSBpcyBuaWwKCWlmIG5vdCBTdWNjZXNzIHRoZW4gcmV0dXJuIGVuZAoJaWYgbm90IEZ1bmN0aW9uIHRoZW4gcmV0dXJuIGVuZAoJCgktLS8vIFRlc3QgaG9va2Z1bmN0aW9uCglsb2NhbCBIb29rU3VjY2VzcyA9IHBjYWxsKGZ1bmN0aW9uKCkKCQlzZWxmOkhvb2tGdW5jdGlvbihGdW5jdGlvbiwgQ2FsbGJhY2spCgllbmQpCglpZiBIb29rU3VjY2VzcyB0aGVuIHJldHVybiBlbmQKCgktLS8vIFJlcGxhY2UgY2FsbGJhY2sgZnVuY3Rpb24gb3RoZXJ3aXNlCglSZW1vdGVbTWV0aG9kXSA9IGZ1bmN0aW9uKC4uLikKCQlyZXR1cm4gSG9va01pZGRsZShGdW5jdGlvbiwgQ2FsbGJhY2ssIGZhbHNlLCAuLi4pCgllbmQKZW5kCgpmdW5jdGlvbiBIb29rOk11bHRpQ29ubmVjdChSZW1vdGVzKQoJZm9yIF8sIFJlbW90ZSBpbiBuZXh0LCBSZW1vdGVzIGRvCgkJc2VsZjpDb25uZWN0Q2xpZW50UmVjaXZlKFJlbW90ZSkKCWVuZAplbmQKCmZ1bmN0aW9uIEhvb2s6Q29ubmVjdENsaWVudFJlY2l2ZShSZW1vdGUpCgktLS8vIENoZWNrIGlmIHRoZSBSZW1vdGUgY2xhc3MgaXMgYWxsb3dlZCBmb3IgcmVjZWl2aW5nCglsb2NhbCBBbGxvd2VkID0gUHJvY2VzczpSZW1vdGVBbGxvd2VkKFJlbW90ZSwgIlJlY2VpdmUiKQoJaWYgbm90IEFsbG93ZWQgdGhlbiByZXR1cm4gZW5kCgoJLS0vLyBDaGVjayBpZiB0aGUgT2JqZWN0IGhhcyBSZW1vdGUgY2xhc3MgZGF0YQogICAgbG9jYWwgQ2xhc3NEYXRhID0gUHJvY2VzczpHZXRDbGFzc0RhdGEoUmVtb3RlKQogICAgbG9jYWwgSXNSZW1vdGVGdW5jdGlvbiA9IENsYXNzRGF0YS5Jc1JlbW90ZUZ1bmN0aW9uCglsb2NhbCBOb1JlY2l2ZUhvb2sgPSBDbGFzc0RhdGEuTm9SZWNpdmVIb29rCiAgICBsb2NhbCBNZXRob2QgPSBDbGFzc0RhdGEuUmVjZWl2ZVsxXQoKCS0tLy8gQ2hlY2sgaWYgdGhlIFJlY2l2ZSBzaG91bGQgYmUgaG9va2VkCglpZiBOb1JlY2l2ZUhvb2sgdGhlbiByZXR1cm4gZW5kCgoJLS0vLyBOZXcgY2FsbGJhY2sgZnVuY3Rpb24KCWxvY2FsIGZ1bmN0aW9uIENhbGxiYWNrKC4uLikKICAgICAgICByZXR1cm4gUHJvY2VzczpQcm9jZXNzUmVtb3RlKHsKICAgICAgICAgICAgTWV0aG9kID0gTWV0aG9kLAogICAgICAgICAgICBJc1JlY2VpdmUgPSB0cnVlLAogICAgICAgICAgICBNZXRhTWV0aG9kID0gIkNvbm5lY3QiLAoJCQlJc0V4cGxvaXQgPSBjaGVja2NhbGxlcigpCiAgICAgICAgfSwgUmVtb3RlLCAuLi4pCgllbmQKCgktLS8vIENvbm5lY3QgcmVtb3RlCglpZiBub3QgSXNSZW1vdGVGdW5jdGlvbiB0aGVuCiAgIAkJUmVtb3RlW01ldGhvZF06Q29ubmVjdChDYWxsYmFjaykKCWVsc2UgLS0gUmVtb3RlIGZ1bmN0aW9ucwoJCXNlbGY6SG9va0NsaWVudEludm9rZShSZW1vdGUsIE1ldGhvZCwgQ2FsbGJhY2spCgllbmQKZW5kCgpmdW5jdGlvbiBIb29rOkJlZ2luU2VydmljZShMaWJyYXJpZXMsIEV4dHJhRGF0YSwgQ2hhbm5lbElkLCAuLi4pCgktLS8vIExpYnJhcmVpcwoJbG9jYWwgUmV0dXJuU3Bvb2ZzID0gTGlicmFyaWVzLlJldHVyblNwb29mcwoJbG9jYWwgUHJvY2Vzc0xpYiA9IExpYnJhcmllcy5Qcm9jZXNzCglsb2NhbCBDb21tdW5pY2F0aW9uID0gTGlicmFyaWVzLkNvbW11bmljYXRpb24KCWxvY2FsIEdlbmVyYXRpb24gPSBMaWJyYXJpZXMuR2VuZXJhdGlvbgoJbG9jYWwgQ29uZmlnID0gTGlicmFyaWVzLkNvbmZpZwoKCS0tLy8gQ2hlY2sgZm9yIGNvbmZpZ3VyYXRpb24gb3ZlcndyaXRlcwoJUHJvY2Vzc0xpYjpDaGVja0NvbmZpZyhDb25maWcpCgoJLS0vLyBJbml0IGRhdGEKCWxvY2FsIEluaXREYXRhID0gewoJCU1vZHVsZXMgPSB7CgkJCVJldHVyblNwb29mcyA9IFJldHVyblNwb29mcywKCQkJR2VuZXJhdGlvbiA9IEdlbmVyYXRpb24sCgkJCUNvbW11bmljYXRpb24gPSBDb21tdW5pY2F0aW9uLAoJCQlQcm9jZXNzID0gUHJvY2Vzc0xpYiwKCQkJQ29uZmlnID0gQ29uZmlnLAoJCQlIb29rID0gc2VsZgoJCX0sCgkJU2VydmljZXMgPSBzZXRtZXRhdGFibGUoe30sIHsKCQkJX19pbmRleCA9IGZ1bmN0aW9uKHNlbGYsIE5hbWU6IHN0cmluZyk6IEluc3RhbmNlCgkJCQlsb2NhbCBTZXJ2aWNlID0gZ2FtZTpHZXRTZXJ2aWNlKE5hbWUpCgkJCQlyZXR1cm4gY2xvbmVyZWYoU2VydmljZSkKCQkJZW5kLAoJCX0pCgl9CgoJLS0vLyBJbml0IGxpYnJhcmllcwoJQ29tbXVuaWNhdGlvbjpJbml0KEluaXREYXRhKQoJUHJvY2Vzc0xpYjpJbml0KEluaXREYXRhKQoKCS0tLy8gQ29tbXVuaWNhdGlvbiBjb25maWd1cmF0aW9uCglsb2NhbCBDaGFubmVsLCBJc1dyYXBwZWQgPSBDb21tdW5pY2F0aW9uOkdldENvbW1DaGFubmVsKENoYW5uZWxJZCkKCUNvbW11bmljYXRpb246U2V0Q2hhbm5lbChDaGFubmVsKQoJQ29tbXVuaWNhdGlvbjpBZGRUeXBlQ2FsbGJhY2tzKHsKCQlbIlJlbW90ZURhdGEiXSA9IGZ1bmN0aW9uKElkOiBzdHJpbmcsIFJlbW90ZURhdGEpCgkJCVByb2Nlc3NMaWI6U2V0UmVtb3RlRGF0YShJZCwgUmVtb3RlRGF0YSkKCQllbmQsCgkJWyJBbGxSZW1vdGVEYXRhIl0gPSBmdW5jdGlvbihLZXk6IHN0cmluZywgVmFsdWUpCgkJCVByb2Nlc3NMaWI6U2V0QWxsUmVtb3RlRGF0YShLZXksIFZhbHVlKQoJCWVuZCwKCQlbIlVwZGF0ZVNwb29mcyJdID0gZnVuY3Rpb24oQ29udGVudDogc3RyaW5nKQoJCQlsb2NhbCBTcG9vZnMgPSBsb2Fkc3RyaW5nKENvbnRlbnQpKCkKCQkJUHJvY2Vzc0xpYjpTZXROZXdSZXR1cm5TcG9vZnMoU3Bvb2ZzKQoJCWVuZCwKCQlbIkJlZ2luSG9va3MiXSA9IGZ1bmN0aW9uKENvbmZpZykKCQkJaWYgQ29uZmlnLlBhdGNoRnVuY3Rpb25zIHRoZW4KCQkJCXNlbGY6UGF0Y2hGdW5jdGlvbnMoKQoJCQllbmQKCQkJc2VsZjpCZWdpbkhvb2tzKCkKCQkJQ29tbXVuaWNhdGlvbjpDb25zb2xlUHJpbnQoIkhvb2tzIGxvYWRlZCIpCgkJZW5kCgl9KQoJCgktLS8vIFByb2Nlc3MgY29uZmlndXJhdGlvbgoJUHJvY2Vzc0xpYjpTZXRDaGFubmVsKENoYW5uZWwsIElzV3JhcHBlZCkKCVByb2Nlc3NMaWI6U2V0RXh0cmFEYXRhKEV4dHJhRGF0YSkKCgktLS8vIEhvb2sgY29uZmlndXJhdGlvbgoJc2VsZjpJbml0KEluaXREYXRhKQoKCWlmIEV4dHJhRGF0YSBhbmQgRXh0cmFEYXRhLklzQWN0b3IgdGhlbgoJCUNvbW11bmljYXRpb246Q29uc29sZVByaW50KCJBY3RvciBjb25uZWN0ZWQhIikKCWVuZAplbmQKCmZ1bmN0aW9uIEhvb2s6TG9hZE1ldGFIb29rcyhBY3RvckNvZGU6IHN0cmluZywgQ2hhbm5lbElkOiBudW1iZXIpCgktLS8vIEhvb2sgYWN0b3JzCglpZiBub3QgQ29uZmlndXJhdGlvbi5Ob0FjdG9ycyB0aGVuCgkJc2VsZjpSdW5PbkFjdG9ycyhBY3RvckNvZGUsIENoYW5uZWxJZCkKCWVuZAoKCS0tLy8gSG9vayBjdXJyZW50IHRocmVhZAoJc2VsZjpCZWdpblNlcnZpY2UoTW9kdWxlcywgbmlsLCBDaGFubmVsSWQpIAplbmQKCmZ1bmN0aW9uIEhvb2s6TG9hZFJlY2VpdmVIb29rcygpCglsb2NhbCBOb1JlY2VpdmVIb29raW5nID0gQ29uZmlnLk5vUmVjZWl2ZUhvb2tpbmcKCWxvY2FsIEJsYWNrTGlzdGVkU2VydmljZXMgPSBDb25maWcuQmxhY2tMaXN0ZWRTZXJ2aWNlcwoKCWlmIE5vUmVjZWl2ZUhvb2tpbmcgdGhlbiByZXR1cm4gZW5kCgoJLS0vLyBSZW1vdGUgYWRkZWQKCWdhbWUuRGVzY2VuZGFudEFkZGVkOkNvbm5lY3QoZnVuY3Rpb24oUmVtb3RlKSAtLSBUT0RPCgkJc2VsZjpDb25uZWN0Q2xpZW50UmVjaXZlKFJlbW90ZSkKCWVuZCkKCgktLS8vIENvbGxlY3QgcmVtb3RlcyB3aXRoIG5pbCBwYXJlbnRzCglzZWxmOk11bHRpQ29ubmVjdChnZXRuaWxpbnN0YW5jZXMoKSkKCgktLS8vIFNlYXJjaCBmb3IgcmVtb3RlcwoJZm9yIF8sIFNlcnZpY2UgaW4gbmV4dCwgZ2FtZTpHZXRDaGlsZHJlbigpIGRvCgkJaWYgdGFibGUuZmluZChCbGFja0xpc3RlZFNlcnZpY2VzLCBTZXJ2aWNlLkNsYXNzTmFtZSkgdGhlbiBjb250aW51ZSBlbmQKCQlzZWxmOk11bHRpQ29ubmVjdChTZXJ2aWNlOkdldERlc2NlbmRhbnRzKCkpCgllbmQKZW5kCgpmdW5jdGlvbiBIb29rOkxvYWRIb29rcyhBY3RvckNvZGU6IHN0cmluZywgQ2hhbm5lbElkOiBudW1iZXIpCglzZWxmOkxvYWRNZXRhSG9va3MoQWN0b3JDb2RlLCBDaGFubmVsSWQpCglzZWxmOkxvYWRSZWNlaXZlSG9va3MoKQplbmQKCnJldHVybiBIb29rCg==]]
},Flags={'base64',
[[dHlwZSBGbGFnVmFsdWUgPSBib29sZWFufG51bWJlcnxhbnkKdHlwZSBGbGFnID0gewogICAgVmFsdWU6IEZsYWdWYWx1ZSwKICAgIExhYmVsOiBzdHJpbmcsCiAgICBDYXRlZ29yeTogc3RyaW5nCn0KdHlwZSBGbGFncyA9IHsKICAgIFtzdHJpbmddOiBGbGFnCn0KdHlwZSB0YWJsZSA9IHsKICAgIFthbnldOiBhbnkKfQoKbG9jYWwgTW9kdWxlID0gewogICAgRmxhZ3MgPSB7CiAgICAgICAgLS0gUHJldmVudFJlbmFtaW5nID0gewogICAgICAgIC0tICAgICBWYWx1ZSA9IGZhbHNlLAogICAgICAgIC0tICAgICBMYWJlbCA9ICJObyByZW5hbWluZyIsCiAgICAgICAgLS0gfSwKICAgICAgICAtLSBQcmV2ZW50UGFyZW50aW5nID0gewogICAgICAgIC0tICAgICBWYWx1ZSA9IGZhbHNlLAogICAgICAgIC0tICAgICBMYWJlbCA9ICJObyBwYXJlbnRpbmciLAogICAgICAgIC0tIH0sCiAgICAgICAgTm9Db21tZW50cyA9IHsKICAgICAgICAgICAgVmFsdWUgPSBmYWxzZSwKICAgICAgICAgICAgTGFiZWwgPSAiTm8gY29tbWVudHMiLAogICAgICAgIH0sCiAgICAgICAgU2VsZWN0TmV3ZXN0ID0gewogICAgICAgICAgICBWYWx1ZSA9IGZhbHNlLAogICAgICAgICAgICBMYWJlbCA9ICJBdXRvIHNlbGVjdCBuZXdlc3QiLAogICAgICAgIH0sCiAgICAgICAgRGVjb21waWxlUG9wb3V0ID0geyAtLSBMb3ZyZSBTSFVTSAogICAgICAgICAgICBWYWx1ZSA9IGZhbHNlLAogICAgICAgICAgICBMYWJlbCA9ICJQb3Atb3V0IGRlY29tcGlsZXMiLAogICAgICAgIH0sCiAgICAgICAgSWdub3JlTmlsID0gewogICAgICAgICAgICBWYWx1ZSA9IHRydWUsCiAgICAgICAgICAgIExhYmVsID0gIklnbm9yZSBuaWwgcGFyZW50cyIsCiAgICAgICAgfSwKICAgICAgICBMb2dFeHBsb2l0ID0gewogICAgICAgICAgICBWYWx1ZSA9IHRydWUsCiAgICAgICAgICAgIExhYmVsID0gIkxvZyBleHBsb2l0IGNhbGxzIiwKICAgICAgICB9LAogICAgICAgIExvZ1JlY2l2ZXMgPSB7CiAgICAgICAgICAgIFZhbHVlID0gdHJ1ZSwKICAgICAgICAgICAgTGFiZWwgPSAiTG9nIHJlY2VpdmVzIiwKICAgICAgICB9LAogICAgICAgIFBhdXNlZCA9IHsKICAgICAgICAgICAgVmFsdWUgPSBmYWxzZSwKICAgICAgICAgICAgTGFiZWwgPSAiUGF1c2VkIiwKICAgICAgICAgICAgS2V5YmluZCA9IEVudW0uS2V5Q29kZS5RCiAgICAgICAgfSwKICAgICAgICBLZXliaW5kc0VuYWJsZWQgPSB7CiAgICAgICAgICAgIFZhbHVlID0gdHJ1ZSwKICAgICAgICAgICAgTGFiZWwgPSAiS2V5YmluZHMgRW5hYmxlZCIKICAgICAgICB9LAogICAgICAgIEZpbmRTdHJpbmdGb3JOYW1lID0gewogICAgICAgICAgICBWYWx1ZSA9IHRydWUsCiAgICAgICAgICAgIExhYmVsID0gIkZpbmQgYXJnIGZvciBuYW1lIgogICAgICAgIH0sCiAgICAgICAgVWlWaXNpYmxlID0gewogICAgICAgICAgICBWYWx1ZSA9IHRydWUsCiAgICAgICAgICAgIExhYmVsID0gIlVJIFZpc2libGUiLAogICAgICAgICAgICBLZXliaW5kID0gRW51bS5LZXlDb2RlLlAKICAgICAgICB9LAogICAgICAgIE5vVHJlZU5vZGVzID0gewogICAgICAgICAgICBWYWx1ZSA9IGZhbHNlLAogICAgICAgICAgICBMYWJlbCA9ICJObyBncm91cGluZyIKICAgICAgICB9LAogICAgICAgIFRhYmxlQXJncyA9IHsKICAgICAgICAgICAgVmFsdWUgPSBmYWxzZSwKICAgICAgICAgICAgTGFiZWwgPSAiVGFibGUgYXJncyIKICAgICAgICB9LAogICAgICAgIE5vVmFyaWFibGVzID0gewogICAgICAgICAgICBWYWx1ZSA9IGZhbHNlLAogICAgICAgICAgICBMYWJlbCA9ICJObyBjb21wcmVzc2lvbiIKICAgICAgICB9CiAgICB9Cn0KCmZ1bmN0aW9uIE1vZHVsZTpHZXRGbGFnVmFsdWUoTmFtZTogc3RyaW5nKTogRmxhZ1ZhbHVlCiAgICBsb2NhbCBGbGFnID0gc2VsZjpHZXRGbGFnKE5hbWUpCiAgICByZXR1cm4gRmxhZy5WYWx1ZQplbmQKCmZ1bmN0aW9uIE1vZHVsZTpTZXRGbGFnVmFsdWUoTmFtZTogc3RyaW5nLCBWYWx1ZTogRmxhZ1ZhbHVlKQogICAgbG9jYWwgRmxhZyA9IHNlbGY6R2V0RmxhZyhOYW1lKQogICAgRmxhZy5WYWx1ZSA9IFZhbHVlCmVuZAoKZnVuY3Rpb24gTW9kdWxlOlNldEZsYWdDYWxsYmFjayhOYW1lOiBzdHJpbmcsIENhbGxiYWNrOiAoLi4uYW55KSAtPiAuLi5hbnkpCiAgICBsb2NhbCBGbGFnID0gc2VsZjpHZXRGbGFnKE5hbWUpCiAgICBGbGFnLkNhbGxiYWNrID0gQ2FsbGJhY2sKZW5kCgpmdW5jdGlvbiBNb2R1bGU6U2V0RmxhZ0NhbGxiYWNrcyhEaWN0OiB7fSkKICAgIGZvciBOYW1lLCBDYWxsYmFjazogKC4uLmFueSkgLT4gLi4uYW55IGluIG5leHQsIERpY3QgZG8gCiAgICAgICAgc2VsZjpTZXRGbGFnQ2FsbGJhY2soTmFtZSwgQ2FsbGJhY2spCiAgICBlbmQKZW5kCgpmdW5jdGlvbiBNb2R1bGU6R2V0RmxhZyhOYW1lOiBzdHJpbmcpOiBGbGFnCiAgICBsb2NhbCBBbGxGbGFncyA9IHNlbGY6R2V0RmxhZ3MoKQogICAgbG9jYWwgRmxhZyA9IEFsbEZsYWdzW05hbWVdCiAgICBhc3NlcnQoRmxhZywgIkZsYWcgZG9lcyBub3QgZXhpc3QhIikKICAgIHJldHVybiBGbGFnCmVuZAoKZnVuY3Rpb24gTW9kdWxlOkFkZEZsYWcoTmFtZTogc3RyaW5nLCBGbGFnOiBGbGFnKQogICAgbG9jYWwgQWxsRmxhZ3MgPSBzZWxmOkdldEZsYWdzKCkKICAgIEFsbEZsYWdzW05hbWVdID0gRmxhZwplbmQKCmZ1bmN0aW9uIE1vZHVsZTpHZXRGbGFncygpOiBGbGFncwogICAgcmV0dXJuIHNlbGYuRmxhZ3MKZW5kCgpyZXR1cm4gTW9kdWxl]]
},Ui={'base64',
[[bG9jYWwgVWkgPSB7CglEZWZhdWx0RWRpdG9yQ29udGVudCA9IFs9Wy0tW1sKCVNpZ21hIFNweSwgd3JpdHRlbiBieSBkZXBzbwoJSG9va3MgcmV3cml0dGVuIGFuZCBtYW55IG1vcmUgZml4ZXMhCgoJRGlzY29yZDogaHR0cHM6Ly9kaXNjb3JkLmdnL2JrVWttMnZTYnYKXV1dPV0sCglMb2dMaW1pdCA9IDEwMCwKICAgIFNlYXNvbkxhYmVscyA9IHsgCiAgICAgICAgSmFudWFyeSA9ICLim4QgJXMg4puEIiwgCiAgICAgICAgRmVicnVhcnkgPSAi8J+MqO+4jyAlcyDwn4+CIiwgCiAgICAgICAgTWFyY2ggPSAi8J+MuSAlc/CfjLogIiwgCiAgICAgICAgQXByaWwgPSAi8J+QoyAlcyDinJ3vuI8iLCAKICAgICAgICBNYXkgPSAi8J+QnSAlcyDwn4yeIiwgCiAgICAgICAgSnVuZSA9ICLwn4yyICVzIPCfpZUiLCAKICAgICAgICBKdWx5ID0gIvCfjIogJXMg8J+MhSIsIAogICAgICAgIEF1Z3VzdCA9ICLimIDvuI8gJXMg8J+MniIsIAogICAgICAgIFNlcHRlbWJlciA9ICLwn42BICVzIPCfjYEiLCAKICAgICAgICBPY3RvYmVyID0gIvCfjoMgJXMg8J+OgyIsIAogICAgICAgIE5vdmVtYmVyID0gIvCfjYIgJXMg8J+NgiIsIAogICAgICAgIERlY2VtYmVyID0gIvCfjoQgJXMg8J+OgSIKICAgIH0sCglTY2FsZXMgPSB7CgkJWyJNb2JpbGUiXSA9IFVEaW0yLmZyb21PZmZzZXQoNDgwLCAyODApLAoJCVsiRGVza3RvcCJdID0gVURpbTIuZnJvbU9mZnNldCg2MDAsIDQwMCksCgl9LAogICAgQmFzZUNvbmZpZyA9IHsKICAgICAgICBUaGVtZSA9ICJTaWdtYVNweSIsCiAgICAgICAgTm9TY3JvbGwgPSB0cnVlLAogICAgfSwKCU9wdGlvblR5cGVzID0gewoJCWJvb2xlYW4gPSAiQ2hlY2tib3giLAoJfSwKCURpc3BsYXlSZW1vdGVJbmZvID0gewoJCSJNZXRhTWV0aG9kIiwKCQkiTWV0aG9kIiwKCQkiUmVtb3RlIiwKCQkiQ2FsbGluZ1NjcmlwdCIsCgkJIklzQWN0b3IiLAoJCSJJZCIKCX0sCgogICAgV2luZG93ID0gbmlsLAogICAgUmFuZG9tU2VlZCA9IFJhbmRvbS5uZXcodGljaygpKSwKCUxvZ3MgPSBzZXRtZXRhdGFibGUoe30sIHtfX21vZGUgPSAiayJ9KSwKCUxvZ1F1ZXVlID0gc2V0bWV0YXRhYmxlKHt9LCB7X19tb2RlID0gInYifSksCn0gCgp0eXBlIHRhYmxlID0gewoJW2FueV06IGFueQp9Cgp0eXBlIExvZyA9IHsKCVJlbW90ZTogSW5zdGFuY2UsCglNZXRob2Q6IHN0cmluZywKCUFyZ3M6IHRhYmxlLAoJSXNSZWNlaXZlOiBib29sZWFuPywKCU1ldGFNZXRob2Q6IHN0cmluZz8sCglPcmlnbmFsRnVuYzogKCguLi5hbnkpIC0+IC4uLmFueSk/LAoJQ2FsbGluZ1NjcmlwdDogSW5zdGFuY2U/LAoJQ2FsbGluZ0Z1bmN0aW9uOiAoKC4uLmFueSkgLT4gLi4uYW55KT8sCglDbGFzc0RhdGE6IHRhYmxlPywKCVJldHVyblZhbHVlczogdGFibGU/LAoJUmVtb3RlRGF0YTogdGFibGU/LAoJSWQ6IHN0cmluZywKCVNlbGVjdGFibGU6IHRhYmxlLAoJSGVhZGVyRGF0YTogdGFibGUsCglWYWx1ZVN3YXBzOiB0YWJsZSwKCVRpbWVzdGFtcDogbnVtYmVyLAoJSXNFeHBsb2l0OiBib29sZWFuCn0KCi0tLy8gQ29tcGF0aWJpbGl0eQpsb2NhbCBTZXRDbGlwYm9hcmQgPSBzZXRjbGlwYm9hcmQgb3IgdG9jbGlwYm9hcmQgb3Igc2V0X2NsaXBib2FyZAoKLS0vLyBMaWJyYXJpZXMKbG9jYWwgUmVHdWkgPSBsb2Fkc3RyaW5nKGdhbWU6SHR0cEdldCgnaHR0cHM6Ly9naXRodWIuY29tL2RlcHRoc28vRGVhci1SZUd1aS9yYXcvcmVmcy9oZWFkcy9tYWluL1JlR3VpLmx1YScpLCAiUmVHdWkiKSgpCgotLS8vIE1vZHVsZXMKbG9jYWwgRmxhZ3MKbG9jYWwgR2VuZXJhdGlvbgpsb2NhbCBQcm9jZXNzCmxvY2FsIEhvb2sgCmxvY2FsIENvbmZpZwpsb2NhbCBDb21tdW5pY2F0aW9uCmxvY2FsIEZpbGVzCgpsb2NhbCBBY3RpdmVEYXRhID0gbmlsCmxvY2FsIFJlbW90ZXNDb3VudCA9IDAKCmxvY2FsIFRleHRGb250ID0gRm9udC5mcm9tRW51bShFbnVtLkZvbnQuQ29kZSkKbG9jYWwgRm9udFN1Y2Nlc3MgPSBmYWxzZQpsb2NhbCBDb21tQ2hhbm5lbAoKZnVuY3Rpb24gVWk6SW5pdChEYXRhKQogICAgbG9jYWwgTW9kdWxlcyA9IERhdGEuTW9kdWxlcwoKCS0tLy8gTW9kdWxlcwoJRmxhZ3MgPSBNb2R1bGVzLkZsYWdzCglHZW5lcmF0aW9uID0gTW9kdWxlcy5HZW5lcmF0aW9uCglQcm9jZXNzID0gTW9kdWxlcy5Qcm9jZXNzCglIb29rID0gTW9kdWxlcy5Ib29rCglDb25maWcgPSBNb2R1bGVzLkNvbmZpZwoJQ29tbXVuaWNhdGlvbiA9IE1vZHVsZXMuQ29tbXVuaWNhdGlvbgoJRmlsZXMgPSBNb2R1bGVzLkZpbGVzCgoJLS0vLyBSZUd1aQoJc2VsZjpMb2FkRm9udCgpCglzZWxmOkxvYWRSZUd1aSgpCglzZWxmOkNoZWNrU2NhbGUoKQplbmQKCmZ1bmN0aW9uIFVpOlNldENvbW1DaGFubmVsKE5ld0NvbW1DaGFubmVsOiBCaW5kYWJsZUV2ZW50KQoJQ29tbUNoYW5uZWwgPSBOZXdDb21tQ2hhbm5lbAplbmQKCmZ1bmN0aW9uIFVpOkNoZWNrU2NhbGUoKQoJbG9jYWwgQmFzZUNvbmZpZyA9IHNlbGYuQmFzZUNvbmZpZwoJbG9jYWwgU2NhbGVzID0gc2VsZi5TY2FsZXMKCglsb2NhbCBJc01vYmlsZSA9IFJlR3VpOklzTW9iaWxlRGV2aWNlKCkKCWxvY2FsIERldmljZSA9IElzTW9iaWxlIGFuZCAiTW9iaWxlIiBvciAiRGVza3RvcCIKCglCYXNlQ29uZmlnLlNpemUgPSBTY2FsZXNbRGV2aWNlXQplbmQKCmZ1bmN0aW9uIFVpOlNldENsaXBib2FyZChDb250ZW50OiBzdHJpbmcpCglTZXRDbGlwYm9hcmQoQ29udGVudCkKZW5kCgpmdW5jdGlvbiBVaTpUdXJuU2Vhc29uYWwoVGV4dDogc3RyaW5nKTogc3RyaW5nCiAgICBsb2NhbCBTZWFzb25MYWJlbHMgPSBzZWxmLlNlYXNvbkxhYmVscwogICAgbG9jYWwgTW9udGggPSBvcy5kYXRlKCIlQiIpCiAgICBsb2NhbCBCYXNlID0gU2Vhc29uTGFiZWxzW01vbnRoXQoKICAgIHJldHVybiBCYXNlOmZvcm1hdChUZXh0KQplbmQKCmZ1bmN0aW9uIFVpOkxvYWRGb250KCkKCWxvY2FsIEZvbnRGaWxlID0gc2VsZi5Gb250SnNvbkZpbGUKCgktLS8vIEdldCBGb250RmFjZSBBc3NldElkCglsb2NhbCBBc3NldElkID0gRmlsZXM6TG9hZEN1c3RvbWFzc2V0KEZvbnRGaWxlKQoJaWYgbm90IEFzc2V0SWQgdGhlbiByZXR1cm4gZW5kCgoJLS0vLyBDcmVhdGUgY3VzdG9tIEZvbnRGYWNlCglsb2NhbCBOZXdGb250ID0gRm9udC5uZXcoQXNzZXRJZCkKCVRleHRGb250ID0gTmV3Rm9udAoJRm9udFN1Y2Nlc3MgPSB0cnVlCmVuZAoKZnVuY3Rpb24gVWk6U2V0Rm9udEZpbGUoRm9udEZpbGU6IHN0cmluZykKCXNlbGYuRm9udEpzb25GaWxlID0gRm9udEZpbGUKZW5kCgpmdW5jdGlvbiBVaTpGb250V2FzU3VjY2Vzc2Z1bCgpCglpZiBGb250U3VjY2VzcyB0aGVuIHJldHVybiBlbmQKCgktLS8vIEVycm9yIG1lc3NhZ2UKCXNlbGY6U2hvd01vZGFsKHsKCQkiVW5mb3J0dW5hdGVseSB5b3VyIGV4ZWN1dG9yIHdhcyB1bmFibGUgdG8gZG93bmxvYWQgdGhlIGZvbnQgYW5kIHRoZXJlZm9yZSBzd2l0Y2hlZCB0byB0aGUgRGFyayB0aGVtZSIsCgkJIlxuSWYgeW91IHdvdWxkIGxpa2UgdG8gdXNlIHRoZSBJbUd1aSB0aGVtZSwgXG5wbGVhc2UgZG93bmxvYWQgdGhlIGZvbnQgKGFzc2V0cy9Qcm9nZ3lDbGVhbi50dGYpIiwKCQkiYW5kIHB1dCBwdXQgaXQgaW4geW91ciB3b3Jrc3BhY2UgZm9sZGVyXG4oU2lnbWEgU3B5L2Fzc2V0cykiCgl9KQplbmQKCmZ1bmN0aW9uIFVpOkxvYWRSZUd1aSgpCglsb2NhbCBUaGVtZUNvbmZpZyA9IENvbmZpZy5UaGVtZUNvbmZpZwoJVGhlbWVDb25maWcuVGV4dEZvbnQgPSBUZXh0Rm9udAoKCS0tLy8gUmVHdWkKCVJlR3VpOkRlZmluZVRoZW1lKCJTaWdtYVNweSIsIFRoZW1lQ29uZmlnKQplbmQKCnR5cGUgQ3JlYXRlQnV0dG9ucyA9IHsKCUJhc2U6IHRhYmxlPywKCUJ1dHRvbnM6IHRhYmxlLAoJTm9UYWJsZTogYm9vbGVhbj8KfQpmdW5jdGlvbiBVaTpDcmVhdGVCdXR0b25zKFBhcmVudCwgRGF0YTogQ3JlYXRlQnV0dG9ucykKCWxvY2FsIEJhc2UgPSBEYXRhLkJhc2Ugb3Ige30KCWxvY2FsIEJ1dHRvbnMgPSBEYXRhLkJ1dHRvbnMKCWxvY2FsIE5vVGFibGUgPSBEYXRhLk5vVGFibGUKCgktLS8vIENyZWF0ZSB0YWJsZSBsYXlvdXQKCWlmIG5vdCBOb1RhYmxlIHRoZW4KCQlQYXJlbnQgPSBQYXJlbnQ6VGFibGUoewoJCQlNYXhDb2x1bW5zID0gMwoJCX0pOk5leHRSb3coKQoJZW5kCgoJLS0vLyBDcmVhdGUgYnV0dG9ucwoJZm9yIF8sIEJ1dHRvbiBpbiBuZXh0LCBCdXR0b25zIGRvCgkJbG9jYWwgQ29udGFpbmVyID0gUGFyZW50CgkJaWYgbm90IE5vVGFibGUgdGhlbgoJCQlDb250YWluZXIgPSBQYXJlbnQ6TmV4dENvbHVtbigpCgkJZW5kCgoJCVJlR3VpOkNoZWNrQ29uZmlnKEJ1dHRvbiwgQmFzZSkKCQlDb250YWluZXI6QnV0dG9uKEJ1dHRvbikKCWVuZAplbmQKCmZ1bmN0aW9uIFVpOkNyZWF0ZVdpbmRvdyhXaW5kb3dDb25maWcpCiAgICBsb2NhbCBCYXNlQ29uZmlnID0gc2VsZi5CYXNlQ29uZmlnCglsb2NhbCBDb25maWcgPSBQcm9jZXNzOkRlZXBDbG9uZVRhYmxlKEJhc2VDb25maWcpCglQcm9jZXNzOk1lcmdlKENvbmZpZywgV2luZG93Q29uZmlnKQoKCS0tLy8gQ3JlYXRlIFdpbmRvdwoJbG9jYWwgV2luZG93ID0gUmVHdWk6V2luZG93KENvbmZpZykKCgktLS8vIFN3aXRjaCB0byBEYXJrVGhlbWUgaW5zdGVhZCBvZiB0aGUgSW1HdWkgdGhlbWUgaWYgdGhlIGZvbnQgY2Fubm90IGJlIGxvYWRlZAoJaWYgbm90IEZvbnRTdWNjZXNzIHRoZW4gCgkJV2luZG93OlNldFRoZW1lKCJEYXJrVGhlbWUiKQoJZW5kCgkKCS0tLy8gQ3JlYXRlIFdpbmRvdwoJcmV0dXJuIFdpbmRvdwplbmQKCnR5cGUgQXNrQ29uZmlnID0gewoJVGl0bGU6IHN0cmluZywKCUNvbnRlbnQ6IHRhYmxlLAoJT3B0aW9uczogdGFibGUKfQpmdW5jdGlvbiBVaTpBc2tVc2VyKENvbmZpZzogQXNrQ29uZmlnKTogc3RyaW5nCglsb2NhbCBXaW5kb3cgPSBzZWxmLldpbmRvdwoJbG9jYWwgQW5zd2VyZWQgPSBmYWxzZQoKCS0tLy8gQ3JlYXRlIG1vZGFsCglsb2NhbCBNb2RhbFdpbmRvdyA9IFdpbmRvdzpQb3B1cE1vZGFsKHsKCQlUaXRsZSA9IENvbmZpZy5UaXRsZQoJfSkKCU1vZGFsV2luZG93OkxhYmVsKHsKCQlUZXh0ID0gdGFibGUuY29uY2F0KENvbmZpZy5Db250ZW50LCAiXG4iKSwKCQlUZXh0V3JhcHBlZCA9IHRydWUKCX0pCglNb2RhbFdpbmRvdzpTZXBhcmF0b3IoKQoKCS0tLy8gQW5zd2VycwoJbG9jYWwgUm93ID0gTW9kYWxXaW5kb3c6Um93KHsKCQlFeHBhbmRlZCA9IHRydWUKCX0pCglmb3IgXywgQW5zd2VyIGluIG5leHQsIENvbmZpZy5PcHRpb25zIGRvCgkJUm93OkJ1dHRvbih7CgkJCVRleHQgPSBBbnN3ZXIsCgkJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQkJQW5zd2VyZWQgPSBBbnN3ZXIKCQkJCU1vZGFsV2luZG93OkNsb3NlUG9wdXAoKQoJCQllbmQsCgkJfSkKCWVuZAoKCXJlcGVhdCB3YWl0KCkgdW50aWwgQW5zd2VyZWQKCXJldHVybiBBbnN3ZXJlZAplbmQKCmZ1bmN0aW9uIFVpOkNyZWF0ZU1haW5XaW5kb3coKQoJbG9jYWwgV2luZG93ID0gc2VsZjpDcmVhdGVXaW5kb3coKQoJc2VsZi5XaW5kb3cgPSBXaW5kb3cKCgktLS8vIENoZWNrIGlmIHRoZSBmb250IHdhcyBzdWNjZXNzZnVsbHkgZG93bmxvYWRlZAoJc2VsZjpGb250V2FzU3VjY2Vzc2Z1bCgpCglzZWxmOkF1cmFDb3VudGVyU2VydmljZSgpCgoJLS0vLyBVaVZpc2libGUgZmxhZyBjYWxsYmFjawoJRmxhZ3M6U2V0RmxhZ0NhbGxiYWNrKCJVaVZpc2libGUiLCBmdW5jdGlvbihzZWxmLCBWaXNpYmxlKQoJCVdpbmRvdzpTZXRWaXNpYmxlKFZpc2libGUpCgllbmQpCgoJcmV0dXJuIFdpbmRvdwplbmQKCmZ1bmN0aW9uIFVpOlNob3dNb2RhbChMaW5lczogdGFibGUpCglsb2NhbCBXaW5kb3cgPSBzZWxmLldpbmRvdwoJbG9jYWwgTWVzc2FnZSA9IHRhYmxlLmNvbmNhdChMaW5lcywgIlxuIikKCgktLS8vIE1vZGFsIFdpbmRvdwoJbG9jYWwgTW9kYWxXaW5kb3cgPSBXaW5kb3c6UG9wdXBNb2RhbCh7CgkJVGl0bGUgPSAiU2lnbWEgU3B5IgoJfSkKCU1vZGFsV2luZG93OkxhYmVsKHsKCQlUZXh0ID0gTWVzc2FnZSwKCQlSaWNoVGV4dCA9IHRydWUsCgkJVGV4dFdyYXBwZWQgPSB0cnVlCgl9KQoJTW9kYWxXaW5kb3c6QnV0dG9uKHsKCQlUZXh0ID0gIk9rYXkiLAoJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQlNb2RhbFdpbmRvdzpDbG9zZVBvcHVwKCkKCQllbmQsCgl9KQplbmQKCmZ1bmN0aW9uIFVpOlNob3dVbnN1cHBvcnRlZEV4ZWN1dG9yKE5hbWU6IHN0cmluZykKCVVpOlNob3dNb2RhbCh7CgkJIlVuZm9ydHVuYXRlbHkgU2lnbWEgU3B5IGlzIG5vdCBzdXBwb3J0ZWQgb24geW91ciBleGVjdXRvciIsCgkJIlRoZSBiZXN0IGZyZWUgb3B0aW9uIGlzIFN3aWZ0IChkaXNjb3JkLmdnL2dldHN3aWZ0Z2cpIiwKCQlgXG5Zb3VyIGV4ZWN1dG9yOiB7TmFtZX1gCgl9KQplbmQKCmZ1bmN0aW9uIFVpOlNob3dVbnN1cHBvcnRlZChGdW5jTmFtZTogc3RyaW5nKQoJVWk6U2hvd01vZGFsKHsKCQkiVW5mb3J0dW5hdGVseSBTaWdtYSBTcHkgaXMgbm90IHN1cHBvcnRlZCBvbiB5b3VyIGV4ZWN1dG9yIiwKCQlgXG5NaXNzaW5nIGZ1bmN0aW9uOiB7RnVuY05hbWV9YAoJfSkKZW5kCgpmdW5jdGlvbiBVaTpDcmVhdGVPcHRpb25zRm9yRGljdChQYXJlbnQsIERpY3Q6IHRhYmxlLCBDYWxsYmFjaykKCWxvY2FsIE9wdGlvbnMgPSB7fQoKCS0tLy8gRGljdG9uYXJ5IHdyYXAKCWZvciBLZXksIFZhbHVlIGluIG5leHQsIERpY3QgZG8KCQlPcHRpb25zW0tleV0gPSB7CgkJCVZhbHVlID0gVmFsdWUsCgkJCUxhYmVsID0gS2V5LAoJCQlDYWxsYmFjayA9IGZ1bmN0aW9uKF8sIFZhbHVlKQoJCQkJRGljdFtLZXldID0gVmFsdWUKCgkJCQktLS8vIEludm9rZSBjYWxsYmFjawoJCQkJaWYgbm90IENhbGxiYWNrIHRoZW4gcmV0dXJuIGVuZAoJCQkJQ2FsbGJhY2soKQoJCQllbmQKCQl9CgllbmQKCgktLS8vIENyZWF0ZSBlbGVtZW50cwoJc2VsZjpDcmVhdGVFbGVtZW50cyhQYXJlbnQsIE9wdGlvbnMpCmVuZAoKZnVuY3Rpb24gVWk6Q2hlY2tLZXliaW5kTGF5b3V0KENvbnRhaW5lciwgS2V5Q29kZTogRW51bS5LZXlDb2RlLCBDYWxsYmFjaykKCWlmIG5vdCBLZXlDb2RlIHRoZW4gcmV0dXJuIENvbnRhaW5lciBlbmQKCgktLS8vIENyZWF0ZSBSb3cgbGF5b3V0CglDb250YWluZXIgPSBDb250YWluZXI6Um93KHsKCQlIb3Jpem9udGFsRmxleCA9IEVudW0uVUlGbGV4QWxpZ25tZW50LlNwYWNlQmV0d2VlbgoJfSkKCgktLS8vIEFkZCBLZXliaW5kIGVsZW1lbnQKCUNvbnRhaW5lcjpLZXliaW5kKHsKCQlMYWJlbCA9ICIiLAoJCVZhbHVlID0gS2V5Q29kZSwKCQlMYXlvdXRPcmRlciA9IDIsCgkJSWdub3JlR2FtZVByb2Nlc3NlZCA9IGZhbHNlLAoJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQktLS8vIENoZWNrIGlmIGtleWJpbmRzIGFyZSBlbmFibGVkCgkJCWxvY2FsIEVuYWJsZWQgPSBGbGFnczpHZXRGbGFnVmFsdWUoIktleWJpbmRzRW5hYmxlZCIpCgkJCWlmIG5vdCBFbmFibGVkIHRoZW4gcmV0dXJuIGVuZAoKCQkJLS0vLyBJbnZva2UgY2FsbGJhY2sKCQkJQ2FsbGJhY2soKQoJCWVuZCwKCX0pCgoJcmV0dXJuIENvbnRhaW5lcgplbmQKCmZ1bmN0aW9uIFVpOkNyZWF0ZUVsZW1lbnRzKFBhcmVudCwgT3B0aW9ucykKCWxvY2FsIE9wdGlvblR5cGVzID0gc2VsZi5PcHRpb25UeXBlcwoJCgktLS8vIENyZWF0ZSB0YWJsZSBsYXlvdXQKCWxvY2FsIFRhYmxlID0gUGFyZW50OlRhYmxlKHsKCQlNYXhDb2x1bW5zID0gMwoJfSk6TmV4dFJvdygpCgoJZm9yIE5hbWUsIERhdGEgaW4gT3B0aW9ucyBkbwoJCWxvY2FsIFZhbHVlID0gRGF0YS5WYWx1ZQoJCWxvY2FsIFR5cGUgPSB0eXBlb2YoVmFsdWUpCgoJCS0tLy8gQWRkIG1pc3NpbmcgdmFsdWVzIGludG8gb3B0aW9ucyB0YWJsZQoJCVJlR3VpOkNoZWNrQ29uZmlnKERhdGEsIHsKCQkJQ2xhc3MgPSBPcHRpb25UeXBlc1tUeXBlXSwKCQkJTGFiZWwgPSBOYW1lLAoJCX0pCgkJCgkJLS0vLyBDaGVjayBpZiBhIGVsZW1lbnQgdHlwZSBleGlzdHMgZm9yIHZhbHVlIHR5cGUKCQlsb2NhbCBDbGFzcyA9IERhdGEuQ2xhc3MKCQlhc3NlcnQoQ2xhc3MsIGBObyB7VHlwZX0gdHlwZSBleGlzdHMgZm9yIG9wdGlvbmApCgoJCWxvY2FsIENvbnRhaW5lciA9IFRhYmxlOk5leHRDb2x1bW4oKQoJCWxvY2FsIENoZWNrYm94ID0gbmlsCgoJCS0tLy8gQ2hlY2sgZm9yIGEga2V5YmluZCBsYXlvdXQKCQlsb2NhbCBLZXliaW5kID0gRGF0YS5LZXliaW5kCgkJQ29udGFpbmVyID0gc2VsZjpDaGVja0tleWJpbmRMYXlvdXQoQ29udGFpbmVyLCBLZXliaW5kLCBmdW5jdGlvbigpCgkJCUNoZWNrYm94OlRvZ2dsZSgpCgkJZW5kKQoJCQoJCS0tLy8gQ3JlYXRlIGNvbHVtbiBhbmQgZWxlbWVudAoJCUNoZWNrYm94ID0gQ29udGFpbmVyW0NsYXNzXShDb250YWluZXIsIERhdGEpCgllbmQKZW5kCgotLS8vIEJvaWlpaSB3aGF0IGRpZCB5b3Ugc2F5IGFib3V0IFNpZ21hIFNweSDwn5KA8J+SgApmdW5jdGlvbiBVaTpEaXNwbGF5QXVyYSgpCiAgICBsb2NhbCBXaW5kb3cgPSBzZWxmLldpbmRvdwogICAgbG9jYWwgUmFuZCA9IHNlbGYuUmFuZG9tU2VlZAoKCS0tLy8gQXVyYSAoYm9paWlpaSkKICAgIGxvY2FsIEFVUkEgPSBSYW5kOk5leHRJbnRlZ2VyKDEsIDk5OTk5OTkpCiAgICBsb2NhbCBBVVJBREVMQVkgPSBSYW5kOk5leHRJbnRlZ2VyKDEsIDUpCgoJLS0vLyBUaXRsZQoJbG9jYWwgVGl0bGUgPSBgU2lnbWEgU3B5IHwgQVVSQToge0FVUkF9YAoJbG9jYWwgU2Vhc29uYWwgPSBzZWxmOlR1cm5TZWFzb25hbChUaXRsZSkKICAgIFdpbmRvdzpTZXRUaXRsZShTZWFzb25hbCkKCiAgICB3YWl0KEFVUkFERUxBWSkKZW5kCgpmdW5jdGlvbiBVaTpBdXJhQ291bnRlclNlcnZpY2UoKQogICAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICAgICAgd2hpbGUgdHJ1ZSBkbwogICAgICAgICAgICBzZWxmOkRpc3BsYXlBdXJhKCkKICAgICAgICBlbmQKICAgIGVuZCkKZW5kCgpmdW5jdGlvbiBVaTpDcmVhdGVXaW5kb3dDb250ZW50KFdpbmRvdykKICAgIC0tLy8gV2luZG93IGdyb3VwCiAgICBsb2NhbCBMYXlvdXQgPSBXaW5kb3c6TGlzdCh7CiAgICAgICAgVWlQYWRkaW5nID0gMiwKICAgICAgICBIb3Jpem9udGFsRmxleCA9IEVudW0uVUlGbGV4QWxpZ25tZW50LkZpbGwsCiAgICAgICAgVmVydGljYWxGbGV4ID0gRW51bS5VSUZsZXhBbGlnbm1lbnQuRmlsbCwKICAgICAgICBGaWxsRGlyZWN0aW9uID0gRW51bS5GaWxsRGlyZWN0aW9uLlZlcnRpY2FsLAogICAgICAgIEZpbGwgPSB0cnVlCiAgICB9KQoKCS0tLy8gUmVtb3RlcyBsaXN0CiAgICBzZWxmLlJlbW90ZXNMaXN0ID0gTGF5b3V0OkNhbnZhcyh7CiAgICAgICAgU2Nyb2xsID0gdHJ1ZSwKICAgICAgICBVaVBhZGRpbmcgPSA1LAogICAgICAgIEF1dG9tYXRpY1NpemUgPSBFbnVtLkF1dG9tYXRpY1NpemUuTm9uZSwKICAgICAgICBGbGV4TW9kZSA9IEVudW0uVUlGbGV4TW9kZS5Ob25lLAogICAgICAgIFNpemUgPSBVRGltMi5uZXcoMCwgMTMwLCAxLCAwKQogICAgfSkKCgktLS8vIFRhYiBib3gKCWxvY2FsIEluZm9TZWxlY3RvciA9IExheW91dDpUYWJTZWxlY3Rvcih7CiAgICAgICAgTm9BbmltYXRpb24gPSB0cnVlLAogICAgICAgIFNpemUgPSBVRGltMi5uZXcoMSwgLTEzMCwgMC40LCAwKSwKICAgIH0pCgoJc2VsZi5JbmZvU2VsZWN0b3IgPSBJbmZvU2VsZWN0b3IKCXNlbGYuQ2FudmFzTGF5b3V0ID0gTGF5b3V0CgoJLS0vLyBNYWtlIHRhYnMKCXNlbGY6TWFrZUVkaXRvclRhYihJbmZvU2VsZWN0b3IpCglzZWxmOk1ha2VPcHRpb25zVGFiKEluZm9TZWxlY3RvcikKCQoJaWYgQ29uZmlnLkRlYnVnIHRoZW4KCQlzZWxmOkNvbnNvbGVUYWIoSW5mb1NlbGVjdG9yKQoJZW5kCmVuZAoKZnVuY3Rpb24gVWk6Q29uc29sZVRhYihJbmZvU2VsZWN0b3IpCglsb2NhbCBUYWIgPSBJbmZvU2VsZWN0b3I6Q3JlYXRlVGFiKHsKCQlOYW1lID0gIkNvbnNvbGUiCgl9KQoKCWxvY2FsIENvbnNvbGUKCWxvY2FsIEJ1dHRvbnNSb3cgPSBUYWI6Um93KCkKCglCdXR0b25zUm93OkJ1dHRvbih7CgkJVGV4dCA9ICJDbGVhciIsCgkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCUNvbnNvbGU6Q2xlYXIoKQoJCWVuZAoJfSkKCUJ1dHRvbnNSb3c6QnV0dG9uKHsKCQlUZXh0ID0gIkNvcHkiLAoJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQl0b2NsaXBib2FyZChDb25zb2xlOkdldFZhbHVlKCkpCgkJZW5kCgl9KQoJQnV0dG9uc1JvdzpCdXR0b24oewoJCVRleHQgPSAiUGF1c2UiLAoJCUNhbGxiYWNrID0gZnVuY3Rpb24oc2VsZikKCQkJbG9jYWwgRW5hYmxlZCA9IG5vdCBDb25zb2xlLkVuYWJsZWQKCQkJbG9jYWwgVGV4dCA9IEVuYWJsZWQgYW5kICJQYXVzZSIgb3IgIlBhdXNlZCIKCQkJc2VsZi5UZXh0ID0gVGV4dAoKCQkJLS0vLyBVcGRhdGUgY29uc29sZQoJCQlDb25zb2xlLkVuYWJsZWQgPSBFbmFibGVkCgkJZW5kLAoJfSkKCUJ1dHRvbnNSb3c6RXhwYW5kKCkKCgktLS8vIENyZWF0ZSBjb25zb2xlCglDb25zb2xlID0gVGFiOkNvbnNvbGUoewoJCVRleHQgPSAiLS0gQ3JlYXRlZCBieSBkZXBzbyIsCgkJUmVhZE9ubHkgPSB0cnVlLAoJCUJvcmRlciA9IGZhbHNlLAoJCUZpbGwgPSB0cnVlLAoJCUVuYWJsZWQgPSB0cnVlLAoJCUF1dG9TY3JvbGwgPSB0cnVlLAoJCVJpY2hUZXh0ID0gdHJ1ZSwKCQlNYXhMaW5lcyA9IDUwCgl9KQoKCXNlbGYuQ29uc29sZSA9IENvbnNvbGUKZW5kCgpmdW5jdGlvbiBVaTpDb25zb2xlTG9nKC4uLjogc3RyaW5nPykKCWxvY2FsIENvbnNvbGUgPSBzZWxmLkNvbnNvbGUKCWlmIG5vdCBDb25zb2xlIHRoZW4gcmV0dXJuIGVuZAoKCUNvbnNvbGU6QXBwZW5kVGV4dCguLi4pCmVuZAoKZnVuY3Rpb24gVWk6TWFrZU9wdGlvbnNUYWIoSW5mb1NlbGVjdG9yKQoJbG9jYWwgVGFiID0gSW5mb1NlbGVjdG9yOkNyZWF0ZVRhYih7CgkJTmFtZSA9ICJPcHRpb25zIgoJfSkKCgktLS8vIEFkZCBnbG9iYWwgb3B0aW9ucwoJVGFiOlNlcGFyYXRvcih7VGV4dD0iTG9ncyJ9KQoJc2VsZjpDcmVhdGVCdXR0b25zKFRhYiwgewoJCUJhc2UgPSB7CgkJCVNpemUgPSBVRGltMi5uZXcoMSwgMCwgMCwgMjApLAoJCQlBdXRvbWF0aWNTaXplID0gRW51bS5BdXRvbWF0aWNTaXplLlksCgkJfSwKCQlCdXR0b25zID0gewoJCQl7CgkJCQlUZXh0ID0gIkNsZWFyIGxvZ3MiLAoJCQkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCQkJbG9jYWwgVGFiID0gQWN0aXZlRGF0YSBhbmQgQWN0aXZlRGF0YS5UYWIgb3IgbmlsCgoJCQkJCS0tLy8gUmVtb3ZlIHRoZSBSZW1vdGUgdGFiCgkJCQkJaWYgVGFiIHRoZW4KCQkJCQkJSW5mb1NlbGVjdG9yOlJlbW92ZVRhYihUYWIpCgkJCQkJZW5kCgoJCQkJCS0tLy8gQ2xlYXIgYWxsIGxvZyBlbGVtZW50cwoJCQkJCUFjdGl2ZURhdGEgPSBuaWwKCQkJCQlzZWxmOkNsZWFyTG9ncygpCgkJCQllbmQsCgkJCX0sCgkJCXsKCQkJCVRleHQgPSAiQ2xlYXIgYmxvY2tzIiwKCQkJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQkJCVByb2Nlc3M6VXBkYXRlQWxsUmVtb3RlRGF0YSgiQmxvY2tlZCIsIGZhbHNlKQoJCQkJZW5kLAoJCQl9LAoJCQl7CgkJCQlUZXh0ID0gIkNsZWFyIGV4Y2x1ZGVzIiwKCQkJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQkJCVByb2Nlc3M6VXBkYXRlQWxsUmVtb3RlRGF0YSgiRXhjbHVkZWQiLCBmYWxzZSkKCQkJCWVuZCwKCQkJfSwKCQkJewoJCQkJVGV4dCA9ICJKb2luIERpc2NvcmQiLAoJCQkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCQkJUHJvY2VzczpQcm9tcHREaXNjb3JkSW52aXRlKCJzOW5nbVVEV2diIikKCQkJCQlzZWxmOlNldENsaXBib2FyZCgiaHR0cHM6Ly9kaXNjb3JkLmdnL3M5bmdtVURXZ2IiKQoJCQkJZW5kLAoJCQl9LAoJCQl7CgkJCQlUZXh0ID0gIkNvcHkgR2l0aHViIiwKCQkJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQkJCXNlbGY6U2V0Q2xpcGJvYXJkKCJodHRwczovL2dpdGh1Yi5jb20vZGVwdGhzby9TaWdtYS1TcHkiKQoJCQkJZW5kLAoJCQl9LAoJCQl7CgkJCQlUZXh0ID0gIkVkaXQgU3Bvb2ZzIiwKCQkJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQkJCXNlbGY6RWRpdEZpbGUoIlJldHVybiBzcG9vZnMubHVhIiwgdHJ1ZSwgZnVuY3Rpb24oV2luZG93LCBDb250ZW50OiBzdHJpbmcpCgkJCQkJCVdpbmRvdzpDbG9zZSgpCgkJCQkJCUNvbW1DaGFubmVsOkZpcmUoIlVwZGF0ZVNwb29mcyIsIENvbnRlbnQpCgkJCQkJZW5kKQoJCQkJZW5kLAoJCQl9CgkJfQoJfSkKCgktLS8vIEZsYWcgb3B0aW9ucwoJVGFiOlNlcGFyYXRvcih7VGV4dD0iU2V0dGluZ3MifSkKCXNlbGY6Q3JlYXRlRWxlbWVudHMoVGFiLCBGbGFnczpHZXRGbGFncygpKQoKCXNlbGY6QWRkRGV0YWlsc1NlY3Rpb24oVGFiKQplbmQKCmZ1bmN0aW9uIFVpOkFkZERldGFpbHNTZWN0aW9uKE9wdGlvbnNUYWIpCglPcHRpb25zVGFiOlNlcGFyYXRvcih7VGV4dD0iSW5mb3JtYXRpb24ifSkKCU9wdGlvbnNUYWI6QnVsbGV0VGV4dCh7CgkJUm93cyA9IHsKCQkJIlNpZ21hIHNweSAtIFdyaXR0ZW4gYnkgZGVwc28hIiwKCQkJIkxpYnJhcmllczogUm9ibG94LVBhcnNlciwgRGVhci1SZUd1aSIsCgkJCSJUaGFuayB5b3Ugc3luLmx1YSBmb3Igc3VnZ2VzdGluZyBJIG1ha2UgdGhpcyIKCQl9Cgl9KQplbmQKCmxvY2FsIGZ1bmN0aW9uIE1ha2VBY3RpdmVEYXRhQ2FsbGJhY2soTmFtZTogc3RyaW5nKQoJcmV0dXJuIGZ1bmN0aW9uKC4uLikKCQlpZiBub3QgQWN0aXZlRGF0YSB0aGVuIHJldHVybiBlbmQKCQlyZXR1cm4gQWN0aXZlRGF0YVtOYW1lXShBY3RpdmVEYXRhLCAuLi4pCgllbmQKZW5kCgpmdW5jdGlvbiBVaTpNYWtlRWRpdG9yVGFiKEluZm9TZWxlY3RvcikKCWxvY2FsIERlZmF1bHQgPSBzZWxmLkRlZmF1bHRFZGl0b3JDb250ZW50Cglsb2NhbCBTeW50YXhDb2xvcnMgPSBDb25maWcuU3ludGF4Q29sb3JzCgoJLS0vLyBDcmVhdGUgdGFiCglsb2NhbCBFZGl0b3JUYWIgPSBJbmZvU2VsZWN0b3I6Q3JlYXRlVGFiKHsKCQlOYW1lID0gIkVkaXRvciIKCX0pCgoJLS0vLyBJREUKCWxvY2FsIENvZGVFZGl0b3IgPSBFZGl0b3JUYWI6Q29kZUVkaXRvcih7CgkJRmlsbCA9IHRydWUsCgkJRWRpdGFibGUgPSB0cnVlLAoJCUZvbnRTaXplID0gMTMsCgkJQ29sb3JzID0gU3ludGF4Q29sb3JzLAoJCUZvbnRGYWNlID0gVGV4dEZvbnQsCgkJVGV4dCA9IERlZmF1bHQKCX0pCgoJLS0vLyBCdXR0b25zCglsb2NhbCBCdXR0b25zUm93ID0gRWRpdG9yVGFiOlJvdygpCglzZWxmOkNyZWF0ZUJ1dHRvbnMoQnV0dG9uc1JvdywgewoJCU5vVGFibGUgPSB0cnVlLAoJCUJ1dHRvbnMgPSB7CgkJCXsKCQkJCVRleHQgPSAiQ29weSIsCgkJCQlDYWxsYmFjayA9IGZ1bmN0aW9uKCkKCQkJCQlsb2NhbCBTY3JpcHQgPSBDb2RlRWRpdG9yOkdldFRleHQoKQoJCQkJCXNlbGY6U2V0Q2xpcGJvYXJkKFNjcmlwdCkKCQkJCWVuZAoJCQl9LAoJCQl7CgkJCQlUZXh0ID0gIlJ1biIsCgkJCQlDYWxsYmFjayA9IGZ1bmN0aW9uKCkKCQkJCQlsb2NhbCBTY3JpcHQgPSBDb2RlRWRpdG9yOkdldFRleHQoKQoJCQkJCWxvY2FsIEZ1bmMsIEVycm9yID0gbG9hZHN0cmluZyhTY3JpcHQsICJTaWdtYVNweS1VU0VSU0NSSVBUIikKCgkJCQkJLS0vLyBTeW50YXggY2hlY2sKCQkJCQlpZiBub3QgRnVuYyB0aGVuCgkJCQkJCXNlbGY6U2hvd01vZGFsKHsiRXJyb3IgcnVubmluZyBzY3JpcHQhXG4iLCBFcnJvcn0pCgkJCQkJCXJldHVybgoJCQkJCWVuZAoKCQkJCQlGdW5jKCkKCQkJCWVuZAoJCQl9LAoJCQl7CgkJCQlUZXh0ID0gIkdldCByZXR1cm4iLAoJCQkJQ2FsbGJhY2sgPSBNYWtlQWN0aXZlRGF0YUNhbGxiYWNrKCJHZXRSZXR1cm4iKQoJCQl9LAoJCQl7CgkJCQlUZXh0ID0gIlNjcmlwdCIsCgkJCQlDYWxsYmFjayA9IE1ha2VBY3RpdmVEYXRhQ2FsbGJhY2soIlNjcmlwdE9wdGlvbnMiKQoJCQl9LAoJCQl7CgkJCQlUZXh0ID0gIkJ1aWxkIiwKCQkJCUNhbGxiYWNrID0gTWFrZUFjdGl2ZURhdGFDYWxsYmFjaygiQnVpbGRTY3JpcHQiKQoJCQl9LAoJCQl7CgkJCQlUZXh0ID0gIlBvcC1vdXQiLAoJCQkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCQkJbG9jYWwgU2NyaXB0ID0gQ29kZUVkaXRvcjpHZXRUZXh0KCkKCQkJCQlsb2NhbCBUaWxlID0gQWN0aXZlRGF0YSBhbmQgQWN0aXZlRGF0YS5UYXNrIG9yICJTaWdtYSBTcHkiCgkJCQkJc2VsZjpNYWtlRWRpdG9yUG9wb3V0V2luZG93KFNjcmlwdCwgewoJCQkJCQlUaXRsZSA9IFRpbGUKCQkJCQl9KQoJCQkJZW5kCgkJCX0sCgkJfQoJfSkKCQoJc2VsZi5Db2RlRWRpdG9yID0gQ29kZUVkaXRvcgplbmQKCmZ1bmN0aW9uIFVpOlNob3VsZEZvY3VzKFRhYik6IGJvb2xlYW4KCWxvY2FsIEluZm9TZWxlY3RvciA9IHNlbGYuSW5mb1NlbGVjdG9yCglsb2NhbCBBY3RpdmVUYWIgPSBJbmZvU2VsZWN0b3IuQWN0aXZlVGFiCgoJLS0vLyBJZiB0aGVyZSBpcyBhbiBlbXB0eSB0YWIKCWlmIG5vdCBBY3RpdmVUYWIgdGhlbgoJCXJldHVybiB0cnVlCgllbmQKCglyZXR1cm4gSW5mb1NlbGVjdG9yOkNvbXBhcmVUYWJzKEFjdGl2ZVRhYiwgVGFiKQplbmQKCmZ1bmN0aW9uIFVpOk1ha2VFZGl0b3JQb3BvdXRXaW5kb3coQ29udGVudDogc3RyaW5nLCBXaW5kb3dDb25maWc6IHRhYmxlKQoJbG9jYWwgV2luZG93ID0gc2VsZjpDcmVhdGVXaW5kb3coV2luZG93Q29uZmlnKQoJbG9jYWwgQnV0dG9ucyA9IFdpbmRvd0NvbmZpZy5CdXR0b25zIG9yIHt9Cglsb2NhbCBDb2xvcnMgPSBDb25maWcuU3ludGF4Q29sb3JzCgoJbG9jYWwgQ29kZUVkaXRvciA9IFdpbmRvdzpDb2RlRWRpdG9yKHsKCQlUZXh0ID0gQ29udGVudCwKCQlFZGl0YWJsZSA9IHRydWUsCgkJRmlsbCA9IHRydWUsCgkJRm9udFNpemUgPSAxMywKCQlDb2xvcnMgPSBDb2xvcnMsCgkJRm9udEZhY2UgPSBUZXh0Rm9udAoJfSkKCgktLS8vIERlZmF1bHQgYnV0dG9ucwoJdGFibGUuaW5zZXJ0KEJ1dHRvbnMsIHsKCQlUZXh0ID0gIkNvcHkiLAoJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQlsb2NhbCBTY3JpcHQgPSBDb2RlRWRpdG9yOkdldFRleHQoKQoJCQlzZWxmOlNldENsaXBib2FyZChTY3JpcHQpCgkJZW5kCgl9KQoKCS0tLy8gQnV0dG9ucwoJbG9jYWwgQnV0dG9uc1JvdyA9IFdpbmRvdzpSb3coKQoJc2VsZjpDcmVhdGVCdXR0b25zKEJ1dHRvbnNSb3csIHsKCQlOb1RhYmxlID0gdHJ1ZSwKCQlCdXR0b25zID0gQnV0dG9ucwoJfSkKCglXaW5kb3c6Q2VudGVyKCkKCXJldHVybiBDb2RlRWRpdG9yLCBXaW5kb3cKZW5kCgpmdW5jdGlvbiBVaTpFZGl0RmlsZShGaWxlUGF0aDogc3RyaW5nLCBJbkZvbGRlcjogYm9vbGVhbiwgT25TYXZlRnVuYzogKCh0YWJsZSwgc3RyaW5nKSAtPiBuaWwpPykKCWxvY2FsIEZvbGRlciA9IEZpbGVzLkZvbGRlck5hbWUKCWxvY2FsIENvZGVFZGl0b3IsIFdpbmRvdwoKCS0tLy8gUmVsYXRpdmUgdG8gU2lnbWEgU3B5IGZvbGRlcgoJaWYgSW5Gb2xkZXIgdGhlbgoJCUZpbGVQYXRoID0gYHtGb2xkZXJ9L3tGaWxlUGF0aH1gCgllbmQKCgktLS8vIEdldCBmaWxlIGNvbnRlbnQKCWxvY2FsIENvbnRlbnQgPSByZWFkZmlsZShGaWxlUGF0aCkKCUNvbnRlbnQgPSBDb250ZW50OmdzdWIoIlxyXG4iLCAiXG4iKQoJCglsb2NhbCBCdXR0b25zID0gewoJCXsKCQkJVGV4dCA9ICJTYXZlIiwKCQkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCQlsb2NhbCBTY3JpcHQgPSBDb2RlRWRpdG9yOkdldFRleHQoKQoJCQkJbG9jYWwgU3VjY2VzcywgRXJyb3IgPSBsb2Fkc3RyaW5nKFNjcmlwdCwgIlNpZ21hU3B5LUVkaXRvciIpCgoJCQkJLS0vLyBTeW50YXggY2hlY2sKCQkJCWlmIG5vdCBTdWNjZXNzIHRoZW4KCQkJCQlzZWxmOlNob3dNb2RhbCh7IkVycm9yIHNhdmluZyBmaWxlIVxuIiwgRXJyb3J9KQoJCQkJCXJldHVybgoJCQkJZW5kCgkJCQkKCQkJCS0tLy8gU2F2ZSBjb250ZW50cwoJCQkJd3JpdGVmaWxlKEZpbGVQYXRoLCBTY3JpcHQpCgoJCQkJLS0vLyBJbnZva2Ugb24gc2F2ZSBmdW5jdGlvbgoJCQkJaWYgT25TYXZlRnVuYyB0aGVuCgkJCQkJT25TYXZlRnVuYyhXaW5kb3csIFNjcmlwdCkKCQkJCWVuZAoJCQllbmQKCQl9Cgl9CgoJLS0vLyBDcmVhdGUgRWRpdG9yIFdpbmRvdwoJQ29kZUVkaXRvciwgV2luZG93ID0gc2VsZjpNYWtlRWRpdG9yUG9wb3V0V2luZG93KENvbnRlbnQsIHsKCQlUaXRsZSA9IGBFZGl0aW5nOiB7RmlsZVBhdGh9YCwKCQlCdXR0b25zID0gQnV0dG9ucwoJfSkKZW5kCgp0eXBlIE1lbnVPcHRpb25zID0gewoJW3N0cmluZ106IChHdWlCdXR0b24sIC4uLmFueSkgLT4gbmlsCn0KZnVuY3Rpb24gVWk6TWFrZUJ1dHRvbk1lbnUoQnV0dG9uOiBJbnN0YW5jZSwgVW5wYWNrOiB0YWJsZSwgT3B0aW9uczogTWVudU9wdGlvbnMpCglsb2NhbCBXaW5kb3cgPSBzZWxmLldpbmRvdwoJbG9jYWwgUG9wdXAgPSBXaW5kb3c6UG9wdXBDYW52YXMoewoJCVJlbGF0aXZlVG8gPSBCdXR0b24sCgkJTWF4U2l6ZVggPSA1MDAsCgl9KQoKCS0tLy8gQ3JlYXRlIFNlbGVjdGFibGVzIGZvciBzdHJpbmcsIGZ1bmN0aW9uCglmb3IgTmFtZSwgRnVuYyBpbiBPcHRpb25zIGRvCgkJIFBvcHVwOlNlbGVjdGFibGUoewoJCQlUZXh0ID0gTmFtZSwKCQkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCQlGdW5jKFByb2Nlc3M6VW5wYWNrKFVucGFjaykpCgkJCWVuZCwKCQl9KQoJZW5kCmVuZAoKZnVuY3Rpb24gVWk6UmVtb3ZlUHJldmlvdXNUYWIoVGl0bGU6IHN0cmluZyk6IGJvb2xlYW4KCS0tLy8gTm8gcHJldmlvdXMgdGFicwoJaWYgbm90IEFjdGl2ZURhdGEgdGhlbiAKCQlyZXR1cm4gZmFsc2UgCgllbmQKCgktLS8vIFRhYlNlbGVjdG9yCglsb2NhbCBJbmZvU2VsZWN0b3IgPSBzZWxmLkluZm9TZWxlY3RvcgoKCS0tLy8gUHJldmlvdXMgZWxlbWVudHMKCWxvY2FsIFByZXZpb3VzVGFiID0gQWN0aXZlRGF0YS5UYWIKCWxvY2FsIFByZXZpb3VzU2VsZWN0YWJsZSA9IEFjdGl2ZURhdGEuU2VsZWN0YWJsZQoKCS0tLy8gUmVtb3ZlIHByZXZpb3VzIHRhYiBhbmQgc2V0IHNlbGVjdGFibGUgZm9jdXMKCWxvY2FsIFRhYkZvY3VzZWQgPSBzZWxmOlNob3VsZEZvY3VzKFByZXZpb3VzVGFiKQoJSW5mb1NlbGVjdG9yOlJlbW92ZVRhYihQcmV2aW91c1RhYikKCVByZXZpb3VzU2VsZWN0YWJsZTpTZXRTZWxlY3RlZChmYWxzZSkKCgktLS8vIENyZWF0ZSBuZXcgdGFiCglyZXR1cm4gVGFiRm9jdXNlZAplbmQKCmZ1bmN0aW9uIFVpOk1ha2VUYWJsZUhlYWRlcnMoVGFibGUsIFJvd3M6IHRhYmxlKQoJbG9jYWwgSGVhZGVyUm93ID0gVGFibGU6SGVhZGVyUm93KCkKCWZvciBfLCBDYXRhZ29yeSBpbiBSb3dzIGRvCgkJbG9jYWwgQ29sdW1uID0gSGVhZGVyUm93Ok5leHRDb2x1bW4oKQoJCUNvbHVtbjpMYWJlbCh7VGV4dD1DYXRhZ29yeX0pCgllbmQKZW5kCgpmdW5jdGlvbiBVaTpEZWNvbXBpbGUoRWRpdG9yOiB0YWJsZSwgU2NyaXB0OiBTY3JpcHQpCglsb2NhbCBIZWFkZXIgPSAiLS1CT09JSUlJIFRISVMgSVMgU08gVFVGRiBGTElQUFkgU0tJQklESSBBVVJBIChTSUdNQSBTUFkpIgoJRWRpdG9yOlNldFRleHQoIi0tRGVjb21waWxpbmcuLi4gKzk5OTk5OTkgQVVSQSAobWFuZ28gcGhvbmspIikKCgktLS8vIERlY29tcGlsZSBzY3JpcHQKCWxvY2FsIERlY29tcGlsZWQsIElzRXJyb3IgPSBQcm9jZXNzOkRlY29tcGlsZShTY3JpcHQpCgoJLS0vLyBBZGQgaGVhZGVyIGZvciBzdWNjZXNzZnVsIGRlY29tcGlsYXRpb25zCglpZiBub3QgSXNFcnJvciB0aGVuCgkJRGVjb21waWxlZCA9IGB7SGVhZGVyfVxue0RlY29tcGlsZWR9YAoJZW5kCgoJRWRpdG9yOlNldFRleHQoRGVjb21waWxlZCkKZW5kCgp0eXBlIERpc3BsYXlUYWJsZUNvbmZpZyA9IHsKCVJvd3M6IHRhYmxlLAoJRmxhZ3M6IHRhYmxlPywKCVRvRGlzcGxheTogdGFibGUsCglUYWJsZTogdGFibGUKfQpmdW5jdGlvbiBVaTpEaXNwbGF5VGFibGUoUGFyZW50LCBDb25maWc6IERpc3BsYXlUYWJsZUNvbmZpZyk6IHRhYmxlCgktLS8vIENvbmZpZ3VyYXRpb24KCWxvY2FsIFJvd3MgPSBDb25maWcuUm93cwoJbG9jYWwgRmxhZ3MgPSBDb25maWcuRmxhZ3MKCWxvY2FsIERhdGFUYWJsZSA9IENvbmZpZy5UYWJsZQoJbG9jYWwgVG9EaXNwbGF5ID0gQ29uZmlnLlRvRGlzcGxheQoKCUZsYWdzLk1heENvbHVtbnMgPSAjUm93cwoKCS0tLy8gQ3JlYXRlIHRhYmxlCglsb2NhbCBUYWJsZSA9IFBhcmVudDpUYWJsZShGbGFncykKCgktLS8vIFRhYmxlIGhlYWRlcnMKCXNlbGY6TWFrZVRhYmxlSGVhZGVycyhUYWJsZSwgUm93cykKCgktLS8vIFRhYmxlIGxheW91dAoJZm9yIFJvd0luZGV4LCBOYW1lIGluIFRvRGlzcGxheSBkbwoJCWxvY2FsIFJvdyA9IFRhYmxlOlJvdygpCgkJCgkJLS0vLyBDcmVhdGUgQ29sdW1ucwoJCWZvciBDb3VudCwgQ2F0YWdvcnkgaW4gUm93cyBkbwoJCQlsb2NhbCBDb2x1bW4gPSBSb3c6TmV4dENvbHVtbigpCgkJCQoJCQktLS8vIFZhbHVlIHRleHQKCQkJbG9jYWwgVmFsdWUgPSBDYXRhZ29yeSA9PSAiTmFtZSIgYW5kIE5hbWUgb3IgRGF0YVRhYmxlW05hbWVdCgkJCWlmIG5vdCBWYWx1ZSB0aGVuIGNvbnRpbnVlIGVuZAoKCQkJLS0vLyBDcmVhdGUgZmlsdGVyZWQgbGFiZWwKCQkJbG9jYWwgU3RyaW5nID0gc2VsZjpGaWx0ZXJOYW1lKGB7VmFsdWV9YCwgMTUwKQoJCQlDb2x1bW46TGFiZWwoe1RleHQ9U3RyaW5nfSkKCQllbmQKCWVuZAoKCXJldHVybiBUYWJsZQplbmQKCmZ1bmN0aW9uIFVpOlNldEZvY3VzZWRSZW1vdGUoRGF0YSkKCS0tLy8gVW5wYWNrIHJlbW90ZSBkYXRhCglsb2NhbCBSZW1vdGUgPSBEYXRhLlJlbW90ZQoJbG9jYWwgTWV0aG9kID0gRGF0YS5NZXRob2QKCWxvY2FsIElzUmVjZWl2ZSA9IERhdGEuSXNSZWNlaXZlCglsb2NhbCBTY3JpcHQgPSBEYXRhLkNhbGxpbmdTY3JpcHQKCWxvY2FsIENsYXNzRGF0YSA9IERhdGEuQ2xhc3NEYXRhCglsb2NhbCBIZWFkZXJEYXRhID0gRGF0YS5IZWFkZXJEYXRhCglsb2NhbCBWYWx1ZVN3YXBzID0gRGF0YS5WYWx1ZVN3YXBzCglsb2NhbCBBcmdzID0gRGF0YS5BcmdzCglsb2NhbCBJZCA9IERhdGEuSWQKCgktLS8vIEZsYWdzCglsb2NhbCBUYWJsZUFyZ3MgPSBGbGFnczpHZXRGbGFnVmFsdWUoIlRhYmxlQXJncyIpCglsb2NhbCBOb1ZhcmlhYmxlcyA9IEZsYWdzOkdldEZsYWdWYWx1ZSgiTm9WYXJpYWJsZXMiKQoKCS0tLy8gVW5wYWNrIGluZm8KCWxvY2FsIFJlbW90ZURhdGEgPSBQcm9jZXNzOkdldFJlbW90ZURhdGEoSWQpCglsb2NhbCBJc1JlbW90ZUZ1bmN0aW9uID0gQ2xhc3NEYXRhLklzUmVtb3RlRnVuY3Rpb24KCWxvY2FsIFJlbW90ZU5hbWUgPSBzZWxmOkZpbHRlck5hbWUoYHtSZW1vdGV9YCwgNTApCgoJLS0vLyBVSSBkYXRhCglsb2NhbCBDb2RlRWRpdG9yID0gc2VsZi5Db2RlRWRpdG9yCglsb2NhbCBUb0Rpc3BsYXkgPSBzZWxmLkRpc3BsYXlSZW1vdGVJbmZvCglsb2NhbCBJbmZvU2VsZWN0b3IgPSBzZWxmLkluZm9TZWxlY3RvcgoKCWxvY2FsIFRhYkZvY3VzZWQgPSBzZWxmOlJlbW92ZVByZXZpb3VzVGFiKCkKCWxvY2FsIFRhYiA9IEluZm9TZWxlY3RvcjpDcmVhdGVUYWIoewoJCU5hbWUgPSBzZWxmOkZpbHRlck5hbWUoYFJlbW90ZToge1JlbW90ZU5hbWV9YCwgNTApLAoJCUZvY3VzZWQgPSBUYWJGb2N1c2VkCgl9KQoKCS0tLy8gQ3JlYXRlIG5ldyBwYXJzZXIKCWxvY2FsIE1vZHVsZSA9IEdlbmVyYXRpb246TmV3UGFyc2VyKHsKCQlOb1ZhcmlhYmxlcyA9IE5vVmFyaWFibGVzCgl9KQoJbG9jYWwgUGFyc2VyID0gTW9kdWxlLlBhcnNlcgoJbG9jYWwgRm9ybWF0dGVyID0gTW9kdWxlLkZvcm1hdHRlcgoJRm9ybWF0dGVyOlNldFZhbHVlU3dhcHMoVmFsdWVTd2FwcykKCgktLS8vIFNldCB0aGlzIGxvZyB0byBiZSBzZWxlY3RlZAoJQWN0aXZlRGF0YSA9IERhdGEKCURhdGEuVGFiID0gVGFiCglEYXRhLlNlbGVjdGFibGU6U2V0U2VsZWN0ZWQodHJ1ZSkKCglsb2NhbCBmdW5jdGlvbiBTZXRJREVUZXh0KENvbnRlbnQ6IHN0cmluZywgVGFzazogc3RyaW5nPykKCQlEYXRhLlRhc2sgPSBUYXNrIG9yICJTaWdtYSBTcHkiCgkJQ29kZUVkaXRvcjpTZXRUZXh0KENvbnRlbnQpCgllbmQKCWxvY2FsIGZ1bmN0aW9uIERhdGFDb25uZWN0aW9uKE5hbWUsIC4uLikKCQlsb2NhbCBBcmdzID0gey4uLn0KCQlyZXR1cm4gZnVuY3Rpb24oKQoJCQlyZXR1cm4gRGF0YVtOYW1lXShEYXRhLCBQcm9jZXNzOlVucGFjayhBcmdzKSkKCQllbmQKCWVuZAoJbG9jYWwgZnVuY3Rpb24gU2NyaXB0Q2hlY2soU2NyaXB0LCBOb01pc3NpbmdDaGVjazogYm9vbGVhbik6IGJvb2xlYW4/CgkJLS0vLyBSZWplY3QgY2xpZW50IGV2ZW50cwoJCWlmIElzUmVjZWl2ZSB0aGVuIAoJCQlVaTpTaG93TW9kYWwoewoJCQkJIlJlY2lldmVzIGRvIG5vdCBoYXZlIGEgc2NyaXB0IGJlY2F1c2UgaXQncyBhIENvbm5lY3Rpb24iCgkJCX0pCgkJCXJldHVybiAKCQllbmQKCgkJLS0vLyBDaGVjayBpZiBzY3JpcHQgZXhpc3RzCgkJaWYgbm90IFNjcmlwdCBhbmQgbm90IE5vTWlzc2luZ0NoZWNrIHRoZW4gCgkJCVVpOlNob3dNb2RhbCh7IlRoZSBTY3JpcHQgaGFzIGJlZW4gZGVzdHJveWVkIGJ5IHRoZSBnYW1lICgtOTk5OTk5OSBBVVJBKSJ9KQoJCQlyZXR1cm4KCQllbmQKCgkJcmV0dXJuIHRydWUKCWVuZAoKCS0tLy8gRnVuY3Rpb25zCglmdW5jdGlvbiBEYXRhOlNjcmlwdE9wdGlvbnMoQnV0dG9uOiBHdWlCdXR0b24pCgkJVWk6TWFrZUJ1dHRvbk1lbnUoQnV0dG9uLCB7c2VsZn0sIHsKCQkJWyJDYWxsZXIgSW5mbyJdID0gRGF0YUNvbm5lY3Rpb24oIkdlbmVyYXRlSW5mbyIpLAoJCQlbIkRlY29tcGlsZSJdID0gRGF0YUNvbm5lY3Rpb24oIkRlY29tcGlsZSIsICJTb3VyY2VTY3JpcHQiKSwKCQkJWyJEZWNvbXBpbGUgQ2FsbGluZyJdID0gRGF0YUNvbm5lY3Rpb24oIkRlY29tcGlsZSIsICJDYWxsaW5nU2NyaXB0IiksCgkJCVsiUmVwZWF0IENhbGwiXSA9IERhdGFDb25uZWN0aW9uKCJSZXBlYXRDYWxsIiksCgkJCVsiU2F2ZSBCeXRlY29kZSJdID0gRGF0YUNvbm5lY3Rpb24oIlNhdmVCeXRlY29kZSIpLAoJCX0pCgllbmQKCWZ1bmN0aW9uIERhdGE6QnVpbGRTY3JpcHQoQnV0dG9uOiBHdWlCdXR0b24pCgkJVWk6TWFrZUJ1dHRvbk1lbnUoQnV0dG9uLCB7c2VsZn0sIHsKCQkJWyJTYXZlIl0gPSBEYXRhQ29ubmVjdGlvbigiU2F2ZVNjcmlwdCIpLAoJCQlbIkNhbGwgUmVtb3RlIl0gPSBEYXRhQ29ubmVjdGlvbigiTWFrZVNjcmlwdCIsICJSZW1vdGUiKSwKCQkJWyJCbG9jayBSZW1vdGUiXSA9IERhdGFDb25uZWN0aW9uKCJNYWtlU2NyaXB0IiwgIkJsb2NrIiksCgkJCVsiUmVwZWF0IEZvciJdID0gRGF0YUNvbm5lY3Rpb24oIk1ha2VTY3JpcHQiLCAiUmVwZWF0IiksCgkJCVsiU3BhbSBSZW1vdGUiXSA9IERhdGFDb25uZWN0aW9uKCJNYWtlU2NyaXB0IiwgIlNwYW0iKQoJCX0pCgllbmQKCWZ1bmN0aW9uIERhdGE6U2F2ZVNjcmlwdCgpCgkJbG9jYWwgRmlsZVBhdGggPSBHZW5lcmF0aW9uOlRpbWVTdGFtcEZpbGUoc2VsZi5UYXNrKQoJCXdyaXRlZmlsZShGaWxlUGF0aCwgQ29kZUVkaXRvcjpHZXRUZXh0KCkpCgoJCVVpOlNob3dNb2RhbCh7IlNhdmVkIHNjcmlwdCB0byIsIEZpbGVQYXRofSkKCWVuZAoJZnVuY3Rpb24gRGF0YTpTYXZlQnl0ZWNvZGUoKQoJCS0tLy8gUHJvYmxlbSBjaGVjawoJCWlmIG5vdCBTY3JpcHRDaGVjayhTY3JpcHQsIHRydWUpIHRoZW4gcmV0dXJuIGVuZAoKCQktLS8vIGdldHNjcmlwdGJ5dGVjb2RlCiAgICAJbG9jYWwgU3VjY2VzcywgQnl0ZWNvZGUgPSBwY2FsbChnZXRzY3JpcHRieXRlY29kZSwgU2NyaXB0KQoJCWlmIG5vdCBTdWNjZXNzIHRoZW4KCQkJVWk6U2hvd01vZGFsKHsiRmFpbGVkIHRvIGdldCBTY3JpcHRlIGJ5dGVjb2RlICgtOTk5OTk5OSBBVVJBKSJ9KQoJCQlyZXR1cm4KCQllbmQKCgkJLS0vLyBTYXZlIGZpbGUKCQlsb2NhbCBQYXRoQmFzZSA9IGB7U2NyaXB0fSAlcy50eHRgCgkJbG9jYWwgRmlsZVBhdGggPSBHZW5lcmF0aW9uOlRpbWVTdGFtcEZpbGUoUGF0aEJhc2UpCgkJd3JpdGVmaWxlKEZpbGVQYXRoLCBCeXRlY29kZSkKCgkJVWk6U2hvd01vZGFsKHsiU2F2ZWQgYnl0ZWNvZGUgdG8iLCBGaWxlUGF0aH0pCgllbmQKCWZ1bmN0aW9uIERhdGE6TWFrZVNjcmlwdChTY3JpcHRUeXBlOiBzdHJpbmcpCgkJbG9jYWwgU2NyaXB0ID0gR2VuZXJhdGlvbjpSZW1vdGVTY3JpcHQoTW9kdWxlLCBzZWxmLCBTY3JpcHRUeXBlKQoJCVNldElERVRleHQoU2NyaXB0LCBgRWRpdGluZzoge1JlbW90ZU5hbWV9Lmx1YWApCgllbmQKCWZ1bmN0aW9uIERhdGE6UmVwZWF0Q2FsbCgpCgkJbG9jYWwgU2lnbmFsID0gSG9vazpJbmRleChSZW1vdGUsIE1ldGhvZCkKCgkJaWYgSXNSZWNlaXZlIHRoZW4KCQkJZmlyZXNpZ25hbChTaWduYWwsIFByb2Nlc3M6VW5wYWNrKEFyZ3MpKQoJCWVsc2UKCQkJU2lnbmFsKFJlbW90ZSwgUHJvY2VzczpVbnBhY2soQXJncykpCgkJZW5kCgllbmQKCWZ1bmN0aW9uIERhdGE6R2V0UmV0dXJuKCkKCQlsb2NhbCBSZXR1cm5WYWx1ZXMgPSBzZWxmLlJldHVyblZhbHVlcwoKCQktLS8vIEVycm9yIG1lc3NhZ2VzCgkJaWYgbm90IElzUmVtb3RlRnVuY3Rpb24gdGhlbgoJCQlVaTpTaG93TW9kYWwoeyJUaGUgUmVtb3RlIGlzIG5vdCBhIFJlbW90ZSBGdW5jdGlvbiAoLTk5OTk5OTkgQVVSQSkifSkKCQkJcmV0dXJuCgkJZW5kCgkJaWYgbm90IFJldHVyblZhbHVlcyB0aGVuCgkJCVVpOlNob3dNb2RhbCh7Ik5vIHJldHVybiB2YWx1ZXMgKC05OTk5OTk5IEFVUkEpIn0pCgkJCXJldHVybgoJCWVuZAoKCQktLS8vIEdlbmVyYXRlIHNjcmlwdAoJCWxvY2FsIFNjcmlwdCA9IEdlbmVyYXRpb246VGFibGVTY3JpcHQoTW9kdWxlLCBSZXR1cm5WYWx1ZXMpCgkJU2V0SURFVGV4dChTY3JpcHQsIGBSZXR1cm4gVmFsdWVzIGZvcjoge1JlbW90ZU5hbWV9YCkKCWVuZAoJZnVuY3Rpb24gRGF0YTpHZW5lcmF0ZUluZm8oKQoJCS0tLy8gUHJvYmxlbSBjaGVjawoJCWlmIG5vdCBTY3JpcHRDaGVjayhuaWwsIHRydWUpIHRoZW4gcmV0dXJuIGVuZAoKCQktLS8vIEdlbmVyYXRlIHNjcmlwdAoJCWxvY2FsIFNjcmlwdCA9IEdlbmVyYXRpb246QWR2YW5jZWRJbmZvKE1vZHVsZSwgc2VsZikKCQlTZXRJREVUZXh0KFNjcmlwdCwgYEFkdmFuY2VkIEluZm8gZm9yOiB7UmVtb3RlTmFtZX1gKQoJZW5kCglmdW5jdGlvbiBEYXRhOkRlY29tcGlsZShXaGljaFNjcmlwdDogc3RyaW5nKQoJCWxvY2FsIERlY29tcGlsZVBvcG91dCA9IEZsYWdzOkdldEZsYWdWYWx1ZSgiRGVjb21waWxlUG9wb3V0IikKCQlsb2NhbCBUb0RlY29tcGlsZSA9IERhdGFbV2hpY2hTY3JpcHRdCgkJbG9jYWwgRWRpdG9yID0gQ29kZUVkaXRvcgoKCQktLS8vIFByb2JsZW0gY2hlY2sKCQlpZiBub3QgU2NyaXB0Q2hlY2soVG9EZWNvbXBpbGUsIHRydWUpIHRoZW4gcmV0dXJuIGVuZAoJCWxvY2FsIFRhc2sgPSBVaTpGaWx0ZXJOYW1lKGBWaWV3aW5nOiB7VG9EZWNvbXBpbGV9Lmx1YWAsIDIwMCkKCQkKCQktLS8vIEF1dG9tYXRpY2FsbHkgUG9wLW91dCB0aGUgZWRpdG9yIGZvciBkZWNvbXBpbGluZyBpZiBlbmFibGVkCgkJaWYgRGVjb21waWxlUG9wb3V0IHRoZW4KCQkJRWRpdG9yID0gVWk6TWFrZUVkaXRvclBvcG91dFdpbmRvdygiIiwgewoJCQkJVGl0bGUgPSBUYXNrCgkJCX0pCgkJZW5kCgoJCVVpOkRlY29tcGlsZShFZGl0b3IsIFRvRGVjb21waWxlKQoJZW5kCgkKCS0tLy8gUmVtb3RlT3B0aW9ucwoJc2VsZjpDcmVhdGVPcHRpb25zRm9yRGljdChUYWIsIFJlbW90ZURhdGEsIGZ1bmN0aW9uKCkKCQlQcm9jZXNzOlVwZGF0ZVJlbW90ZURhdGEoSWQsIFJlbW90ZURhdGEpCgllbmQpCgoJLS0vLyBJbnN0YW5jZSBvcHRpb25zCglzZWxmOkNyZWF0ZUJ1dHRvbnMoVGFiLCB7CgkJQmFzZSA9IHsKCQkJU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAwLCAyMCksCgkJCUF1dG9tYXRpY1NpemUgPSBFbnVtLkF1dG9tYXRpY1NpemUuWSwKCQl9LAoJCUJ1dHRvbnMgPSB7CgkJCXsKCQkJCVRleHQgPSAiQ29weSBzY3JpcHQgcGF0aCIsCgkJCQlDYWxsYmFjayA9IGZ1bmN0aW9uKCkKCQkJCQlTZXRDbGlwYm9hcmQoUGFyc2VyOk1ha2VQYXRoU3RyaW5nKHsKCQkJCQkJT2JqZWN0ID0gU2NyaXB0LAoJCQkJCQlOb1ZhcmlhYmxlcyA9IHRydWUKCQkJCQl9KSkKCQkJCWVuZCwKCQkJfSwKCQkJewoJCQkJVGV4dCA9ICJDb3B5IHJlbW90ZSBwYXRoIiwKCQkJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQkJCVNldENsaXBib2FyZChQYXJzZXI6TWFrZVBhdGhTdHJpbmcoewoJCQkJCQlPYmplY3QgPSBSZW1vdGUsCgkJCQkJCU5vVmFyaWFibGVzID0gdHJ1ZQoJCQkJCX0pKQoJCQkJZW5kLAoJCQl9LAoJCQl7CgkJCQlUZXh0ID0gIlJlbW92ZSBsb2ciLAoJCQkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCQkJSW5mb1NlbGVjdG9yOlJlbW92ZVRhYihUYWIpCgkJCQkJRGF0YS5TZWxlY3RhYmxlOlJlbW92ZSgpCgkJCQkJSGVhZGVyRGF0YTpSZW1vdmUoKQoJCQkJCUFjdGl2ZURhdGEgPSBuaWwKCQkJCWVuZCwKCQkJfSwKCQkJewoJCQkJVGV4dCA9ICJEdW1wIGxvZ3MiLAoJCQkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCQkJbG9jYWwgTG9ncyA9IEhlYWRlckRhdGEuRW50cmllcwoJCQkJCWxvY2FsIEZpbGVQYXRoID0gR2VuZXJhdGlvbjpEdW1wTG9ncyhMb2dzKQoJCQkJCXNlbGY6U2hvd01vZGFsKHsiU2F2ZWQgZHVtcCB0byIsIEZpbGVQYXRofSkKCQkJCWVuZCwKCQkJfSwKCQkJewoJCQkJVGV4dCA9ICJWaWV3IENvbm5lY3Rpb25zIiwKCQkJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQkJCWxvY2FsIE1ldGhvZCA9IENsYXNzRGF0YS5SZWNlaXZlWzFdCgkJCQkJbG9jYWwgU2lnbmFsID0gUmVtb3RlW01ldGhvZF0KCQkJCQlzZWxmOlZpZXdDb25uZWN0aW9ucyhSZW1vdGVOYW1lLCBTaWduYWwpCgkJCQllbmQsCgkJCX0KCQl9Cgl9KQoKCS0tLy8gUmVtb3RlIGluZm9ybWF0aW9uIHRhYmxlCglzZWxmOkRpc3BsYXlUYWJsZShUYWIsIHsKCQlSb3dzID0geyJOYW1lIiwgIlZhbHVlIn0sCgkJVGFibGUgPSBEYXRhLAoJCVRvRGlzcGxheSA9IFRvRGlzcGxheSwKCQlGbGFncyA9IHsKCQkJQm9yZGVyID0gdHJ1ZSwKCQkJUm93QmFja2dyb3VuZCA9IHRydWUsCgkJCU1heENvbHVtbnMgPSAyCgkJfQoJfSkKCQoJLS0vLyBBcmd1bWVudHMgdGFibGUgc2NyaXB0CglpZiBUYWJsZUFyZ3MgdGhlbgoJCWxvY2FsIFBhcnNlZCA9IEdlbmVyYXRpb246VGFibGVTY3JpcHQoTW9kdWxlLCBBcmdzKQoJCVNldElERVRleHQoUGFyc2VkLCBgQXJndW1lbnRzIGZvciB7UmVtb3RlTmFtZX1gKQoJCXJldHVybgoJZW5kCgoJLS0vLyBSZW1vdGUgY2FsbCBzY3JpcHQKCURhdGE6TWFrZVNjcmlwdCgiUmVtb3RlIikKZW5kCgpmdW5jdGlvbiBVaTpWaWV3Q29ubmVjdGlvbnMoUmVtb3RlTmFtZTogc3RyaW5nLCBTaWduYWw6IFJCWFNjcmlwdENvbm5lY3Rpb24pCglsb2NhbCBXaW5kb3cgPSBzZWxmOkNyZWF0ZVdpbmRvdyh7CgkJVGl0bGUgPSBgQ29ubmVjdGlvbnMgZm9yOiB7UmVtb3RlTmFtZX1gLAoJCVNpemUgPSBVRGltMi5mcm9tT2Zmc2V0KDQ1MCwgMjUwKQoJfSkKCglsb2NhbCBUb0Rpc3BsYXkgPSB7CgkJIkVuYWJsZWQiLAoJCSJMdWFDb25uZWN0aW9uIiwKCQkiU2NyaXB0IgoJfQoKCS0tLy8gR2V0IEZpbHRlcmVkIGNvbm5lY3Rpb25zCglsb2NhbCBDb25uZWN0aW9ucyA9IFByb2Nlc3M6RmlsdGVyQ29ubmVjdGlvbnMoU2lnbmFsLCBUb0Rpc3BsYXkpCgoJLS0vLyBUYWJsZQoJbG9jYWwgVGFibGUgPSBXaW5kb3c6VGFibGUoewoJCUJvcmRlciA9IHRydWUsCgkJUm93QmFja2dyb3VuZCA9IHRydWUsCgkJTWF4Q29sdW1ucyA9IDMKCX0pCgoJbG9jYWwgQnV0dG9uc0ZvclZhbHVlcyA9IHsKCQlbIlNjcmlwdCJdID0gZnVuY3Rpb24oUm93LCBWYWx1ZSkKCQkJUm93OkJ1dHRvbih7CgkJCQlUZXh0ID0gIkRlY29tcGlsZSIsCgkJCQlDYWxsYmFjayA9IGZ1bmN0aW9uKCkKCQkJCQlsb2NhbCBUYXNrID0gc2VsZjpGaWx0ZXJOYW1lKGBWaWV3aW5nOiB7VmFsdWV9Lmx1YWAsIDIwMCkKCQkJCQlsb2NhbCBFZGl0b3IgPSBzZWxmOk1ha2VFZGl0b3JQb3BvdXRXaW5kb3cobmlsLCB7CgkJCQkJCVRpdGxlID0gVGFzawoJCQkJCX0pCgkJCQkJc2VsZjpEZWNvbXBpbGUoRWRpdG9yLCBWYWx1ZSkKCQkJCWVuZAoJCQl9KQoJCWVuZCwKCQlbIkVuYWJsZWQiXSA9IGZ1bmN0aW9uKFJvdywgRW5hYmxlZCwgQ29ubmVjdGlvbikKCQkJUm93OkJ1dHRvbih7CgkJCQlUZXh0ID0gRW5hYmxlZCBhbmQgIkRpc2FibGUiIG9yICJFbmFibGUiLAoJCQkJQ2FsbGJhY2sgPSBmdW5jdGlvbihzZWxmKQoJCQkJCUVuYWJsZWQgPSBub3QgRW5hYmxlZAoJCQkJCXNlbGYuVGV4dCA9IEVuYWJsZWQgYW5kICJEaXNhYmxlIiBvciAiRW5hYmxlIgoKCQkJCQktLS8vIEVuYWJsZSBvciBkaXNhYmxlIHRoZSBjb25uZWN0aW9uCgkJCQkJaWYgRW5hYmxlZCB0aGVuCgkJCQkJCUNvbm5lY3Rpb246RW5hYmxlKCkKCQkJCQllbHNlCgkJCQkJCUNvbm5lY3Rpb246RGlzYWJsZSgpCgkJCQkJZW5kCgkJCQllbmQKCQkJfSkKCQllbmQKCX0KCgktLS8vIE1ha2UgaGVhZGVycyBvbiB0aGUgdGFibGUKCXNlbGY6TWFrZVRhYmxlSGVhZGVycyhUYWJsZSwgVG9EaXNwbGF5KQoKCWZvciBfLCBDb25uZWN0aW9uIGluIENvbm5lY3Rpb25zIGRvCgkJbG9jYWwgUm93ID0gVGFibGU6Um93KCkKCgkJZm9yIF8sIFByb3BlcnR5IGluIFRvRGlzcGxheSBkbwoJCQlsb2NhbCBDb2x1bW4gPSBSb3c6TmV4dENvbHVtbigpCgkJCWxvY2FsIENvbHVtblJvdyA9IENvbHVtbjpSb3coKQoKCQkJbG9jYWwgVmFsdWUgPSBDb25uZWN0aW9uW1Byb3BlcnR5XQoJCQlsb2NhbCBDYWxsYmFjayA9IEJ1dHRvbnNGb3JWYWx1ZXNbUHJvcGVydHldCgoJCQktLS8vIFZhbHVlIGxhYmVsCgkJCUNvbHVtblJvdzpMYWJlbCh7VGV4dD1ge1ZhbHVlfWB9KQoKCQkJLS0vLyBBZGQgYnV0dG9ucwoJCQlpZiBDYWxsYmFjayB0aGVuCgkJCQlDYWxsYmFjayhDb2x1bW5Sb3csIFZhbHVlLCBDb25uZWN0aW9uKQoJCQllbmQKCQllbmQKCWVuZAoKCS0tLy8gQ2VudGVyIFdpbmRvdwoJV2luZG93OkNlbnRlcigpCmVuZAoKZnVuY3Rpb24gVWk6R2V0UmVtb3RlSGVhZGVyKERhdGE6IExvZykKCWxvY2FsIExvZ0xpbWl0ID0gc2VsZi5Mb2dMaW1pdAoJbG9jYWwgTG9ncyA9IHNlbGYuTG9ncwoJbG9jYWwgUmVtb3Rlc0xpc3QgPSBzZWxmLlJlbW90ZXNMaXN0CgoJLS0vLyBSZW1vdGUgaW5mbwoJbG9jYWwgSWQgPSBEYXRhLklkCglsb2NhbCBSZW1vdGUgPSBEYXRhLlJlbW90ZQoJbG9jYWwgUmVtb3RlTmFtZSA9IHNlbGY6RmlsdGVyTmFtZShge1JlbW90ZX1gLCAzMCkKCgktLS8vIE5vVHJlZU5vZGVzCglsb2NhbCBOb1RyZWVOb2RlcyA9IEZsYWdzOkdldEZsYWdWYWx1ZSgiTm9UcmVlTm9kZXMiKQoKCS0tLy8gQ2hlY2sgZm9yIGV4aXN0aW5nIFRyZWVOb2RlCglsb2NhbCBFeGlzdGluZyA9IExvZ3NbSWRdCglpZiBFeGlzdGluZyB0aGVuIHJldHVybiBFeGlzdGluZyBlbmQKCgktLS8vIEhlYWRlciBkYXRhCglsb2NhbCBIZWFkZXJEYXRhID0gewkKCQlMb2dDb3VudCA9IDAsCgkJRGF0YSA9IERhdGEsCgkJRW50cmllcyA9IHt9Cgl9CgoJLS0vLyBJbmNyZW1lbnQgdHJlZW5vZGUgY291bnQKCVJlbW90ZXNDb3VudCArPSAxCgoJLS0vLyBDcmVhdGUgbmV3IHRyZWVub2RlIGVsZW1lbnQKCWlmIG5vdCBOb1RyZWVOb2RlcyB0aGVuCgkJSGVhZGVyRGF0YS5UcmVlTm9kZSA9IFJlbW90ZXNMaXN0OlRyZWVOb2RlKHsKCQkJTGF5b3V0T3JkZXIgPSAtMSAqIFJlbW90ZXNDb3VudCwKCQkJVGl0bGUgPSBSZW1vdGVOYW1lCgkJfSkKCWVuZAoKCWZ1bmN0aW9uIEhlYWRlckRhdGE6Q2hlY2tMaW1pdCgpCgkJbG9jYWwgRW50cmllcyA9IHNlbGYuRW50cmllcwoJCWlmICNFbnRyaWVzIDwgTG9nTGltaXQgdGhlbiByZXR1cm4gZW5kCgkJCQoJCS0tLy8gR2V0IGFuZCByZW1vdmUgbGFzdCBlbGVtZW50CgkJbG9jYWwgTG9nID0gdGFibGUucmVtb3ZlKEVudHJpZXMsIDEpCgkJTG9nLlNlbGVjdGFibGU6UmVtb3ZlKCkKCWVuZAoKCWZ1bmN0aW9uIEhlYWRlckRhdGE6TG9nQWRkZWQoRGF0YSkKCQktLS8vIEluY3JlbWVudCBsb2cgY291bnQKCQlzZWxmLkxvZ0NvdW50ICs9IDEKCQlzZWxmOkNoZWNrTGltaXQoKQoKCQktLS8vIEFkZCBlbnRyeQoJCWxvY2FsIEVudHJpZXMgPSBzZWxmLkVudHJpZXMKCQl0YWJsZS5pbnNlcnQoRW50cmllcywgRGF0YSkKCQkKCQlyZXR1cm4gc2VsZgoJZW5kCgoJZnVuY3Rpb24gSGVhZGVyRGF0YTpSZW1vdmUoKQoJCS0tLy8gUmVtb3ZlIFRyZWVOb2RlCgkJbG9jYWwgVHJlZU5vZGUgPSBzZWxmLlRyZWVOb2RlCgkJaWYgVHJlZU5vZGUgdGhlbgoJCQlUcmVlTm9kZTpSZW1vdmUoKQoJCWVuZAoKCQktLS8vIENsZWFyIHRhYmxlcyBmcm9tIG1lbW9yeQoJCUxvZ3NbSWRdID0gbmlsCgkJdGFibGUuY2xlYXIoSGVhZGVyRGF0YSkKCWVuZAoKCUxvZ3NbSWRdID0gSGVhZGVyRGF0YQoJcmV0dXJuIEhlYWRlckRhdGEKZW5kCgpmdW5jdGlvbiBVaTpDbGVhckxvZ3MoKQoJbG9jYWwgTG9ncyA9IHNlbGYuTG9ncwoJbG9jYWwgUmVtb3Rlc0xpc3QgPSBzZWxmLlJlbW90ZXNMaXN0CgoJLS0vLyBDbGVhciBhbGwgZWxlbWVudHMKCVJlbW90ZXNDb3VudCA9IDAKCVJlbW90ZXNMaXN0OkNsZWFyQ2hpbGRFbGVtZW50cygpCgoJLS0vLyBDbGVhciBsb2dzIGZyb20gbWVtb3J5Cgl0YWJsZS5jbGVhcihMb2dzKQplbmQKCmZ1bmN0aW9uIFVpOlF1ZXVlTG9nKERhdGEpCglsb2NhbCBMb2dRdWV1ZSA9IHNlbGYuTG9nUXVldWUKCVByb2Nlc3M6TWVyZ2UoRGF0YSwgewoJCUFyZ3MgPSBQcm9jZXNzOkRlZXBDbG9uZVRhYmxlKERhdGEuQXJncyksCgl9KQoKCWlmIERhdGEuUmV0dXJuVmFsdWVzIHRoZW4KICAgICAgICBEYXRhLlJldHVyblZhbHVlcyA9IFByb2Nlc3M6RGVlcENsb25lVGFibGUoRGF0YS5SZXR1cm5WYWx1ZXMpCiAgICBlbmQKCQogICAgdGFibGUuaW5zZXJ0KExvZ1F1ZXVlLCBEYXRhKQplbmQKCmZ1bmN0aW9uIFVpOlByb2Nlc3NMb2dRdWV1ZSgpCglsb2NhbCBRdWV1ZSA9IHNlbGYuTG9nUXVldWUKICAgIGlmICNRdWV1ZSA8PSAwIHRoZW4gcmV0dXJuIGVuZAoKCS0tLy8gQ3JlYXRlIGEgbG9nIGVsZW1lbnQgZm9yIGVhY2ggaW4gdGhlIFF1ZXVlCiAgICBmb3IgSW5kZXgsIERhdGEgaW4gbmV4dCwgUXVldWUgZG8KICAgICAgICBzZWxmOkNyZWF0ZUxvZyhEYXRhKQogICAgICAgIHRhYmxlLnJlbW92ZShRdWV1ZSwgSW5kZXgpCiAgICBlbmQKZW5kCgpmdW5jdGlvbiBVaTpCZWdpbkxvZ1NlcnZpY2UoKQoJY29yb3V0aW5lLndyYXAoZnVuY3Rpb24oKQoJCXdoaWxlIHRydWUgZG8KCQkJc2VsZjpQcm9jZXNzTG9nUXVldWUoKQoJCQl0YXNrLndhaXQoKQoJCWVuZAoJZW5kKSgpCmVuZAoKZnVuY3Rpb24gVWk6RmlsdGVyTmFtZShOYW1lOiBzdHJpbmcsIENoYXJhY3RlckxpbWl0OiBudW1iZXI/KTogc3RyaW5nCglsb2NhbCBUcmltbWVkID0gTmFtZTpzdWIoMSwgQ2hhcmFjdGVyTGltaXQgb3IgMjApCglsb2NhbCBGaWx0cmVkID0gVHJpbW1lZDpnc3ViKCJbXG5ccl0iLCAiIikKCUZpbHRyZWQgPSBHZW5lcmF0aW9uOk1ha2VQcmludGFibGUoRmlsdHJlZCkKCglyZXR1cm4gRmlsdHJlZAplbmQKCmZ1bmN0aW9uIFVpOkNyZWF0ZUxvZyhEYXRhOiBMb2cpCgktLS8vIFVucGFjayBsb2cgZGF0YQogICAgbG9jYWwgUmVtb3RlID0gRGF0YS5SZW1vdGUKCWxvY2FsIE1ldGhvZCA9IERhdGEuTWV0aG9kCiAgICBsb2NhbCBBcmdzID0gRGF0YS5BcmdzCiAgICBsb2NhbCBJc1JlY2VpdmUgPSBEYXRhLklzUmVjZWl2ZQoJbG9jYWwgSWQgPSBEYXRhLklkCglsb2NhbCBUaW1lc3RhbXAgPSBEYXRhLlRpbWVzdGFtcAoJbG9jYWwgSXNFeHBsb2l0ID0gRGF0YS5Jc0V4cGxvaXQKCQoJbG9jYWwgSXNOaWxQYXJlbnQgPSBIb29rOkluZGV4KFJlbW90ZSwgIlBhcmVudCIpID09IG5pbAoJbG9jYWwgUmVtb3RlRGF0YSA9IFByb2Nlc3M6R2V0UmVtb3RlRGF0YShJZCkKCgktLS8vIFBhdXNlZAoJbG9jYWwgUGF1c2VkID0gRmxhZ3M6R2V0RmxhZ1ZhbHVlKCJQYXVzZWQiKQoJaWYgUGF1c2VkIHRoZW4gcmV0dXJuIGVuZAoKCS0tLy8gQ2hlY2sgY2FsbGVyIChJZ25vcmUgZXhwbG9pdCBjYWxscykKCWxvY2FsIExvZ0V4cGxvaXQgPSBGbGFnczpHZXRGbGFnVmFsdWUoIkxvZ0V4cGxvaXQiKQoJaWYgbm90IExvZ0V4cGxvaXQgYW5kIElzRXhwbG9pdCB0aGVuIHJldHVybiBlbmQKCgktLS8vIElnbm9yZU5pbAoJbG9jYWwgSWdub3JlTmlsID0gRmxhZ3M6R2V0RmxhZ1ZhbHVlKCJJZ25vcmVOaWwiKQoJaWYgSWdub3JlTmlsIGFuZCBJc05pbFBhcmVudCB0aGVuIHJldHVybiBlbmQKCiAgICAtLS8vIExvZ1JlY2l2ZXMgY2hlY2sKCWxvY2FsIExvZ1JlY2l2ZXMgPSBGbGFnczpHZXRGbGFnVmFsdWUoIkxvZ1JlY2l2ZXMiKQoJaWYgbm90IExvZ1JlY2l2ZXMgYW5kIElzUmVjZWl2ZSB0aGVuIHJldHVybiBlbmQKCglsb2NhbCBTZWxlY3ROZXdlc3QgPSBGbGFnczpHZXRGbGFnVmFsdWUoIlNlbGVjdE5ld2VzdCIpCglsb2NhbCBOb1RyZWVOb2RlcyA9IEZsYWdzOkdldEZsYWdWYWx1ZSgiTm9UcmVlTm9kZXMiKQoKICAgIC0tLy8gRXhjbHVkZWQgY2hlY2sKICAgIGlmIFJlbW90ZURhdGEuRXhjbHVkZWQgdGhlbiByZXR1cm4gZW5kCgoJLS0vLyBEZXNlcmlhbGl6ZSBhcmd1bWVudHMKCUFyZ3MgPSBDb21tdW5pY2F0aW9uOkRlc2VyaWFsaXplVGFibGUoQXJncykKCgktLS8vIERlZXAgY2xvbmUgZGF0YQoJbG9jYWwgQ2xvbmVkQXJncyA9IFByb2Nlc3M6RGVlcENsb25lVGFibGUoQXJncykKCURhdGEuQXJncyA9IENsb25lZEFyZ3MKCURhdGEuVmFsdWVTd2FwcyA9IEdlbmVyYXRpb246TWFrZVZhbHVlU3dhcHNUYWJsZShUaW1lc3RhbXApCgoJLS0vLyBHZW5lcmF0ZSBsb2cgdGl0bGUKCWxvY2FsIENvbG9yID0gQ29uZmlnLk1ldGhvZENvbG9yc1tNZXRob2Q6bG93ZXIoKV0KCWxvY2FsIFRleHQgPSBOb1RyZWVOb2RlcyBhbmQgYHtSZW1vdGV9IHwge01ldGhvZH1gIG9yIE1ldGhvZAoKCS0tLy8gRmluZFN0cmluZ0Zvck5hbWUgY2hlY2sKCWxvY2FsIEZpbmRTdHJpbmcgPSBGbGFnczpHZXRGbGFnVmFsdWUoIkZpbmRTdHJpbmdGb3JOYW1lIikKCWlmIEZpbmRTdHJpbmcgdGhlbgoJCWZvciBfLCBBcmcgaW4gbmV4dCwgQ2xvbmVkQXJncyBkbwoJCQlpZiB0eXBlb2YoQXJnKSA9PSAic3RyaW5nIiB0aGVuCgkJCQlsb2NhbCBGaWx0cmVkID0gc2VsZjpGaWx0ZXJOYW1lKEFyZykKCQkJCVRleHQgPSBge0ZpbHRyZWR9IHwge1RleHR9YAoJCQkJYnJlYWsKCQkJZW5kCgkJZW5kCgllbmQKCgktLS8vIEZldGNoIEhlYWRlckRhdGEgYnkgdGhlIFJlbW90ZUlEIHVzZWQgZm9yIHN0YWNraW5nCglsb2NhbCBIZWFkZXIgPSBzZWxmOkdldFJlbW90ZUhlYWRlcihEYXRhKQoJbG9jYWwgUmVtb3Rlc0xpc3QgPSBzZWxmLlJlbW90ZXNMaXN0CgoJbG9jYWwgTG9nQ291bnQgPSBIZWFkZXIuTG9nQ291bnQKCWxvY2FsIFRyZWVOb2RlID0gSGVhZGVyLlRyZWVOb2RlIAoJbG9jYWwgUGFyZW50ID0gVHJlZU5vZGUgb3IgUmVtb3Rlc0xpc3QKCgktLS8vIEluY3JlYXNlIGxvZyBjb3VudCAtIFRyZWVOb2RlcyBhcmUgaW4gR2V0UmVtb3RlSGVhZGVyIGZ1bmN0aW9uCglpZiBOb1RyZWVOb2RlcyB0aGVuCgkJUmVtb3Rlc0NvdW50ICs9IDEKCQlMb2dDb3VudCA9IFJlbW90ZXNDb3VudAoJZW5kCgogICAgLS0vLyBDcmVhdGUgZm9jdXMgYnV0dG9uCglEYXRhLkhlYWRlckRhdGEgPSBIZWFkZXIKCURhdGEuU2VsZWN0YWJsZSA9IFBhcmVudDpTZWxlY3RhYmxlKHsKCQlUZXh0ID0gVGV4dCwKICAgICAgICBMYXlvdXRPcmRlciA9IC0xICogTG9nQ291bnQsCgkJVGV4dENvbG9yMyA9IENvbG9yLAoJCVRleHRYQWxpZ25tZW50ID0gRW51bS5UZXh0WEFsaWdubWVudC5MZWZ0LAoJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQlzZWxmOlNldEZvY3VzZWRSZW1vdGUoRGF0YSkKCQllbmQsCiAgICB9KQoKCUhlYWRlcjpMb2dBZGRlZChEYXRhKQoKCS0tLy8gQXV0byBzZWxlY3QgY2hlY2sKCWxvY2FsIEdyb3VwU2VsZWN0ZWQgPSBBY3RpdmVEYXRhIGFuZCBBY3RpdmVEYXRhLkhlYWRlckRhdGEgPT0gSGVhZGVyCglpZiBTZWxlY3ROZXdlc3QgYW5kIEdyb3VwU2VsZWN0ZWQgdGhlbgoJCXNlbGY6U2V0Rm9jdXNlZFJlbW90ZShEYXRhKQoJZW5kCmVuZAoKcmV0dXJuIFVp]]
},Generation={'base64',
[[dHlwZSB0YWJsZSA9IHsKCVthbnldOiBhbnkKfQoKdHlwZSBSZW1vdGVEYXRhID0gewoJUmVtb3RlOiBJbnN0YW5jZSwKCUlzUmVjZWl2ZTogYm9vbGVhbj8sCglNZXRhTWV0aG9kOiBzdHJpbmcsCglBcmdzOiB0YWJsZSwKCU1ldGhvZDogc3RyaW5nLAogICAgVHJhbnNmZXJUeXBlOiBzdHJpbmcsCglWYWx1ZVJlcGxhY2VtZW50czogdGFibGUsCglOb1ZhcmlhYmxlczogYm9vbGVhbj8KfQoKLS0vLyBNb2R1bGUKbG9jYWwgR2VuZXJhdGlvbiA9IHsKCUR1bXBCYXNlTmFtZSA9ICJTaWdtYVNweS1EdW1wICVzLmx1YSIsIC0tICItLSBHZW5lcmF0ZWQgd2l0aCBzaWdtYSBzcHkgQk9JSUlJSUlJSUkgKCs5OTk5OTk5IEFVUkEpXG4iCglIZWFkZXIgPSAiLS0gR2VuZXJhdGVkIHdpdGggU2lnbWEgU3B5IEdpdGh1YjogaHR0cHM6Ly9naXRodWIuY29tL2RlcHRoc28vU2lnbWEtU3B5XG4iLAoJU2NyaXB0VGVtcGxhdGVzID0gewoJCVsiUmVtb3RlIl0gPSB7CgkJCXsiJVJlbW90ZUNhbGwlIn0KCQl9LAoJCVsiU3BhbSJdID0gewoJCQl7IndoaWxlIHdhaXQoKSBkbyJ9LAoJCQl7IiVSZW1vdGVDYWxsJSIsIDJ9LAoJCQl7ImVuZCJ9CgkJfSwKCQlbIlJlcGVhdCJdID0gewoJCQl7ImZvciBJbmRleCA9IDEsIDEwIGRvIn0sCgkJCXsiJVJlbW90ZUNhbGwlIiwgMn0sCgkJCXsiZW5kIn0KCQl9LAoJCVsiQmxvY2siXSA9IHsKCQkJWyJfX2luZGV4Il0gPSB7CgkJCQl7ImxvY2FsIE9sZDsgT2xkID0gaG9va2Z1bmN0aW9uKCVTaWduYWwlLCBmdW5jdGlvbihzZWxmLCAuLi4pIn0sCgkJCQl7ImlmIHNlbGYgPT0gJVJlbW90ZSUgdGhlbiIsIDJ9LAoJCQkJeyJyZXR1cm4iLCAzfSwKCQkJCXsiZW5kIiwgMn0sCgkJCQl7InJldHVybiBPbGQoc2VsZiwgLi4uKSIsIDJ9LAoJCQkJeyJlbmQpIn0KCQkJfSwKCQkJWyJfX25hbWVjYWxsIl0gPSB7CgkJCQl7ImxvY2FsIE9sZDsgT2xkID0gaG9va21ldGFtZXRob2QoZ2FtZSwgXCJfX25hbWVjYWxsXCIsIGZ1bmN0aW9uKHNlbGYsIC4uLikifSwKCQkJCXsibG9jYWwgTWV0aG9kID0gZ2V0bmFtZWNhbGxtZXRob2QoKSIsIDJ9LAoJCQkJeyJpZiBzZWxmID09ICVSZW1vdGUlIGFuZCBNZXRob2QgPT0gXCIlTWV0aG9kJVwiIHRoZW4iLCAyfSwKCQkJCXsicmV0dXJuIiwgM30sCgkJCQl7ImVuZCIsIDJ9LAoJCQkJeyJyZXR1cm4gT2xkKHNlbGYsIC4uLikiLCAyfSwKCQkJCXsiZW5kKSJ9CgkJCX0sCgkJCVsiQ29ubmVjdCJdID0gewoJCQkJeyJmb3IgXywgQ29ubmVjdGlvbiBpbiBnZXRjb25uZWN0aW9ucyglU2lnbmFsJSkgZG8ifSwKCQkJCXsiQ29ubmVjdGlvbjpEaXNhYmxlKCkiLCAyfSwKCQkJCXsiZW5kIn0KCQkJfQoJCX0KCX0KfQoKLS0vLyBNb2R1bGVzCmxvY2FsIENvbmZpZwpsb2NhbCBIb29rCmxvY2FsIFBhcnNlck1vZHVsZQpsb2NhbCBGbGFncwpsb2NhbCBUaGlzU2NyaXB0ID0gc2NyaXB0Cgpsb2NhbCBmdW5jdGlvbiBNZXJnZShCYXNlOiB0YWJsZSwgTmV3OiB0YWJsZT8pCglpZiBub3QgTmV3IHRoZW4gcmV0dXJuIGVuZAoJZm9yIEtleSwgVmFsdWUgaW4gbmV4dCwgTmV3IGRvCgkJQmFzZVtLZXldID0gVmFsdWUKCWVuZAplbmQKCmZ1bmN0aW9uIEdlbmVyYXRpb246SW5pdChEYXRhOiB0YWJsZSkKICAgIGxvY2FsIE1vZHVsZXMgPSBEYXRhLk1vZHVsZXMKCWxvY2FsIENvbmZpZ3VyYXRpb24gPSBNb2R1bGVzLkNvbmZpZ3VyYXRpb24KCgktLS8vIE1vZHVsZXMKCUNvbmZpZyA9IE1vZHVsZXMuQ29uZmlnCglIb29rID0gTW9kdWxlcy5Ib29rCglGbGFncyA9IE1vZHVsZXMuRmxhZ3MKCQoJLS0vLyBJbXBvcnQgcGFyc2VyCglsb2NhbCBQYXJzZXJVcmwgPSBDb25maWd1cmF0aW9uLlBhcnNlclVybAoJc2VsZjpMb2FkUGFyc2VyKFBhcnNlclVybCkKZW5kCgpmdW5jdGlvbiBHZW5lcmF0aW9uOk1ha2VQcmludGFibGUoU3RyaW5nOiBzdHJpbmcpOiBzdHJpbmcKCWxvY2FsIEZvcm1hdHRlciA9IFBhcnNlck1vZHVsZS5Nb2R1bGVzLkZvcm1hdHRlcgoJcmV0dXJuIEZvcm1hdHRlcjpNYWtlUHJpbnRhYmxlKFN0cmluZykKZW5kCgpmdW5jdGlvbiBHZW5lcmF0aW9uOlRpbWVTdGFtcEZpbGUoRmlsZVBhdGg6IHN0cmluZyk6IHN0cmluZwoJbG9jYWwgVGltZVN0YW1wID0gb3MuZGF0ZSgiJVktJW0tJWRfJUgtJU0tJVMiKQoJbG9jYWwgRm9ybWF0dGVkID0gRmlsZVBhdGg6Zm9ybWF0KFRpbWVTdGFtcCkKCXJldHVybiBGb3JtYXR0ZWQKZW5kCgpmdW5jdGlvbiBHZW5lcmF0aW9uOldyaXRlRHVtcChDb250ZW50OiBzdHJpbmcpOiBzdHJpbmcKCWxvY2FsIER1bXBCYXNlTmFtZSA9IHNlbGYuRHVtcEJhc2VOYW1lCglsb2NhbCBGaWxlUGF0aCA9IHNlbGY6VGltZVN0YW1wRmlsZShEdW1wQmFzZU5hbWUpCgoJLS0vLyBXcml0ZSB0byBmaWxlCgl3cml0ZWZpbGUoRmlsZVBhdGgsIENvbnRlbnQpCgoJcmV0dXJuIEZpbGVQYXRoCmVuZAoKZnVuY3Rpb24gR2VuZXJhdGlvbjpMb2FkUGFyc2VyKE1vZHVsZVVybDogc3RyaW5nKQoJUGFyc2VyTW9kdWxlID0gbG9hZHN0cmluZyhnYW1lOkh0dHBHZXQoTW9kdWxlVXJsKSwgIlBhcnNlciIpKCkKZW5kCgpmdW5jdGlvbiBHZW5lcmF0aW9uOk1ha2VWYWx1ZVN3YXBzVGFibGUoKTogdGFibGUKCWxvY2FsIEZvcm1hdHRlciA9IFBhcnNlck1vZHVsZS5Nb2R1bGVzLkZvcm1hdHRlcgoJcmV0dXJuIEZvcm1hdHRlcjpNYWtlUmVwbGFjZW1lbnRzKCkKZW5kCgpmdW5jdGlvbiBHZW5lcmF0aW9uOlNldFN3YXBzQ2FsbGJhY2soQ2FsbGJhY2s6IChJbnRlcmZhY2U6IHRhYmxlKSAtPiAoKSkKCXNlbGYuU3dhcHNDYWxsYmFjayA9IENhbGxiYWNrCmVuZAoKZnVuY3Rpb24gR2VuZXJhdGlvbjpHZXRCYXNlKE1vZHVsZSk6IChzdHJpbmcsIGJvb2xlYW4pCglsb2NhbCBOb0NvbW1lbnRzID0gRmxhZ3M6R2V0RmxhZ1ZhbHVlKCJOb0NvbW1lbnRzIikKCWxvY2FsIEhlYWRlciA9IHNlbGYuSGVhZGVyCgoJbG9jYWwgQ29kZSA9IE5vQ29tbWVudHMgYW5kICIiIG9yIEhlYWRlcgoKCS0tLy8gR2VuZXJhdGUgdmFyaWFibGVzIGNvZGUKCWxvY2FsIFZhcmlhYmxlcyA9IE1vZHVsZS5QYXJzZXI6TWFrZVZhcmlhYmxlQ29kZSh7CgkJIlNlcnZpY2VzIiwgIlJlbW90ZSIsICJWYXJpYWJsZXMiCgl9LCBOb0NvbW1lbnRzKQoKCWxvY2FsIE5vVmFyaWFibGVzID0gVmFyaWFibGVzID09ICIiCglDb2RlIC4uPSBWYXJpYWJsZXMKCglyZXR1cm4gQ29kZSwgTm9WYXJpYWJsZXMKZW5kCgpmdW5jdGlvbiBHZW5lcmF0aW9uOkdldFN3YXBzKCkKCWxvY2FsIEZ1bmMgPSBzZWxmLlN3YXBzQ2FsbGJhY2sKCWxvY2FsIFN3YXBzID0ge30KCglsb2NhbCBJbnRlcmZhY2UgPSB7fQoJZnVuY3Rpb24gSW50ZXJmYWNlOkFkZFN3YXAoT2JqZWN0OiBJbnN0YW5jZSwgRGF0YTogdGFibGUpCgkJaWYgbm90IE9iamVjdCB0aGVuIHJldHVybiBlbmQKCQlTd2Fwc1tPYmplY3RdID0gRGF0YQoJZW5kCgoJLS0vLyBJbnZva2UgR2V0U3dhcHMgZnVuY3Rpb24KCUZ1bmMoSW50ZXJmYWNlKQoKCXJldHVybiBTd2FwcwplbmQKCmZ1bmN0aW9uIEdlbmVyYXRpb246UGlja1ZhcmlhYmxlTmFtZSgpOiBzdHJpbmcKCWxvY2FsIE5hbWVzID0gQ29uZmlnLlZhcmlhYmxlTmFtZXMKCXJldHVybiBOYW1lc1ttYXRoLnJhbmRvbSgxLCAjTmFtZXMpXQplbmQKCmZ1bmN0aW9uIEdlbmVyYXRpb246TmV3UGFyc2VyKEV4dHJhOiB0YWJsZT8pCglsb2NhbCBWYXJpYWJsZU5hbWUgPSBzZWxmOlBpY2tWYXJpYWJsZU5hbWUoKQoJbG9jYWwgU3dhcHMgPSBzZWxmOkdldFN3YXBzKCkKCglsb2NhbCBDb25maWd1cmF0aW9uID0gewoJCVZhcmlhYmxlQmFzZSA9IFZhcmlhYmxlTmFtZSwKCQlTd2FwcyA9IFN3YXBzLAoJCUluZGV4RnVuYyA9IGZ1bmN0aW9uKC4uLikKCQkJcmV0dXJuIEhvb2s6SW5kZXgoLi4uKQoJCWVuZCwKCX0KCgktLS8vIE1lcmdlIGV4dHJhIGNvbmZpZ3VyYXRpb24KCU1lcmdlKENvbmZpZ3VyYXRpb24sIEV4dHJhKQoKCS0tLy8gQ3JlYXRlIG5ldyBwYXJzZXIgaW5zdGFuY2UKCXJldHVybiBQYXJzZXJNb2R1bGU6TmV3KENvbmZpZ3VyYXRpb24pCmVuZAoKZnVuY3Rpb24gR2VuZXJhdGlvbjpJbmRlbnQoSW5kZW50U3RyaW5nOiBzdHJpbmcsIExpbmU6IHN0cmluZykKCXJldHVybiBge0luZGVudFN0cmluZ317TGluZX1gCmVuZAoKdHlwZSBDYWxsSW5mbyA9IHsKCUFyZ3VtZW50czogdGFibGUsCglJbmRlbnQ6IG51bWJlciwKCVJlbW90ZVZhcmlhYmxlOiBzdHJpbmcsCglNb2R1bGU6IHRhYmxlCn0KZnVuY3Rpb24gR2VuZXJhdGlvbjpDYWxsUmVtb3RlU2NyaXB0KERhdGEsIEluZm86IENhbGxJbmZvKTogc3RyaW5nCglsb2NhbCBJc1JlY2VpdmUgPSBEYXRhLklzUmVjZWl2ZQoJbG9jYWwgTWV0aG9kID0gRGF0YS5NZXRob2QKCWxvY2FsIEFyZ3MgPSBEYXRhLkFyZ3MKCglsb2NhbCBSZW1vdGVWYXJpYWJsZSA9IEluZm8uUmVtb3RlVmFyaWFibGUKCWxvY2FsIEluZGVudCA9IEluZm8uSW5kZW50IG9yIDAKCWxvY2FsIE1vZHVsZSA9IEluZm8uTW9kdWxlCgoJbG9jYWwgVmFyaWFibGVzID0gTW9kdWxlLlZhcmlhYmxlcwoJbG9jYWwgUGFyc2VyID0gTW9kdWxlLlBhcnNlcgoJbG9jYWwgTm9WYXJpYWJsZXMgPSBEYXRhLk5vVmFyaWFibGVzCgoJbG9jYWwgSW5kZW50U3RyaW5nID0gc2VsZjpNYWtlSW5kZW50KEluZGVudCkKCgktLS8vIFBhcnNlIGFyZ3VtZW50cwoJbG9jYWwgUGFyc2VkQXJncywgSXRlbXNDb3VudCwgSXNBcnJheSA9IFBhcnNlcjpQYXJzZVRhYmxlSW50b1N0cmluZyh7CgkJTm9CcmFja2V0cyA9IHRydWUsCgkJTm9WYXJpYWJsZXMgPSBOb1ZhcmlhYmxlcywKCQlUYWJsZSA9IEFyZ3MsCgkJSW5kZW50ID0gSW5kZW50Cgl9KQoKCS0tLy8gQ3JlYXRlIHRhYmxlIHZhcmlhYmxlIGlmIG5vdCBhbiBhcnJheQoJaWYgbm90IElzQXJyYXkgb3IgTm9WYXJpYWJsZXMgdGhlbgoJCVBhcnNlZEFyZ3MgPSBWYXJpYWJsZXM6TWFrZVZhcmlhYmxlKHsKCQkJVmFsdWUgPSAoInslc30iKTpmb3JtYXQoUGFyc2VkQXJncyksCgkJCUNvbW1lbnQgPSBub3QgSXNBcnJheSBhbmQgIkFyZ3VtZW50cyBhcmVuJ3Qgb3JkZXJlZCIgb3IgbmlsLAoJCQlOYW1lID0gIlJlbW90ZUFyZ3MiLAoJCQlDbGFzcyA9ICJSZW1vdGUiCgkJfSkKCWVuZAoKCS0tLy8gV3JhcCBpbiBhIHVucGFjayBpZiB0aGUgdGFibGUgaXMgYSBkaWN0CglpZiBJdGVtc0NvdW50ID4gMCBhbmQgbm90IElzQXJyYXkgdGhlbgoJCVBhcnNlZEFyZ3MgPSBgdW5wYWNrKHtQYXJzZWRBcmdzfSwgMSwgdGFibGUubWF4bih7UGFyc2VkQXJnc30pKWAKCWVuZAoKCS0tLy8gRmlyZXNpZ25hbCBzY3JpcHQgZm9yIGNsaWVudCByZWNpZXZlcwoJaWYgSXNSZWNlaXZlIHRoZW4KCQlsb2NhbCBTZWNvbmQgPSBJdGVtc0NvdW50IDw9IDAgYW5kICIiIG9yIGAsIHtQYXJzZWRBcmdzfWAKCQlsb2NhbCBTaWduYWwgPSBge1JlbW90ZVZhcmlhYmxlfS57TWV0aG9kfWAKCgkJbG9jYWwgQ29kZSA9IGAtLSBUaGlzIGRhdGEgd2FzIHJlY2VpdmVkIGZyb20gdGhlIHNlcnZlcmAKCQlQYXJzZWRBcmdzID0gc2VsZjpJbmRlbnQoSW5kZW50U3RyaW5nLCBDb2RlKQoJCUNvZGUgLi49IGBcbntJbmRlbnRTdHJpbmd9ZmlyZXNpZ25hbCh7U2lnbmFsfXtTZWNvbmR9KWAKCQkKCQlyZXR1cm4gQ29kZQoJZW5kCgkKCS0tLy8gUmVtb3RlIGludm9rZSBzY3JpcHQKCXJldHVybiBge1JlbW90ZVZhcmlhYmxlfTp7TWV0aG9kfSh7UGFyc2VkQXJnc30pYAplbmQKCi0tLy8gVmFyaWFibGVzOiAlVmFyaWFibGVOYW1lJQpmdW5jdGlvbiBHZW5lcmF0aW9uOkFwcGx5VmFyaWFibGVzKFN0cmluZzogc3RyaW5nLCBWYXJpYWJsZXM6IHRhYmxlLCAuLi4pOiBzdHJpbmcKCWZvciBWYXJpYWJsZSwgVmFsdWUgaW4gVmFyaWFibGVzIGRvCgkJLS0vLyBJbnZva2UgdmFsdWUgZnVuY3Rpb24KCQlpZiB0eXBlb2YoVmFsdWUpID09ICJmdW5jdGlvbiIgdGhlbgoJCQlWYWx1ZSA9IFZhbHVlKC4uLikKCQllbmQKCgkJU3RyaW5nID0gU3RyaW5nOmdzdWIoYCUle1ZhcmlhYmxlfSUlYCwgZnVuY3Rpb24oKQoJCQlyZXR1cm4gVmFsdWUKCQllbmQpCgllbmQKCXJldHVybiBTdHJpbmcKZW5kCgpmdW5jdGlvbiBHZW5lcmF0aW9uOk1ha2VJbmRlbnQoSW5kZW50OiBudW1iZXIpCglyZXR1cm4gc3RyaW5nLnJlcCgiCSIsIEluZGVudCkKZW5kCgp0eXBlIFNjcmlwdERhdGEgPSB7CglWYXJpYWJsZXM6IHRhYmxlLAoJTWV0YU1ldGhvZDogc3RyaW5nCn0KZnVuY3Rpb24gR2VuZXJhdGlvbjpNYWtlQ2FsbENvZGUoU2NyaXB0VHlwZTogc3RyaW5nLCBEYXRhOiBTY3JpcHREYXRhKTogc3RyaW5nCglsb2NhbCBTY3JpcHRUZW1wbGF0ZXMgPSBzZWxmLlNjcmlwdFRlbXBsYXRlcwoJbG9jYWwgVGVtcGxhdGUgPSBTY3JpcHRUZW1wbGF0ZXNbU2NyaXB0VHlwZV0KCglhc3NlcnQoVGVtcGxhdGUsIGB7U2NyaXB0VHlwZX0gaXMgbm90IGEgdmFsaWQgc2NyaXB0IHR5cGUhYCkKCglsb2NhbCBWYXJpYWJsZXMgPSBEYXRhLlZhcmlhYmxlcwoJbG9jYWwgTWV0YU1ldGhvZCA9IERhdGEuTWV0YU1ldGhvZAoJbG9jYWwgTWV0YU1ldGhvZHMgPSB7Il9faW5kZXgiLCAiX19uYW1lY2FsbCIsICJDb25uZWN0In0KCglsb2NhbCBmdW5jdGlvbiBDb21waWxlKFRlbXBsYXRlOiB0YWJsZSk6IHN0cmluZwoJCWxvY2FsIE91dCA9ICIiCgoJCWZvciBLZXksIFZhbHVlIGluIG5leHQsIFRlbXBsYXRlIGRvCgkJCS0tLy8gTWV0YU1ldGhvZCBjaGVjawoJCQlsb2NhbCBJc01ldGFUeXBlT25seSA9IHRhYmxlLmZpbmQoTWV0YU1ldGhvZHMsIEtleSkKCQkJaWYgSXNNZXRhVHlwZU9ubHkgdGhlbgoJCQkJaWYgS2V5ID09IE1ldGFNZXRob2QgdGhlbgoJCQkJCWxvY2FsIExpbmUgPSBDb21waWxlKFZhbHVlKQoJCQkJCU91dCAuLj0gTGluZQoJCQkJZW5kCgkJCQljb250aW51ZQoJCQllbmQKCgkJCS0tLy8gSW5mb3JtYXRpb24KCQkJbG9jYWwgQ29udGVudCwgSW5kZW50ID0gVmFsdWVbMV0sIFZhbHVlWzJdIG9yIDAKCQkJSW5kZW50ID0gbWF0aC5jbGFtcChJbmRlbnQtMSwgMCwgOTk5OSkKCgkJCS0tLy8gTWFrZSBsaW5lCgkJCWxvY2FsIExpbmUgPSBzZWxmOkFwcGx5VmFyaWFibGVzKENvbnRlbnQsIFZhcmlhYmxlcywgSW5kZW50KQoJCQlsb2NhbCBJbmRlbnRTdHJpbmcgPSBzZWxmOk1ha2VJbmRlbnQoSW5kZW50KQoKCQkJLS0vLyBBcHBlbmQgdG8gY29kZQoJCQlPdXQgLi49IGB7SW5kZW50U3RyaW5nfXtMaW5lfVxuYAoJCWVuZAoKCQlyZXR1cm4gT3V0CgllbmQKCQoJcmV0dXJuIENvbXBpbGUoVGVtcGxhdGUpCmVuZAoKZnVuY3Rpb24gR2VuZXJhdGlvbjpSZW1vdGVTY3JpcHQoTW9kdWxlLCBEYXRhOiBSZW1vdGVEYXRhLCBTY3JpcHRUeXBlOiBzdHJpbmcpOiBzdHJpbmcKCS0tLy8gVW5wYWNrIGRhdGEKCWxvY2FsIFJlbW90ZSA9IERhdGEuUmVtb3RlCglsb2NhbCBBcmdzID0gRGF0YS5BcmdzCglsb2NhbCBNZXRob2QgPSBEYXRhLk1ldGhvZAoJbG9jYWwgTWV0YU1ldGhvZCA9IERhdGEuTWV0YU1ldGhvZAoKCS0tLy8gUmVtb3RlIGluZm8KCWxvY2FsIENsYXNzTmFtZSA9IEhvb2s6SW5kZXgoUmVtb3RlLCAiQ2xhc3NOYW1lIikKCWxvY2FsIElzTmlsUGFyZW50ID0gSG9vazpJbmRleChSZW1vdGUsICJQYXJlbnQiKSA9PSBuaWwKCQoJbG9jYWwgVmFyaWFibGVzID0gTW9kdWxlLlZhcmlhYmxlcwoJbG9jYWwgRm9ybWF0dGVyID0gTW9kdWxlLkZvcm1hdHRlcgoJCgktLS8vIFByZS1yZW5kZXIgdmFyaWFibGVzCglWYXJpYWJsZXM6UHJlcmVuZGVyVmFyaWFibGVzKEFyZ3MsIHsiSW5zdGFuY2UifSkKCgktLS8vIENyZWF0ZSByZW1vdGUgdmFyaWFibGUKCWxvY2FsIFJlbW90ZVZhcmlhYmxlID0gVmFyaWFibGVzOk1ha2VWYXJpYWJsZSh7CgkJVmFsdWUgPSBGb3JtYXR0ZXI6Rm9ybWF0KFJlbW90ZSwgewoJCQlOb1ZhcmlhYmxlcyA9IHRydWUKCQl9KSwKCQlDb21tZW50ID0gYHtDbGFzc05hbWV9IHtJc05pbFBhcmVudCBhbmQgInwgUmVtb3RlIHBhcmVudCBpcyBuaWwiIG9yICIifWAsCgkJTmFtZSA9IEZvcm1hdHRlcjpNYWtlTmFtZShSZW1vdGUpLAoJCUxvb2t1cCA9IFJlbW90ZSwKCQlDbGFzcyA9ICJSZW1vdGUiCgl9KQoKCS0tLy8gR2VuZXJhdGUgY2FsbCBzY3JpcHQKCWxvY2FsIENhbGxDb2RlID0gc2VsZjpNYWtlQ2FsbENvZGUoU2NyaXB0VHlwZSwgewoJCVZhcmlhYmxlcyA9IHsKCQkJWyJSZW1vdGVDYWxsIl0gPSBmdW5jdGlvbihJbmRlbnQ6IG51bWJlcikKCQkJCXJldHVybiBzZWxmOkNhbGxSZW1vdGVTY3JpcHQoRGF0YSwgewoJCQkJCVJlbW90ZVZhcmlhYmxlID0gUmVtb3RlVmFyaWFibGUsCgkJCQkJSW5kZW50ID0gSW5kZW50LAoJCQkJCU1vZHVsZSA9IE1vZHVsZQoJCQkJfSkKCQkJZW5kLAoJCQlbIlJlbW90ZSJdID0gUmVtb3RlVmFyaWFibGUsCgkJCVsiTWV0aG9kIl0gPSBNZXRob2QsCgkJCVsiU2lnbmFsIl0gPSBge1JlbW90ZVZhcmlhYmxlfS57TWV0aG9kfWAKCQl9LAoJCU1ldGFNZXRob2QgPSBNZXRhTWV0aG9kCgl9KQoJCgktLS8vIE1ha2UgY29kZQoJbG9jYWwgQ29kZSA9IHNlbGY6R2V0QmFzZShNb2R1bGUpCglyZXR1cm4gYHtDb2RlfVxue0NhbGxDb2RlfWAKZW5kCgpmdW5jdGlvbiBHZW5lcmF0aW9uOkNvbm5lY3Rpb25zVGFibGUoU2lnbmFsOiBSQlhTY3JpcHRTaWduYWwpOiB0YWJsZQoJbG9jYWwgQ29ubmVjdGlvbnMgPSBnZXRjb25uZWN0aW9ucyhTaWduYWwpCglsb2NhbCBEYXRhQXJyYXkgPSB7fQoKCWZvciBfLCBDb25uZWN0aW9uIGluIG5leHQsIENvbm5lY3Rpb25zIGRvCgkJbG9jYWwgRnVuY3Rpb24gPSBDb25uZWN0aW9uLkZ1bmN0aW9uCgkJbG9jYWwgU2NyaXB0ID0gcmF3Z2V0KGdldGZlbnYoRnVuY3Rpb24pLCAic2NyaXB0IikKCgkJLS0vLyBTa2lwIGlmIHNlbGYKCQlpZiBTY3JpcHQgPT0gVGhpc1NjcmlwdCB0aGVuIGNvbnRpbnVlIGVuZAoKCQktLS8vIENvbm5lY3Rpb24gZGF0YQoJCWxvY2FsIERhdGEgPSB7CgkJCUZ1bmN0aW9uID0gRnVuY3Rpb24sCgkJCVN0YXRlID0gQ29ubmVjdGlvbi5TdGF0ZSwKCQkJU2NyaXB0ID0gU2NyaXB0CgkJfQoKCQl0YWJsZS5pbnNlcnQoRGF0YUFycmF5LCBEYXRhKQoJZW5kCgoJcmV0dXJuIERhdGFBcnJheQplbmQKCmZ1bmN0aW9uIEdlbmVyYXRpb246VGFibGVTY3JpcHQoTW9kdWxlLCBUYWJsZTogdGFibGUpOiBzdHJpbmcKCS0tLy8gUHJlLXJlbmRlciB2YXJpYWJsZXMKCU1vZHVsZS5WYXJpYWJsZXM6UHJlcmVuZGVyVmFyaWFibGVzKFRhYmxlLCB7Ikluc3RhbmNlIn0pCgoJLS0vLyBQYXJzZSBhcmd1bWVudHMKCWxvY2FsIFBhcnNlZFRhYmxlID0gTW9kdWxlLlBhcnNlcjpQYXJzZVRhYmxlSW50b1N0cmluZyh7CgkJVGFibGUgPSBUYWJsZQoJfSkKCgktLS8vIEdlbmVyYXRlIHNjcmlwdAoJbG9jYWwgQ29kZSwgTm9WYXJpYWJsZXMgPSBzZWxmOkdldEJhc2UoTW9kdWxlKQoJbG9jYWwgU2VwZXJhdG9yID0gTm9WYXJpYWJsZXMgYW5kICIiIG9yICJcbiIKCUNvZGUgLi49IGB7U2VwZXJhdG9yfXJldHVybiB7UGFyc2VkVGFibGV9YAoKCXJldHVybiBDb2RlCmVuZAoKZnVuY3Rpb24gR2VuZXJhdGlvbjpNYWtlVHlwZXNUYWJsZShUYWJsZTogdGFibGUpOiB0YWJsZQoJbG9jYWwgVHlwZXMgPSB7fQoKCWZvciBLZXksIFZhbHVlIGluIG5leHQsIFRhYmxlIGRvCgkJbG9jYWwgVHlwZSA9IHR5cGVvZihWYWx1ZSkKCQlpZiBUeXBlID09ICJ0YWJsZSIgdGhlbgoJCQlUeXBlID0gc2VsZjpNYWtlVHlwZXNUYWJsZShWYWx1ZSkKCQllbmQKCgkJVHlwZXNbS2V5XSA9IFR5cGUKCWVuZAoKCXJldHVybiBUeXBlcwplbmQKCmZ1bmN0aW9uIEdlbmVyYXRpb246Q29ubmVjdGlvbkluZm8oUmVtb3RlOiBJbnN0YW5jZSwgQ2xhc3NEYXRhOiB0YWJsZSk6IHRhYmxlPwoJbG9jYWwgUmVjZWl2ZU1ldGhvZHMgPSBDbGFzc0RhdGEuUmVjZWl2ZQoJaWYgbm90IFJlY2VpdmVNZXRob2RzIHRoZW4gcmV0dXJuIGVuZAoKCWxvY2FsIENvbm5lY3Rpb25zID0ge30KCWZvciBfLCBNZXRob2Q6IHN0cmluZyBpbiBuZXh0LCBSZWNlaXZlTWV0aG9kcyBkbwoJCXBjYWxsKGZ1bmN0aW9uKCkgLS0gVE9ETzogR0VUQ0FMTEJBQ0tWQUxVRQoJCQlsb2NhbCBTaWduYWwgPSBIb29rOkluZGV4KFJlbW90ZSwgTWV0aG9kKQoJCQlDb25uZWN0aW9uc1tNZXRob2RdID0gc2VsZjpDb25uZWN0aW9uc1RhYmxlKFNpZ25hbCkKCQllbmQpCgllbmQKCglyZXR1cm4gQ29ubmVjdGlvbnMKZW5kCgpmdW5jdGlvbiBHZW5lcmF0aW9uOkFkdmFuY2VkSW5mbyhNb2R1bGUsIERhdGE6IHRhYmxlKTogc3RyaW5nCgktLS8vIFVucGFjayByZW1vdGUgZGF0YQoJbG9jYWwgRnVuY3Rpb24gPSBEYXRhLkNhbGxpbmdGdW5jdGlvbgoJbG9jYWwgQ2xhc3NEYXRhID0gRGF0YS5DbGFzc0RhdGEKCWxvY2FsIFJlbW90ZSA9IERhdGEuUmVtb3RlCglsb2NhbCBBcmdzID0gRGF0YS5BcmdzCgkKCS0tLy8gQWR2YW5jZWQgaW5mbyB0YWJsZSBiYXNlCglsb2NhbCBGdW5jdGlvbkluZm8gPSB7CgkJWyJDYWxsZXIiXSA9IHsKCQkJWyJTb3VyY2VTY3JpcHQiXSA9IERhdGEuU291cmNlU2NyaXB0LAoJCQlbIkNhbGxpbmdTY3JpcHQiXSA9IERhdGEuQ2FsbGluZ1NjcmlwdCwKCQkJWyJDYWxsaW5nRnVuY3Rpb24iXSA9IEZ1bmN0aW9uCgkJfSwKCQlbIlJlbW90ZSJdID0gewoJCQlbIlJlbW90ZSJdID0gUmVtb3RlLAoJCQlbIlJlbW90ZUlEIl0gPSBEYXRhLklkLAoJCQlbIk1ldGhvZCJdID0gRGF0YS5NZXRob2QsCgkJCVsiQ29ubmVjdGlvbnMiXSA9IHNlbGY6Q29ubmVjdGlvbkluZm8oUmVtb3RlLCBDbGFzc0RhdGEpCgkJfSwKCQlbIkFyZ3VtZW50cyJdID0gewoJCQlbIkxlbmd0aCJdID0gI0FyZ3MsCgkJCVsiVHlwZXMiXSA9IHNlbGY6TWFrZVR5cGVzVGFibGUoQXJncyksCgkJfSwKCQlbIk1ldGFNZXRob2QiXSA9IERhdGEuTWV0YU1ldGhvZCwKCQlbIklzQWN0b3IiXSA9IERhdGEuSXNBY3RvciwKCX0KCgktLS8vIFNvbWUgY2xvc3VyZXMgbWF5IG5vdCBiZSBsdWEKCWlmIEZ1bmN0aW9uIGFuZCBpc2xjbG9zdXJlKEZ1bmN0aW9uKSB0aGVuCgkJRnVuY3Rpb25JbmZvWyJVcFZhbHVlcyJdID0gZGVidWcuZ2V0dXB2YWx1ZXMoRnVuY3Rpb24pCgkJRnVuY3Rpb25JbmZvWyJDb25zdGFudHMiXSA9IGRlYnVnLmdldGNvbnN0YW50cyhGdW5jdGlvbikKCWVuZAoKCS0tLy8gR2VuZXJhdGUgc2NyaXB0CglyZXR1cm4gc2VsZjpUYWJsZVNjcmlwdChNb2R1bGUsIEZ1bmN0aW9uSW5mbykKZW5kCgpmdW5jdGlvbiBHZW5lcmF0aW9uOkR1bXBMb2dzKExvZ3M6IHRhYmxlKTogc3RyaW5nCglsb2NhbCBCYXNlRGF0YQoJbG9jYWwgUGFyc2VkID0gewoJCVJlbW90ZSA9IG5pbCwKCQlDYWxscyA9IHt9Cgl9CgoJLS0vLyBDcmVhdGUgbmV3IHBhcnNlciBpbnN0YW5jZQoJbG9jYWwgTW9kdWxlID0gR2VuZXJhdGlvbjpOZXdQYXJzZXIoKQoKCWZvciBfLCBEYXRhIGluIExvZ3MgZG8KCQlsb2NhbCBDYWxscyA9IFBhcnNlZC5DYWxscwoJCWxvY2FsIFRhYmxlID0gewoJCQlBcmdzID0gRGF0YS5BcmdzLAoJCQlUaW1lc3RhbXAgPSBEYXRhLlRpbWVzdGFtcCwKCQkJUmV0dXJuVmFsdWVzID0gRGF0YS5SZXR1cm5WYWx1ZXMsCgkJCU1ldGhvZCA9IERhdGEuTWV0aG9kLAoJCQlNZXRhTWV0aG9kID0gRGF0YS5NZXRhTWV0aG9kLAoJCQlDYWxsaW5nU2NyaXB0ID0gRGF0YS5DYWxsaW5nU2NyaXB0LAoJCX0KCgkJLS0vLyBBcHBlbmQKCQl0YWJsZS5pbnNlcnQoQ2FsbHMsIFRhYmxlKQoKCQktLS8vIFNldCBCYXNlRGF0YQoJCWlmIG5vdCBCYXNlRGF0YSB0aGVuCgkJCUJhc2VEYXRhID0gRGF0YQoJCWVuZAoJZW5kCgoJLS0vLyBCYXNlZGF0YSBtZXJnZQoJUGFyc2VkLlJlbW90ZSA9IEJhc2VEYXRhLlJlbW90ZQoKCS0tLy8gQ29tcGlsZSBhbmQgc2F2ZQoJbG9jYWwgT3V0cHV0ID0gc2VsZjpUYWJsZVNjcmlwdChNb2R1bGUsIFBhcnNlZCkKCWxvY2FsIEZpbGVQYXRoID0gc2VsZjpXcml0ZUR1bXAoT3V0cHV0KQoJCglyZXR1cm4gRmlsZVBhdGgKZW5kCgpyZXR1cm4gR2VuZXJhdGlvbgo=]]
},Communication={'base64',
[[dHlwZSB0YWJsZSA9IHsKICAgIFthbnldOiBhbnkKfQoKLS0vLyBNb2R1bGUKbG9jYWwgTW9kdWxlID0gewogICAgQ29tbUNhbGxiYWNrcyA9IHt9Cn0KCmxvY2FsIENvbW1XcmFwcGVyID0ge30KQ29tbVdyYXBwZXIuX19pbmRleCA9IENvbW1XcmFwcGVyCgotLS8vIFNlcmlhbGl6ZXIgY2FjaGUKbG9jYWwgU2VyaWFsaXplQ2FjaGUgPSBzZXRtZXRhdGFibGUoe30sIHtfX21vZGUgPSAiayJ9KQpsb2NhbCBEZXNlcmlhbGl6ZUNhY2hlID0gc2V0bWV0YXRhYmxlKHt9LCB7X19tb2RlID0gImsifSkKCi0tLy8gU2VydmljZXMKbG9jYWwgQ29yZUd1aQoKLS0vLyBNb2R1bGVzCmxvY2FsIEhvb2sKbG9jYWwgQ2hhbm5lbApsb2NhbCBDb25maWcKbG9jYWwgUHJvY2VzcwoKZnVuY3Rpb24gTW9kdWxlOkluaXQoRGF0YSkKICAgIGxvY2FsIE1vZHVsZXMgPSBEYXRhLk1vZHVsZXMKICAgIGxvY2FsIFNlcnZpY2VzID0gRGF0YS5TZXJ2aWNlcwoKICAgIEhvb2sgPSBNb2R1bGVzLkhvb2sKICAgIFByb2Nlc3MgPSBNb2R1bGVzLlByb2Nlc3MKICAgIENvbmZpZyA9IE1vZHVsZXMuQ29uZmlnIG9yIENvbmZpZwogICAgQ29yZUd1aSA9IFNlcnZpY2VzLkNvcmVHdWkKZW5kCgpmdW5jdGlvbiBDb21tV3JhcHBlcjpGaXJlKC4uLikKICAgIGxvY2FsIFF1ZXVlID0gc2VsZi5RdWV1ZQogICAgdGFibGUuaW5zZXJ0KFF1ZXVlLCB7Li4ufSkKZW5kCgpmdW5jdGlvbiBDb21tV3JhcHBlcjpQcm9jZXNzQXJndW1lbnRzKEFyZ3VtZW50cykgCiAgICBsb2NhbCBDaGFubmVsID0gc2VsZi5DaGFubmVsCiAgICBDaGFubmVsOkZpcmUoUHJvY2VzczpVbnBhY2soQXJndW1lbnRzKSkKZW5kCgpmdW5jdGlvbiBDb21tV3JhcHBlcjpQcm9jZXNzUXVldWUoKQogICAgbG9jYWwgUXVldWUgPSBzZWxmLlF1ZXVlCgogICAgZm9yIEluZGV4ID0gMSwgI1F1ZXVlIGRvCiAgICAgICAgbG9jYWwgQXJndW1lbnRzID0gdGFibGUucmVtb3ZlKFF1ZXVlKQogICAgICAgIHBjYWxsKGZ1bmN0aW9uKCkKICAgICAgICAgICAgc2VsZjpQcm9jZXNzQXJndW1lbnRzKEFyZ3VtZW50cykgCiAgICAgICAgZW5kKQogICAgZW5kCmVuZAoKZnVuY3Rpb24gQ29tbVdyYXBwZXI6QmVnaW5RdWV1ZVNlcnZpY2UoKQogICAgY29yb3V0aW5lLndyYXAoZnVuY3Rpb24oKQogICAgICAgIHdoaWxlIHdhaXQoKSBkbwogICAgICAgICAgICBzZWxmOlByb2Nlc3NRdWV1ZSgpCiAgICAgICAgZW5kCiAgICBlbmQpKCkKZW5kCgpmdW5jdGlvbiBNb2R1bGU6TmV3Q29tbVdyYXAoQ2hhbm5lbDogQmluZGFibGVFdmVudCkKICAgIGxvY2FsIEJhc2UgPSB7CiAgICAgICAgUXVldWUgPSBzZXRtZXRhdGFibGUoe30sIHtfX21vZGUgPSAidiJ9KSwKICAgICAgICBDaGFubmVsID0gQ2hhbm5lbCwKICAgICAgICBFdmVudCA9IENoYW5uZWwuRXZlbnQKICAgIH0KCiAgICAtLS8vIENyZWF0ZSBuZXcgd3JhcHBlciBjbGFzcwogICAgbG9jYWwgV3JhcHBlZCA9IHNldG1ldGF0YWJsZShCYXNlLCBDb21tV3JhcHBlcikKICAgIFdyYXBwZWQ6QmVnaW5RdWV1ZVNlcnZpY2UoKQoKICAgIHJldHVybiBXcmFwcGVkCmVuZAoKZnVuY3Rpb24gTW9kdWxlOk1ha2VEZWJ1Z0lkSGFuZGxlcigpOiBCaW5kYWJsZUZ1bmN0aW9uCiAgICAtLS8vIFVzaW5nIEJpbmRhYmxlRnVuY3Rpb24gYXMgaXQgZG9lcyBub3QgcmVxdWlyZSBhIHRocmVhZCBwZXJtaXNzaW9uIGNoYW5nZQogICAgbG9jYWwgUmVtb3RlID0gSW5zdGFuY2UubmV3KCJCaW5kYWJsZUZ1bmN0aW9uIikKICAgIGZ1bmN0aW9uIFJlbW90ZS5Pbkludm9rZShPYmplY3Q6IEluc3RhbmNlKTogc3RyaW5nCiAgICAgICAgcmV0dXJuIE9iamVjdDpHZXREZWJ1Z0lkKCkKICAgIGVuZAoKICAgIHNlbGYuRGVidWdJZFJlbW90ZSA9IFJlbW90ZQogICAgc2VsZi5EZWJ1Z0lkSW52b2tlID0gUmVtb3RlLkludm9rZQoKICAgIHJldHVybiBSZW1vdGUKZW5kCgpmdW5jdGlvbiBNb2R1bGU6R2V0RGVidWdJZChPYmplY3Q6IEluc3RhbmNlKTogc3RyaW5nCiAgICBsb2NhbCBJbnZva2UgPSBzZWxmLkRlYnVnSWRJbnZva2UKICAgIGxvY2FsIFJlbW90ZSA9IHNlbGYuRGVidWdJZFJlbW90ZQoJcmV0dXJuIEludm9rZShSZW1vdGUsIE9iamVjdCkKZW5kCgpmdW5jdGlvbiBNb2R1bGU6R2V0SGlkZGVuUGFyZW50KCk6IEluc3RhbmNlCiAgICAtLS8vIFVzZSBnZXRodWkgaWYgaXQgZXhpc3RzCiAgICBpZiBnZXRodWkgdGhlbiByZXR1cm4gZ2V0aHVpKCkgZW5kCiAgICByZXR1cm4gQ29yZUd1aQplbmQKCmZ1bmN0aW9uIE1vZHVsZTpDcmVhdGVDb21tQ2hhbm5lbCgpOiAobnVtYmVyLCBCaW5kYWJsZUV2ZW50KQogICAgLS0vLyBVc2UgbmF0aXZlIGlmIGl0IGV4aXN0cwogICAgbG9jYWwgRm9yY2UgPSBDb25maWcuRm9yY2VVc2VDdXN0b21Db21tCiAgICBpZiBjcmVhdGVfY29tbV9jaGFubmVsIGFuZCBub3QgRm9yY2UgdGhlbgogICAgICAgIHJldHVybiBjcmVhdGVfY29tbV9jaGFubmVsKCkKICAgIGVuZAoKICAgIGxvY2FsIFBhcmVudCA9IHNlbGY6R2V0SGlkZGVuUGFyZW50KCkKICAgIGxvY2FsIENoYW5uZWxJZCA9IG1hdGgucmFuZG9tKDEsIDEwMDAwMDAwKQoKICAgIC0tLy8gQmluZGFibGVFdmVudAogICAgbG9jYWwgQ2hhbm5lbCA9IEluc3RhbmNlLm5ldygiQmluZGFibGVFdmVudCIsIFBhcmVudCkKICAgIENoYW5uZWwuTmFtZSA9IENoYW5uZWxJZAoKICAgIHJldHVybiBDaGFubmVsSWQsIENoYW5uZWwKZW5kCgpmdW5jdGlvbiBNb2R1bGU6R2V0Q29tbUNoYW5uZWwoQ2hhbm5lbElkOiBudW1iZXIpOiBCaW5kYWJsZUV2ZW50PwogICAgLS0vLyBVc2UgbmF0aXZlIGlmIGl0IGV4aXN0cwogICAgbG9jYWwgRm9yY2UgPSBDb25maWcuRm9yY2VVc2VDdXN0b21Db21tCiAgICBpZiBnZXRfY29tbV9jaGFubmVsIGFuZCBub3QgRm9yY2UgdGhlbgogICAgICAgIGxvY2FsIENoYW5uZWwgPSBnZXRfY29tbV9jaGFubmVsKENoYW5uZWxJZCkKICAgICAgICByZXR1cm4gQ2hhbm5lbCwgZmFsc2UKICAgIGVuZAoKICAgIGxvY2FsIFBhcmVudCA9IHNlbGY6R2V0SGlkZGVuUGFyZW50KCkKICAgIGxvY2FsIENoYW5uZWwgPSBQYXJlbnQ6RmluZEZpcnN0Q2hpbGQoQ2hhbm5lbElkKQoKICAgIC0tLy8gV3JhcCB0aGUgY2hhbm5lbCAoUHJldmVudHMgdGhyZWFkIHBlcm1pc3Npb24gZXJyb3JzKQogICAgbG9jYWwgV3JhcHBlZCA9IHNlbGY6TmV3Q29tbVdyYXAoQ2hhbm5lbCkKICAgIHJldHVybiBXcmFwcGVkLCB0cnVlCmVuZAoKZnVuY3Rpb24gTW9kdWxlOkNoZWNrVmFsdWUoVmFsdWUsIEluYm91bmQ6IGJvb2xlYW4/KQogICAgIC0tLy8gTm8gc2VyaWFsaXppbmcgIG5lZWRlZAogICAgaWYgdHlwZW9mKFZhbHVlKSB+PSAidGFibGUiIHRoZW4gCiAgICAgICAgcmV0dXJuIFZhbHVlIAogICAgZW5kCiAgIAogICAgLS0vLyBEZXNlcmlhbGl6ZQogICAgaWYgSW5ib3VuZCB0aGVuCiAgICAgICAgcmV0dXJuIHNlbGY6RGVzZXJpYWxpemVUYWJsZShWYWx1ZSkKICAgIGVuZAoKICAgIC0tLy8gU2VyaWFsaXplCiAgICByZXR1cm4gc2VsZjpTZXJpYWxpemVUYWJsZShWYWx1ZSkKZW5kCgpsb2NhbCBUaWNrID0gMApmdW5jdGlvbiBNb2R1bGU6V2FpdENoZWNrKCkKICAgIFRpY2sgKz0gMQogICAgaWYgVGljayA+IDQwIHRoZW4KICAgICAgICBUaWNrID0gMCAtLSBJIGNvdWxkIHVzZSBtb2R1bHVzIGhlcmUgYnV0IHRoZSBpbnRlcmdlciB3aWxsIGJlIG1hc3NpdmUKICAgICAgICB3YWl0KCkKICAgIGVuZAplbmQKCmZ1bmN0aW9uIE1vZHVsZTpNYWtlUGFja2V0KEluZGV4LCBWYWx1ZSk6IHRhYmxlCiAgICBzZWxmOldhaXRDaGVjaygpCiAgICByZXR1cm4gewogICAgICAgIEluZGV4ID0gc2VsZjpDaGVja1ZhbHVlKEluZGV4KSwgCiAgICAgICAgVmFsdWUgPSBzZWxmOkNoZWNrVmFsdWUoVmFsdWUpCiAgICB9CmVuZAoKZnVuY3Rpb24gTW9kdWxlOlJlYWRQYWNrZXQoUGFja2V0OiB0YWJsZSk6IChhbnksIGFueSkKICAgIGlmIHR5cGVvZihQYWNrZXQpIH49ICJ0YWJsZSIgdGhlbiByZXR1cm4gUGFja2V0IGVuZAogICAgCiAgICBsb2NhbCBLZXkgPSBzZWxmOkNoZWNrVmFsdWUoUGFja2V0LkluZGV4LCB0cnVlKQogICAgbG9jYWwgVmFsdWUgPSBzZWxmOkNoZWNrVmFsdWUoUGFja2V0LlZhbHVlLCB0cnVlKQogICAgc2VsZjpXYWl0Q2hlY2soKQoKICAgIHJldHVybiBLZXksIFZhbHVlCmVuZAoKZnVuY3Rpb24gTW9kdWxlOlNlcmlhbGl6ZVRhYmxlKFRhYmxlOiB0YWJsZSk6IHRhYmxlCiAgICAtLS8vIENoZWNrIGNhY2hlIGZvciBleGlzdGluZwogICAgbG9jYWwgQ2FjaGVkID0gU2VyaWFsaXplQ2FjaGVbVGFibGVdCiAgICBpZiBDYWNoZWQgdGhlbiByZXR1cm4gQ2FjaGVkIGVuZAoKICAgIGxvY2FsIFNlcmlhbGl6ZWQgPSB7fQogICAgU2VyaWFsaXplQ2FjaGVbVGFibGVdID0gU2VyaWFsaXplZAoKICAgIGZvciBJbmRleCwgVmFsdWUgaW4gbmV4dCwgVGFibGUgZG8KICAgICAgICBsb2NhbCBQYWNrZXQgPSBzZWxmOk1ha2VQYWNrZXQoSW5kZXgsIFZhbHVlKQogICAgICAgIHRhYmxlLmluc2VydChTZXJpYWxpemVkLCBQYWNrZXQpCiAgICBlbmQKCiAgICByZXR1cm4gU2VyaWFsaXplZAplbmQKCmZ1bmN0aW9uIE1vZHVsZTpEZXNlcmlhbGl6ZVRhYmxlKFNlcmlhbGl6ZWQ6IHRhYmxlKTogdGFibGUKICAgIC0tLy8gQ2hlY2sgZm9yIGNhY2hlZAogICAgbG9jYWwgQ2FjaGVkID0gRGVzZXJpYWxpemVDYWNoZVtTZXJpYWxpemVkXQogICAgaWYgQ2FjaGVkIHRoZW4gcmV0dXJuIENhY2hlZCBlbmQKCiAgICBsb2NhbCBUYWJsZSA9IHt9CiAgICBEZXNlcmlhbGl6ZUNhY2hlW1NlcmlhbGl6ZWRdID0gVGFibGUKICAgIAogICAgZm9yIF8sIFBhY2tldCBpbiBuZXh0LCBTZXJpYWxpemVkIGRvCiAgICAgICAgbG9jYWwgSW5kZXgsIFZhbHVlID0gc2VsZjpSZWFkUGFja2V0KFBhY2tldCkKICAgICAgICBpZiBJbmRleCA9PSBuaWwgdGhlbiBjb250aW51ZSBlbmQKCiAgICAgICAgVGFibGVbSW5kZXhdID0gVmFsdWUKICAgIGVuZAoKICAgIHJldHVybiBUYWJsZQplbmQKCmZ1bmN0aW9uIE1vZHVsZTpTZXRDaGFubmVsKE5ld0NoYW5uZWw6IG51bWJlcikKICAgIENoYW5uZWwgPSBOZXdDaGFubmVsCmVuZAoKZnVuY3Rpb24gTW9kdWxlOkNvbnNvbGVQcmludCguLi4pCiAgICBzZWxmOkNvbW11bmljYXRlKCJQcmludCIsIC4uLikKZW5kCgpmdW5jdGlvbiBNb2R1bGU6UXVldWVMb2coRGF0YSkKICAgIHNwYXduKGZ1bmN0aW9uKCkKICAgICAgICBsb2NhbCBTZXJpYWxpemVkQXJncyA9IHNlbGY6U2VyaWFsaXplVGFibGUoRGF0YS5BcmdzKQogICAgICAgIERhdGEuQXJncyA9IFNlcmlhbGl6ZWRBcmdzCgogICAgICAgIHNlbGY6Q29tbXVuaWNhdGUoIlF1ZXVlTG9nIiwgRGF0YSkKICAgIGVuZCkKZW5kCgpmdW5jdGlvbiBNb2R1bGU6QWRkQ29tbUNhbGxiYWNrKFR5cGU6IHN0cmluZywgQ2FsbGJhY2s6ICguLi5hbnkpIC0+IC4uLmFueSkKICAgIGxvY2FsIENvbW1DYWxsYmFja3MgPSBzZWxmLkNvbW1DYWxsYmFja3MKICAgIENvbW1DYWxsYmFja3NbVHlwZV0gPSBDYWxsYmFjawplbmQKCmZ1bmN0aW9uIE1vZHVsZTpHZXRDb21tQ2FsbGJhY2soVHlwZTogc3RyaW5nKTogKC4uLmFueSkgLT4gLi4uYW55CiAgICBsb2NhbCBDb21tQ2FsbGJhY2tzID0gc2VsZi5Db21tQ2FsbGJhY2tzCiAgICByZXR1cm4gQ29tbUNhbGxiYWNrc1tUeXBlXQplbmQKCmZ1bmN0aW9uIE1vZHVsZTpDaGFubmVsSW5kZXgoQ2hhbm5lbCwgUHJvcGVydHk6IHN0cmluZykKICAgIGlmIHR5cGVvZihDaGFubmVsKSA9PSAiSW5zdGFuY2UiIHRoZW4KICAgICAgICByZXR1cm4gSG9vazpJbmRleChDaGFubmVsLCBQcm9wZXJ0eSkKICAgIGVuZAoKICAgIC0tLy8gU29tZSBleGVjdXRvcnMgcmV0dXJuIGEgVXNlckRhdGEgdHlwZQogICAgcmV0dXJuIENoYW5uZWxbUHJvcGVydHldCmVuZAoKZnVuY3Rpb24gTW9kdWxlOkNvbW11bmljYXRlKC4uLikKICAgIGxvY2FsIEZpcmUgPSBzZWxmOkNoYW5uZWxJbmRleChDaGFubmVsLCAiRmlyZSIpCiAgICBGaXJlKENoYW5uZWwsIC4uLikKZW5kCgpmdW5jdGlvbiBNb2R1bGU6QWRkQ29ubmVjdGlvbihDYWxsYmFjayk6IFJCWFNjcmlwdENvbm5lY3Rpb24KICAgIGxvY2FsIEV2ZW50ID0gc2VsZjpDaGFubmVsSW5kZXgoQ2hhbm5lbCwgIkV2ZW50IikKICAgIHJldHVybiBFdmVudDpDb25uZWN0KENhbGxiYWNrKQplbmQKCmZ1bmN0aW9uIE1vZHVsZTpBZGRUeXBlQ2FsbGJhY2soVHlwZTogc3RyaW5nLCBDYWxsYmFjayk6IFJCWFNjcmlwdENvbm5lY3Rpb24KICAgIGxvY2FsIEV2ZW50ID0gc2VsZjpDaGFubmVsSW5kZXgoQ2hhbm5lbCwgIkV2ZW50IikKICAgIHJldHVybiBFdmVudDpDb25uZWN0KGZ1bmN0aW9uKFJlY2l2ZWRUeXBlOiBzdHJpbmcsIC4uLikKICAgICAgICBpZiBSZWNpdmVkVHlwZSB+PSBUeXBlIHRoZW4gcmV0dXJuIGVuZAogICAgICAgIENhbGxiYWNrKC4uLikKICAgIGVuZCkKZW5kCgpmdW5jdGlvbiBNb2R1bGU6QWRkVHlwZUNhbGxiYWNrcyhUeXBlczogdGFibGUpCiAgICBmb3IgVHlwZTogc3RyaW5nLCBDYWxsYmFjayBpbiBuZXh0LCBUeXBlcyBkbwogICAgICAgIHNlbGY6QWRkVHlwZUNhbGxiYWNrKFR5cGUsIENhbGxiYWNrKQogICAgZW5kCmVuZAoKZnVuY3Rpb24gTW9kdWxlOkNyZWF0ZUNoYW5uZWwoKTogbnVtYmVyCiAgICBsb2NhbCBDaGFubmVsSUQsIEV2ZW50ID0gc2VsZjpDcmVhdGVDb21tQ2hhbm5lbCgpCgogICAgLS0vLyBDb25uZWN0IEdldENvbW1DYWxsYmFjayBmdW5jdGlvbgogICAgRXZlbnQuRXZlbnQ6Q29ubmVjdChmdW5jdGlvbihUeXBlOiBzdHJpbmcsIC4uLikKICAgICAgICBsb2NhbCBDYWxsYmFjayA9IHNlbGY6R2V0Q29tbUNhbGxiYWNrKFR5cGUpCiAgICAgICAgaWYgQ2FsbGJhY2sgdGhlbgogICAgICAgICAgICBDYWxsYmFjayguLi4pCiAgICAgICAgZW5kCiAgICBlbmQpCgogICAgcmV0dXJuIENoYW5uZWxJRCwgRXZlbnQKZW5kCgpNb2R1bGU6TWFrZURlYnVnSWRIYW5kbGVyKCkKCnJldHVybiBNb2R1bGU=]]
}},d.Players local i=e:LoadLibraries(g)local j,k,l,m,n,o,p=i.Process,i.Hook,i.Ui
,i.Generation,i.Communication,i.Config,e:GetAsset('ProggyClean.ttf',true)local q
=e:CreateFont('ProggyClean',p)l:SetFontFile(q)j:CheckConfig(o)e:LoadModules(i,{
Modules=i,Services=d})local r,s=l:CreateMainWindow(),j:CheckIsSupported()if not
s then r:Close()return end local t,u=n:CreateChannel()n:AddCommCallback(
'QueueLog',function(...)l:QueueLog(...)end)n:AddCommCallback('Print',function(
...)l:ConsoleLog(...)end)local v=h.LocalPlayer m:SetSwapsCallback(function(w)w:
AddSwap(v,{String='LocalPlayer'})w:AddSwap(v.Character,{String='Character',
NextParent=v})end)l:CreateWindowContent(r)l:SetCommChannel(u)l:BeginLogService()
local w=e:MakeActorScript(g,t)k:LoadHooks(w,t)local x=l:AskUser{Title=
'Enable function patches?',Content={
[[On some executors, function patches can prevent common detections that executor has]]
,
[[By enabling this, it MAY trigger hook detections in some games, this is why you are asked.]]
,"If it doesn't work, rejoin and press 'No'",'',
'(This does not affect game functionality)'},Options={'Yes','No'}}=='Yes'u:Fire(
'BeginHooks',{PatchFunctions=x})